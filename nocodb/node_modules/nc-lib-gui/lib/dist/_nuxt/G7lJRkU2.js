const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BjlRxDgN.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./boyBAVNN.js","./Editor.C6FZ3q1a.css","./DkUkBUc0.js"])))=>i.map(i=>d[i]);
import{e as se,J as le,G as o,r as i,kX as oe,kr as ie,gE as re,Y as ue,iC as ce,gC as de,k9 as pe,em as fe,gb as me,T as ve,hg as ye,gD as Ee,jf as _e,n as ke,aQ as b,eN as ge,k7 as we,j7 as Ce,ko as Ie,g as be,i_ as je,bz as Ne,I as S,o as c,w as v,c as j,b as k,L as t,N as d,a as xe,K as Le,O as Se,aT as M,b9 as R,d as K,t as N,aS as A,a3 as he,fF as B,fG as Oe,ou as Ve,ap as ze,ag as Je,P as Me,Q as Ke,bw as Pe,hU as Ue,aW as F,_ as De}from"./DOFFjK0_.js";import{u as Te}from"./CV-2bRRD.js";const Re=A(()=>F(()=>import("./BjlRxDgN.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(p=>p.default||p)),Be=A(()=>F(()=>import("./DkUkBUc0.js"),__vite__mapDeps([5,1,2]),import.meta.url).then(p=>p.default||p)),Ae={key:0,class:"flex gap-2"},Fe={key:1},$e={key:0,class:"nc-cell-field text-xs w-full py-1 text-red-500"},Ge={key:1,class:"nc-cell-field nc-null uppercase"},We=se({__name:"Json",props:{modelValue:{}},emits:["update:modelValue"],setup(p,{emit:$}){const G=p,W=$,{showNull:Q}=le(),g=o(oe,i(!1)),q=o(ie,i(!1)),y=o(re,null),X=o(ce,ue({})),h=o(de,null),P=o(pe,i(!1)),U=o(fe,i(!1)),w=o(me,i(!1)),r=ve(G,"modelValue",W),D=i(),f=i(),Y=o(ye,i(!1)),a=i(!1),T=o(Ee,i(!1)),H=o(_e,i(void 0)),C=e=>e??null,s=ke({get:()=>D.value,set:e=>{D.value=C(e)===null?null:typeof e=="object"?JSON.stringify(e,null,2):e,U.value&&!a.value&&(r.value=C(e)===null?null:e)}});function u(e){var l;const n=e==null?void 0:e.target;(l=n==null?void 0:n.classList)!=null&&l.contains("default-value-clear")||(a.value=!0)}function I(){a.value=!1}const Z=e=>{try{return JSON.stringify(JSON.parse(e))}catch(n){return console.log(n),e}};function O(e){try{s.value=C(e)===null?null:typeof e=="string"?JSON.stringify(JSON.parse(e),null,2):e}catch{s.value=C(e)===null?null:e}}const ee=()=>{f.value=void 0,I(),g.value=!1,O(r.value)},ne=()=>{if(I(),g.value=!1,f.value||s.value===r.value)return!1;r.value=C(s.value)===null?null:Z(s.value)};b(r,e=>{O(e)},{immediate:!0}),b([s,g],()=>{try{JSON.parse(s.value),f.value=void 0}catch(e){if(s.value===void 0||s.value===null)return;f.value=e}}),b(g,()=>{I(),O(r.value)}),Te(q,e=>{if(!w.value)switch(!0){case e.key==="Enter":if(e.preventDefault(),e.stopPropagation(),e.shiftKey)return!0;u();break;case e.metaKey:case e.altKey:case e.ctrlKey:case e.key==="Backspace":case(e.key==="Spacebar"||e.key===" "):case[...e.key].length>1:break;default:typeof s.value=="string"?s.value+=e.key:s.value||(s.value=e.key),u()}});const V=i(null);ge(V,e=>{var n;(n=e.target)!=null&&n.closest(".nc-json-action")||(g.value=!1)}),b(a,(e,n)=>{Y.value=a.value,n&&!e&&(h==null||h.trigger())});const E=e=>{e.stopPropagation()};b(V,()=>{if(!P.value)return;const e=document.querySelector(".nc-json-expanded-modal");a.value&&(e!=null&&e.parentElement)?(e.parentElement.addEventListener("click",E),e.parentElement.addEventListener("mousedown",E),e.parentElement.addEventListener("mouseup",E)):e!=null&&e.parentElement&&(e.parentElement.removeEventListener("click",E),e.parentElement.removeEventListener("mousedown",E),e.parentElement.removeEventListener("mouseup",E))});const z=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Pe(e))&&Ue(e))return a.value?I():u(),!0},x=we(),te=o(Ce,!1),ae=o(Ie,i(!1));return be(()=>{var l,m;y==null||y.on(z),!ae.value&&te&&!a.value&&!P.value&&!U.value&&!T.value&&je(()=>{z(X.event)||u()});const e=(l=x.value)==null?void 0:l.closest("td");if(e&&!w.value){e.addEventListener("dblclick",u);return}const n=(m=x.value)==null?void 0:m.closest(".nc-data-cell, .nc-default-value-wrapper");n&&n.addEventListener("click",u)}),Ne(()=>{var l,m,_,L;y==null||y.off(z);const e=(m=(l=x.value)==null?void 0:l.closest)==null?void 0:m.call(l,"td");if(e&&!w.value){e.removeEventListener("dblclick",u);return}const n=(L=(_=x.value)==null?void 0:_.closest)==null?void 0:L.call(_,".nc-data-cell, .nc-default-value-wrapper");n&&n.removeEventListener("click",u)}),(e,n)=>{const l=Se,m=Re,_=Be,L=ze;return c(),S(M(t(a)?Ke:"div"),{visible:t(a),"onUpdate:visible":n[7]||(n[7]=J=>Me(a)?a.value=J:null),width:"auto",closable:!1,centered:"",footer:null,"wrap-class-name":t(a)?"!z-1051 nc-json-expanded-modal":null,class:Je(["relative",{"json-modal min-w-80":t(a),"min-h-6 flex items-center":!t(a)}])},{default:v(()=>[t(a)?(c(),j("div",{key:0,class:"flex flex-col w-full",onMousedown:n[4]||(n[4]=d(()=>{},["stop"])),onMouseup:n[5]||(n[5]=d(()=>{},["stop"])),onClick:n[6]||(n[6]=d(()=>{},["stop"]))},[xe("div",{class:"flex flex-row justify-between items-center -mt-2 pb-3 nc-json-action",onMousedown:n[0]||(n[0]=d(()=>{},["stop"]))},[k(l,{type:"secondary",size:"xsmall",class:"!w-7 !h-7 !min-w-[fit-content]",onClick:d(I,["stop"])},{default:v(()=>[(c(),S(M(("iconMap"in e?e.iconMap:t(R)).minimize),{class:"w-4 h-4"}))]),_:1}),t(w)?(c(),j("div",Fe)):(c(),j("div",Ae,[k(l,{type:"secondary",size:"small",onClick:ee},{default:v(()=>[K(N(e.$t("general.cancel")),1)]),_:1}),k(l,{type:"primary",size:"small",disabled:!!t(f)||t(s)===t(r),onClick:ne},{default:v(()=>[K(N(e.$t("general.save")),1)]),_:1},8,["disabled"])]))],32),k(m,{ref_key:"inputWrapperRef",ref:V,"model-value":t(s)??null,class:"min-w-full w-[40rem] resize overflow-auto expanded-editor","hide-minimap":!0,"disable-deep-compare":!0,"auto-focus":!0,"read-only":t(w),"onUpdate:modelValue":n[1]||(n[1]=J=>s.value=J),onKeydown:[n[2]||(n[2]=he(d(()=>{},["stop"]),["enter"])),n[3]||(n[3]=d(()=>{},["alt","stop"]))]},null,8,["model-value","read-only"]),t(f)?(c(),j("span",$e,N(t(f).toString()),1)):Le("",!0)],32)):("ncIsNull"in e?e.ncIsNull:t(B))(t(r))&&t(Q)?(c(),j("span",Ge,N(e.$t("general.null")),1)):(c(),S(_,{key:2,value:!("ncIsUndefined"in e?e.ncIsUndefined:t(Oe))(t(r))&&!("ncIsNull"in e?e.ncIsNull:t(B))(t(r))?("stringifyProp"in e?e.stringifyProp:t(Ve))(t(r)):"",lines:t(H),class:"nc-cell-field"},null,8,["value","lines"])),k(L,{placement:"bottom",class:"nc-json-expand-btn hidden absolute top-0 bottom-0 right-0"},{title:v(()=>[K(N(t(T)?e.$t("title.expand"):e.$t("tooltip.expandShiftSpace")),1)]),default:v(()=>[k(l,{type:"secondary",size:"xsmall",class:"!w-5 !h-5 !min-w-[fit-content]",onClick:d(u,["stop"])},{default:v(()=>[(c(),S(M(("iconMap"in e?e.iconMap:t(R)).maximize),{class:"w-3 h-3"}))]),_:1})]),_:1})]),_:1},40,["visible","wrap-class-name","class"])}}}),Xe=Object.assign(De(We,[["__scopeId","data-v-1a36ce18"]]),{__name:"CellJson"});export{Xe as default};
