import{e as re,r as w,fr as E,T as de,ak as ue,n as $,dB as pe,aQ as W,$ as J,g as he,bv as ce,c as r,o,ag as h,L as a,K as m,a as i,ad as fe,ao as b,cn as g,a1 as K,an as H,aq as O,t as _,I as Q,M as ge,d as ye,af as me,b as F,aJ as be,eU as X,fs as ve,_ as we}from"./DOFFjK0_.js";import{_ as $e}from"./4fFkR2QG.js";const ke=["data-test-id","onClick"],xe=["onClick"],_e=["data-test-id"],Re={key:0,class:"nc-table-extra-row"},Be={class:"flex items-center justify-center absolute left-0 top-0 w-full h-full z-10 pointer-events-none"},Ce={class:"flex flex-col justify-center items-center gap-2"},Se={class:"text-center"},Te={class:"flex-none text-center flex flex-col items-center gap-3"},He={key:0,class:"flex flex-row justify-center items-center bg-gray-50 min-h-10"},Ne={class:"flex justify-between items-center w-full px-6"},ze={class:"text-gray-500 text-xs"},De=re({__name:"Table",props:{columns:{default:()=>[]},data:{default:()=>[]},headerRowHeight:{default:"54px"},rowHeight:{default:"54px"},orderBy:{default:()=>({})},multiFieldOrderBy:{type:Boolean,default:!1},bordered:{type:Boolean,default:!0},isDataLoading:{type:Boolean,default:!1},stickyHeader:{type:Boolean,default:!0},forceStickyHeader:{type:Boolean,default:!1},stickyFirstColumn:{type:Boolean},disableTableScroll:{type:Boolean,default:!1},headerRowClassName:{default:""},bodyRowClassName:{default:""},headerCellClassName:{default:""},bodyCellClassName:{default:""},customHeaderRow:{type:Function,default:()=>({})},customRow:{type:Function,default:()=>({})},pagination:{type:Boolean,default:!1},paginationOffset:{default:10},tableToolbarClassName:{default:""}},emits:["update:orderBy","rowClick"],setup(Y,{emit:Z}){const c=Y,L=Z,ee={page:1,pageSize:25,totalRows:0,isLoading:!0},v=w(),k=w(),j=w(),I=w(),{height:te}=E(I),{height:ae,width:M}=E(k),{height:P}=E(j),y=de(c,"orderBy",L),{columns:N,data:d,isDataLoading:R,customHeaderRow:U,customRow:V}=ue(c),se=$(()=>`nc-table-header-row ${c.headerRowClassName}`),le=$(()=>`nc-table-row ${c.bodyRowClassName}`),q=pe(),z=w([]),n=w(ee),B=$(()=>c.pagination&&!R.value&&n.value.totalRows&&n.value.totalRows>c.paginationOffset),ne=$(()=>{if(!B.value)return d.value;const{page:e,pageSize:s}=n.value,u=(e-1)*s,f=u+s;return d.value.slice(u,f)}),D=$(()=>te.value||0),G=$(()=>B.value?Math.max(40,P.value):P.value),oe=e=>{if(!d.value.length||!e)return;const s={undefined:"asc",asc:"desc",desc:void 0};c.multiFieldOrderBy?y.value[e]=s[`${y.value[e]}`]:y.value={[e]:s[`${y.value[e]}`]}};W(()=>d.value.length,()=>{c.pagination&&(n.value.totalRows=d.value.length)},{immediate:!0});const A=()=>{!k.value||!M.value||ve(500).then(()=>[J(()=>{var s;const e=(s=k.value)==null?void 0:s.querySelectorAll("th > div");e&&e.length&&e.forEach((u,f)=>{z.value[f]=u.getBoundingClientRect().width||void 0})})])};W([k,M],()=>{J(()=>{A()})},{immediate:!0,flush:"post"}),he(()=>{A()}),ce(v,"scroll",()=>{var u,f,C,S,x,t;const e=(u=v.value)==null?void 0:u.querySelector("th:nth-of-type(1)"),s=(f=v.value)==null?void 0:f.querySelector("th:nth-of-type(2)");!e||!s||!((C=e==null?void 0:e.getBoundingClientRect())!=null&&C.right)||!((S=s==null?void 0:s.getBoundingClientRect())!=null&&S.left)||((s==null?void 0:s.getBoundingClientRect().left)<(e==null?void 0:e.getBoundingClientRect().right)?(x=v.value)==null||x.classList.add("sticky-border"):(t=v.value)==null||t.classList.remove("sticky-border"))});const ie=(e,s)=>{L("rowClick",e,s)};return W(()=>n.value.pageSize,()=>{n.value.page!==1&&n.value.page*n.value.pageSize>d.value.length&&(n.value.page=1)}),(e,s)=>{var x;const u=ge,f=be,C=X,S=$e;return o(),r("div",{class:h(["nc-table-container relative",{bordered:e.bordered,"nc-disable-table-scroll":e.disableTableScroll,"min-h-120":a(R)}])},[e.$slots.tableToolbar?(o(),r("div",{key:0,ref_key:"tableToolbarRef",ref:I,class:h(["nc-table-toolbar pb-4",[e.tableToolbarClassName,{"sticky z-5 top-0 bg-white":e.forceStickyHeader}]])},[b(e.$slots,"tableToolbar",{},void 0,!0)],2)):m("",!0),i("div",{ref_key:"tableWrapper",ref:v,class:h(["nc-table-wrapper relative",{"sticky-first-column":e.stickyFirstColumn,"h-full":a(d).length&&!e.disableTableScroll,"nc-scrollbar-thin !overflow-auto max-h-full":!e.disableTableScroll}]),style:g({maxHeight:e.disableTableScroll?void 0:`calc(100% - ${a(D)+a(G)}px)`})},[i("table",{ref_key:"tableHeader",ref:k,class:h(["w-full max-w-full",{"!sticky top-0 z-5":e.stickyHeader&&!e.disableTableScroll,"!sticky z-5":e.forceStickyHeader}]),style:g({...e.forceStickyHeader?{top:`${a(D)}px`}:{}})},[i("thead",null,[i("tr",K({style:{height:e.headerRowHeight},class:[`${a(se)}`]},a(U)?a(U)(a(N)):{}),[(o(!0),r(H,null,O(a(N),(t,p)=>{var l;return o(),r("th",{key:p,class:h(["nc-table-header-cell",[`${e.headerCellClassName}`,`nc-table-header-cell-${p}`,{"!hover:bg-gray-100 select-none cursor-pointer":t.showOrderBy,"cursor-not-allowed":t.showOrderBy&&!((l=a(d))!=null&&l.length),"!text-gray-700":t.showOrderBy&&(t==null?void 0:t.dataIndex)&&a(y)[t.dataIndex],"flex-1":!t.width&&!t.basis}]]),style:g({width:t.width?`${t.width}px`:void 0,flexBasis:t.width?void 0:t.basis,maxWidth:t.width?`${t.width}px`:void 0}),"data-test-id":`nc-table-header-cell-${t.name||t.key}`,onClick:T=>t.showOrderBy&&(t!=null&&t.dataIndex)?oe(t.dataIndex):void 0},[i("div",{class:h(["gap-3",[`${t.justify||""}`]]),style:g({padding:t.padding||"0px 24px",minWidth:`calc(${t.minWidth}px - 2px)`})},[b(e.$slots,"headerCell",{column:t},()=>[i("div",null,_(t.title||t.name||""),1)],!0),t.showOrderBy&&(t!=null&&t.dataIndex)?(o(),r(H,{key:0},[a(y)[t.dataIndex]?(o(),Q(u,{key:0,icon:"chevronDown",class:h(["flex-none",{"transform rotate-180":a(y)[t.dataIndex]==="asc"}])},null,8,["class"])):(o(),Q(u,{key:1,icon:"chevronUpDown",class:"flex-none"}))],64)):m("",!0)],6)],14,ke)}),128))],16)])],6),a(d).length?(o(),r("table",{key:0,class:"w-full h-full",style:g({maxHeight:e.disableTableScroll?void 0:`calc(100% - ${a(ae)}px)`})},[i("tbody",null,[b(e.$slots,"body-prepend",{},void 0,!0),(o(!0),r(H,null,O(a(ne),(t,p)=>(o(),r("tr",K({key:p,style:{height:e.rowHeight},class:[`${a(le)}`,`nc-table-row-${p}`]},{ref_for:!0},a(V)?a(V)(t,p):{},{onClick:l=>ie(t,p)}),[(o(!0),r(H,null,O(a(N),(l,T)=>(o(),r("td",{key:T,class:h(["nc-table-cell",[`${e.bodyCellClassName}`,`nc-table-cell-${p}`,{"flex-1":!l.width&&!l.basis}]]),style:g({width:l.width?`${l.width}px`:void 0,flexBasis:l.width?void 0:l.basis,maxWidth:l.width?`${l.width}px`:void 0}),"data-test-id":`nc-table-cell-${l.name||l.key}`},[i("div",{class:h([`${l.align||"items-center"} ${l.justify||""}`]),style:g({padding:l.padding||"0px 24px",minWidth:`calc(${l.minWidth}px - 2px)`,maxWidth:a(z)[T]?`${a(z)[T]}px`:void 0})},[b(e.$slots,"bodyCell",{column:l,record:t,recordIndex:p},()=>[ye(_(l!=null&&l.dataIndex&&l.key!=="action"?t[l.dataIndex]:""),1)],!0)],6)],14,_e))),128))],16,xe))),128)),a(q).extraRow?(o(),r("tr",Re,[b(e.$slots,"extraRow",{},void 0,!0)])):m("",!0)])],4)):m("",!0)],6),fe(i("div",Be,[i("div",Ce,[F(f,{size:"xlarge"}),i("span",Se,_(e.$t("general.loading")),1)])],512),[[me,a(R)]]),!a(R)&&!((x=a(d))!=null&&x.length)?(o(),r("div",{key:1,class:"flex-none nc-table-empty flex items-center justify-center py-8 px-6 h-full",style:g({maxHeight:`calc(100% - ${e.headerRowHeight} - ${a(D)+a(G)}px)`})},[i("div",Te,[b(e.$slots,"emptyText",{},()=>[F(C,{image:("Empty"in e?e.Empty:a(X)).PRESENTED_IMAGE_SIMPLE,description:e.$t("labels.noData"),class:"!my-0"},null,8,["image","description"])],!0)])],4)):m("",!0),a(q).tableFooter||a(B)?(o(),r("div",{key:2,ref_key:"tableFooterRef",ref:j},[b(e.$slots,"tableFooter",{},()=>[a(B)?(o(),r("div",He,[i("div",Ne,[s[2]||(s[2]=i("div",null,"Â ",-1)),F(S,{current:a(n).page,"onUpdate:current":s[0]||(s[0]=t=>a(n).page=t),"page-size":a(n).pageSize,"onUpdate:pageSize":s[1]||(s[1]=t=>a(n).pageSize=t),total:+(a(n).totalRows||0),"show-size-changer":"","use-stored-page-size":!1},null,8,["current","page-size","total"]),i("div",ze,_(a(n).totalRows)+" "+_(a(n).totalRows===1?"row":"rows"),1)])])):m("",!0)],!0)],512)):m("",!0)],2)}}}),Oe=Object.assign(we(De,[["__scopeId","data-v-d1f52197"]]),{__name:"NcTable"});export{Oe as _};
