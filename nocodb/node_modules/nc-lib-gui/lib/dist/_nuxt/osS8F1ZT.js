const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CMyFGii6.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./qgYlKlk5.js","./Cb5B9eG-.js","./C_qz9woQ.js","./DA4KItu_.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./D8wgK-Ih.js","./HdsRe6lq.js","./index.N-A1gxk9.css","./DzBSAsxR.js","./FilterInput.7KjqjE1F.css","./DGuB8RA-.js","./4fFkR2QG.js","./Pagination.XVPzwtel.css","./D2QgEzTv.js","./SJHyi9T4.js","./DG2ZEhLK.js","./CAfhvBOi.js","./BYGCxle3.js","./DcFNOSET.js","./boyBAVNN.js","./4PLl4EP6.js","./Bgc5K1P7.js","./DEAKw9Pl.js","./CHgOe2F-.js","./CYkscC4Z.js","./ps5He39s.js","./Cl-qOJW6.js","./BcKPINb2.js","./VirtualCell.6f0pX0MN.css"])))=>i.map(i=>d[i]);
import{e as xe,G as a,fT as ke,kO as we,kP as ge,dJ as je,gk as be,r as i,em as Le,gD as Ee,gB as Re,mm as Ve,gb as Pe,ko as ze,Y as W,iC as Ae,gE as Me,jf as Te,j7 as Oe,j3 as Ue,j8 as De,as as Se,km as Be,n as g,kr as Y,aQ as X,g as Ne,i_ as $e,kQ as Z,bz as Fe,I,o as m,w as h,a as ee,c as j,K as y,cn as He,L as t,g$ as Ke,ag as te,an as ne,aq as Ge,aC as Qe,N as U,b,O as qe,M as Je,ap as We,aS as S,P as D,bw as Ye,hU as Xe,aW as B,_ as Ze}from"./DOFFjK0_.js";import{_ as et}from"./31oN5MbZ.js";import{a as tt}from"./4PLl4EP6.js";import{u as nt}from"./CMyFGii6.js";import{u as at}from"./CV-2bRRD.js";import"./Byuk3M83.js";import"./SJHyi9T4.js";import"./D2QgEzTv.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./qgYlKlk5.js";import"./Cb5B9eG-.js";import"./C_qz9woQ.js";import"./DA4KItu_.js";import"./D8wgK-Ih.js";import"./HdsRe6lq.js";import"./DzBSAsxR.js";import"./DGuB8RA-.js";import"./4fFkR2QG.js";import"./DG2ZEhLK.js";import"./CAfhvBOi.js";import"./BYGCxle3.js";import"./Bgc5K1P7.js";import"./DEAKw9Pl.js";import"./CHgOe2F-.js";import"./CYkscC4Z.js";import"./ps5He39s.js";import"./Cl-qOJW6.js";import"./BcKPINb2.js";const ot=S(()=>B(()=>import("./CMyFGii6.js").then(o=>o.U),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(o=>o.default||o)),st=S(()=>B(()=>import("./CMyFGii6.js").then(o=>o.L),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(o=>o.default||o)),lt=S(()=>B(()=>import("./CMyFGii6.js").then(o=>o.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(o=>o.default||o)),it={class:"nc-cell-field flex items-center gap-1 w-full chips-wrapper min-h-6.5 relative"},rt=xe({__name:"HasMany",async setup(o){let N,$;const p=a(ke),c=a(we),ae=a(ge),oe=a(be,je()),F=a(Le,i(!1)),L=a(Ee,i(!1)),d=a(Re,null),f=a(Ve,null),se=a(Pe,i(!1)),x=a(ze,i(!1)),le=a(Ae,W({})),v=a(Me,null),H=a(Te,i()),ie=a(Oe,!1),E=a(De,W(Ue)),s=i(!1),l=i(!1),u=i(!1),k=i(!1),{isUIAllowed:re}=Se(),{state:R,isNew:V,removeLTARRef:ue}=tt(),{relatedTableMeta:me,loadRelatedTableMeta:ce,relatedTableDisplayValueProp:P,unlink:pe}=nt(p,ae,V,oe.trigger);[N,$]=Be(()=>ce()),await N,$();const z=g(()=>!se.value&&re("dataEdit")&&!x.value||F.value),K=g(()=>{var e;return c!=null&&c.value?(c==null?void 0:c.value)??[]:V.value?((e=R==null?void 0:R.value)==null?void 0:e[p==null?void 0:p.value.title])??[]:[]}),G=g(()=>K.value.reduce((e,n)=>{if(!P.value)return e;const C=n[P.value];return[...e,{value:C,item:n}]},[])),de=async e=>{V.value?await ue(e,p.value):await pe(e)},A=g(()=>{var e,n;return(n=(e=me.value)==null?void 0:e.columns)==null?void 0:n.find(C=>C.title===P.value)}),fe=()=>{l.value=!1,s.value=!0,k.value=!1},ve=()=>{s.value=!1,l.value=!0},_=()=>{x.value||(l.value=!0,s.value=!1,u.value=!0,k.value=!1)},M=()=>{z.value&&(s.value=!0,l.value=!1,u.value=!0,k.value=!0)};at(a(Y,i(!1)),e=>{switch(e.key){case"Enter":s.value=!0,e.stopPropagation();break}}),X([l,s],()=>{u.value=l.value||s.value}),X(u,e=>{e||(s.value=!1,l.value=!1)},{flush:"post"});const Q=a(Y,i(!1));function w(e){e.type==="click"&&(L.value||F.value||Q.value)&&_()}const T=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Ye(e))&&Xe(e))return l.value?(s.value=!1,l.value=!1):_(),!0};return Ne(()=>{f==null||f.on(w),d==null||d.on(w),v==null||v.on(T),!(x.value||!ie||L.value||!E)&&$e(()=>{T(le.event)||(Z(".nc-canvas-table-editable-cell-wrapper .nc-has-many-plus-icon",E)?M():Z(".nc-canvas-table-editable-cell-wrapper .nc-has-many-maximize-icon",E)?_():z.value?M():_())})}),Fe(()=>{f==null||f.off(w),d==null||d.off(w),v==null||v.off(T)}),(e,n)=>{const C=et,q=Je,J=qe,_e=We,ye=ot,Ce=st,Ie=lt;return m(),I(Ie,{"is-open":t(u),"onUpdate:isOpen":n[5]||(n[5]=r=>D(u)?u.value=r:null)},{overlay:h(()=>[t(s)?(m(),I(ye,{key:0,modelValue:t(s),"onUpdate:modelValue":n[1]||(n[1]=r=>D(s)?s.value=r:null),column:t(A),"hide-back-btn":t(k),onAttachLinkedRecord:ve,onEscape:n[2]||(n[2]=r=>u.value=!1)},null,8,["modelValue","column","hide-back-btn"])):y("",!0),t(l)?(m(),I(Ce,{key:1,modelValue:t(l),"onUpdate:modelValue":n[3]||(n[3]=r=>D(l)?l.value=r:null),"cell-value":t(K),column:t(A),onAttachRecord:fe,onEscape:n[4]||(n[4]=r=>u.value=!1)},null,8,["modelValue","cell-value","column"])):y("",!0)]),default:h(()=>{var r;return[ee("div",it,[ee("div",{class:te(["chips flex items-center img-container flex-1 hm-items min-w-0 overflow-y-auto overflow-x-hidden",{"flex-wrap":t(H)!==1}]),style:He({maxHeight:`${("rowHeightInPx"in e?e.rowHeightInPx:t(Ke))[t(H)]}px`})},[t(G)?(m(),j(ne,{key:0},[(m(!0),j(ne,null,Ge(t(G),(O,he)=>(m(),I(C,{key:he,item:O.item,value:O.value,column:t(A),"show-unlink-button":!1,truncate:!1,onUnlink:ut=>de(O.item)},null,8,["item","value","column","onUnlink"]))),128)),((r=t(c))==null?void 0:r.length)===10?(m(),j("span",{key:0,class:"caption pointer ml-1 grey--text",onClick:_}," more... ")):y("",!0)],64)):y("",!0)],6),!t(x)&&!t(Qe)(t(p))?(m(),j("div",{key:0,class:te(["flex justify-end gap-[2px] min-h-4 items-center absolute right-0 top-0 bottom-0 has-many-actions",{active:t(Q)}]),onClick:n[0]||(n[0]=U(()=>{},["stop"]))},[t(z)?(m(),I(J,{key:0,size:"xsmall",type:"secondary",class:"nc-action-icon nc-has-many-plus-icon",onClick:U(M,["stop"])},{default:h(()=>[b(q,{icon:"plus",class:"text-sm nc-plus"})]),_:1})):y("",!0),b(_e,{title:e.$t("tooltip.expandShiftSpace"),disabled:t(L),class:"flex"},{default:h(()=>[b(J,{size:"xsmall",type:"secondary",class:"nc-action-icon nc-has-many-maximize-icon",onClick:U(_,["stop"])},{default:h(()=>[b(q,{icon:"maximize"})]),_:1})]),_:1},8,["title","disabled"])],2)):y("",!0)])]}),_:1},8,["is-open"])}}}),St=Object.assign(Ze(rt,[["__scopeId","data-v-9507de27"]]),{__name:"VirtualCellHasMany"});export{St as default};
