import{e as Z,J as P,r as B,fo as R,aQ as U,eo as E,oM as G,ot as H,i as I,c as n,o as l,I as u,K as f,a as d,L as t,w as c,b as p,O as S,M as q,d as i,t as o,ap as J,oN as D,aT as h,b9 as b,an as g,aq as K,ag as w,cn as Q}from"./DOFFjK0_.js";import{u as W}from"./DrCpvaRA.js";import"./Bo7kLdUR.js";import"./JUJEmhCv.js";import"./SJHyi9T4.js";import"./DG2ZEhLK.js";import"./4PLl4EP6.js";import"./D2QgEzTv.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./CFDwQBzt.js";import"./D1gZ4Fpg.js";import"./C83syoBY.js";import"./CV-2bRRD.js";const X={key:1,class:"flex w-full border-b-1 py-1 h-9.5 items-center justify-between top-0"},Y={class:"text-xs"},ee={class:"flex gap-1 items-center"},te={key:0,class:"flex cursor-pointer items-center justify-center flex-col gap-4"},se={class:"p-4"},oe={class:"font-semibold text-brand-500"},le={class:"font-semibold"},ae={class:"text-brand-500 font-bold"},ne={key:1,class:"grid overflow-y-auto flex-grow-1 nc-scrollbar-md grid-cols-4 w-full h-full items-start py-2 justify-center gap-4"},ie={key:0,style:{height:"140px"},class:"flex items-center justify-center rounded-md bg-gray-300"},re=["src"],ce={class:"relative text-[12px] font-semibold items-center text-gray-800 flex"},de={class:"flex-none hide-ui transition-all transition-ease-in-out !h-4 flex items-center bg-white"},pe={class:"flex-none text-[10px] font-semibold text-gray-500"},ue={key:2,class:"flex gap-2 pt-2 bg-white w-full items-center justify-end"},me=Z({__name:"Local",emits:["update:visible","upload"],setup(fe,{emit:F}){const x=F,{isMobileMode:N}=P(),M=B(),s=B([]),{isLoading:_}=W(),{files:L,open:A}=R({reset:!0});U(L,e=>{e&&Object.values(e).forEach(a=>{s.value.push(a)})});const T=(e,a)=>{s.value.push(...e),a.preventDefault(),a.stopPropagation()},$=E(async()=>{const e=new Map;return await Promise.all(s.value.map(async a=>{const y=await G(a);y&&e.set(a,y)})),e}),O=e=>{s.value=s.value.filter(a=>a!==e)},{isOverDropZone:v}=H(M,T),V=()=>{s.value=[]},C=()=>{A()},j=()=>{x("update:visible",!1)};return I(()=>{s.value=[]}),(e,a)=>{const y=q,m=S,k=J;return l(),n("div",{class:w([{"flex flex-col relative justify-center items-center":!t(s).length},"w-full p-2 h-full"])},[t(s).length===0?(l(),u(k,{key:0,class:"absolute top-3 right-3"},{title:c(()=>[i(o(e.$t("general.close")),1)]),default:c(()=>[p(m,{type:"text",class:"!border-0",size:"xsmall",onClick:j},{default:c(()=>[p(y,{icon:"close"})]),_:1})]),_:1})):f("",!0),t(s).length>0?(l(),n("div",X,[p(m,{type:"text",size:"small",onClick:V},{default:c(()=>[i(o(e.$t("labels.clearAllFiles")),1)]),_:1}),d("span",Y,o(t(s).length)+" files, total size: "+o(("formatBytes"in e?e.formatBytes:t(D))(t(s).reduce((r,z)=>r+z.size,0),0)),1),p(m,{type:"text",size:"small",onClick:C},{default:c(()=>[d("div",ee,[(l(),u(h(("iconMap"in e?e.iconMap:t(b)).plus))),i(" "+o(e.$t("labels.addMore")),1)])]),_:1})])):f("",!0),d("div",{ref_key:"dropZoneRef",ref:M,class:w([{"border-brand-500":t(v),"border-dashed border-2":!t(s).length},"flex flex-col items-center justify-center h-full w-full flex-grow-1 rounded-lg"]),"data-testid":"attachment-drop-zone",style:Q(`height: ${t(s).length>0?"324px":"100%"}`),onClick:a[0]||(a[0]=r=>t(s).length>0?()=>{}:C())},[t(s).length?(l(),n("div",ne,[(l(!0),n(g,null,K(t(s),r=>(l(),n("div",{key:r.name,class:"flex gap-1.5 group max-w-34 pb-4 flex-col relative"},[t($).get(r)?(l(),n("img",{key:1,src:t($).get(r),style:{height:"140px"},alt:"thumbnail",class:"rounded-md object-cover"},null,8,re)):(l(),n("div",ie,[(l(),u(h(("iconMap"in e?e.iconMap:t(b)).file),{class:w(t(N)?"w-12 h-12":"w-16 h-16")},null,8,["class"]))])),d("div",ce,[p(k,{class:"flex-auto truncate",placement:"bottom"},{title:c(()=>[i(o(r.name),1)]),default:c(()=>[i(" "+o(r.name),1)]),_:2},1024),d("div",de,[p(k,{placement:"bottom"},{title:c(()=>[i(o(e.$t("title.removeFile")),1)]),default:c(()=>[(l(),u(h(("iconMap"in e?e.iconMap:t(b)).delete),{class:"!text-red-500 w-3 h-3 cursor-pointer",onClick:z=>O(r)},null,8,["onClick"]))]),_:2},1024)])]),d("div",pe,o(("formatBytes"in e?e.formatBytes:t(D))(r.size,0)),1)]))),128))])):(l(),n("div",te,[t(v)?f("",!0):(l(),n(g,{key:0},[(l(),u(h(("iconMap"in e?e.iconMap:t(b)).upload),{class:"w-8 h-8 text-gray-500"})),d("span",se,[i(o(e.$t("labels.clickTo"))+" ",1),d("span",oe,o(e.$t("labels.browseFiles")),1),i(" "+o(e.$t("general.or"))+" ",1),d("span",le,o(e.$t("labels.dragFilesHere")),1),i(" "+o(e.$t("labels.toUpload")),1)])],64)),t(v)?(l(),n(g,{key:1},[(l(),u(h(("iconMap"in e?e.iconMap:t(b)).upload),{class:"w-8 text-brand-500 h-8"})),d("h1",ae,o(e.$t("labels.dropHere")),1)],64)):f("",!0)]))],6),t(s).length?(l(),n("div",ue,[p(m,{disabled:t(_),type:"secondary",size:"small",onClick:j},{default:c(()=>[i(o(e.$t("labels.cancel")),1)]),_:1},8,["disabled"]),p(m,{loading:t(_),"data-testid":"nc-upload-file",size:"small",onClick:a[1]||(a[1]=r=>x("upload",t(s)))},{default:c(()=>[t(_)?(l(),n(g,{key:0},[i(o(e.$t("labels.uploading")),1)],64)):(l(),n(g,{key:1},[i(o(e.$t("general.upload"))+" "+o(t(s).length)+" "+o(e.$t("objects.files")),1)],64))]),_:1},8,["loading"])])):f("",!0)],2)}}}),Be=Object.assign(me,{__name:"CellAttachmentUploadProvidersLocal"});export{Be as default};
