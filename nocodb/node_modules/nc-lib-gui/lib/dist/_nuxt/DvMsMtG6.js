const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./kqvillsN.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./4PLl4EP6.js","./SJHyi9T4.js","./D2QgEzTv.js","./DcFNOSET.js","./boyBAVNN.js","./TextArea.BY8pmN2H.css"])))=>i.map(i=>d[i]);
import{e as $,aE as K,as as X,G as u,r as d,cd as J,aZ as W,fT as Z,kX as q,gb as H,jd as Q,fV as Y,gy as ee,gD as ae,T as te,n as b,L as e,c as se,I as A,K as ne,o as w,b as oe,w as G,a as j,N as le,aJ as ie,M as ue,d as de,t as re,ap as ce,ag as me,P as ve,aV as pe,aS as fe,h9 as _e,gX as Ie,aW as ge,_ as be}from"./DOFFjK0_.js";import{a as we}from"./4PLl4EP6.js";import{e as ye}from"./D2QgEzTv.js";import"./SJHyi9T4.js";import"./DcFNOSET.js";import"./boyBAVNN.js";const Ae=fe(()=>ge(()=>import("./kqvillsN.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]),import.meta.url).then(m=>m.default||m)),je=["disabled"],xe={class:"flex items-center gap-1"},Ce=$({__name:"AI",props:{modelValue:{}},emits:["update:modelValue","save"],setup(m,{emit:S}){const T=m,x=S,{generateRows:B,generatingRows:v,generatingColumnRows:p,aiIntegrations:N}=K(),{row:C}=we(),{isUIAllowed:V}=X(),k=u(J,d(!1)),r=u(W,d()),a=u(Z),M=u(q,d(!1)),P=u(H,d(!1)),z=u(Q,d(!1)),D=u(Y,d(!1)),F=u(ee,d(!1)),E=u(ae,d(!1)),o=te(T,"modelValue",x),f=d(!1),y=b(()=>{var s,i;return!!((i=(s=a.value)==null?void 0:s.colOptions)==null?void 0:i.fk_integration_id)}),c=b(()=>{var n;if((n=r.value)!=null&&n.columns)return ye(e(C).row,r.value.columns)}),R=async()=>{var _,I,g;if(!((_=r==null?void 0:r.value)!=null&&_.id)||!r.value.columns||!((I=a==null?void 0:a.value)!=null&&I.id)||!c.value)return;const n=_e((g=a.value.colOptions)==null?void 0:g.output_column_ids)&&a.value.colOptions.output_column_ids.split(",").length>1?a.value.colOptions.output_column_ids.split(","):[],s=n.map(t=>{var l,O;return(O=(l=r.value)==null?void 0:l.columnsById)==null?void 0:O[t]}).filter(Boolean);v.value.push(c.value),p.value.push(a.value.id);const i=await B(r.value.id,a.value.id,[c.value],!1,!!E.value);if(i!=null&&i.length){const t=i[0];if(n.length)for(const l of s)l&&(e(C).row[l.title]=t[l.title]);else{const l=t[a.value.title];l&&typeof l=="object"?(o.value=l,setTimeout(()=>{f.value=!1},100)):o.value={...Ie(o.value)?o.value:{},isStale:!1,value:t[a.value.title]}}}v.value=v.value.filter(t=>t!==c.value),p.value=p.value.filter(t=>t!==a.value.id)},h=b(()=>{var n;return!!(c.value&&v.value.includes(c.value)&&((n=a.value)!=null&&n.id)&&p.value.includes(a.value.id))}),L=pe(()=>{o.value={...o.value},x("save")},1e3),U=b(()=>!y.value||h.value||k.value||!V("dataEdit"));return(n,s)=>{const i=ie,_=ue,I=ce,g=Ae;return(!e(P)||e(D)||e(F))&&!e(o)?(w(),se("div",{key:0,class:me(["flex items-center w-full",{"justify-center":e(z)&&!e(E)}])},[oe(I,{disabled:e(y)||e(k)||e(V)("dataEdit"),class:"flex"},{title:G(()=>[de(re(e(N).length?n.$t("tooltip.aiIntegrationReConfigure"):n.$t("tooltip.aiIntegrationAddAndReConfigure")),1)]),default:G(()=>[j("button",{class:"nc-cell-ai-button nc-cell-button h-6",size:"small",disabled:e(U),onClick:le(R,["stop"])},[j("div",xe,[e(h)?(w(),A(i,{key:0,size:"regular"})):(w(),A(_,{key:1,icon:"ncAutoAwesome",class:"h-4 w-4"})),s[3]||(s[3]=j("span",{class:"text-small leading-[18px] truncate font-medium"},"Generate",-1))])],8,je)]),_:1},8,["disabled"])],2)):e(o)?(w(),A(g,{key:1,modelValue:e(o).value,"onUpdate:modelValue":[s[0]||(s[0]=t=>e(o).value=t),e(L)],"is-ai-edited":e(f),"onUpdate:isAiEdited":s[1]||(s[1]=t=>ve(f)?f.value=t:null),"is-ai":!0,"ai-meta":e(o),"is-field-ai-integration-available":e(y),onGenerate:R,onClose:s[2]||(s[2]=t=>M.value=!1)},null,8,["modelValue","is-ai-edited","ai-meta","is-field-ai-integration-available","onUpdate:modelValue"])):ne("",!0)}}}),Se=Object.assign(be(Ce,[["__scopeId","data-v-860c5567"]]),{__name:"CellAI"});export{Se as default};
