const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DLN_u78F.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./Pb3JMxLt.js","./C44sDnaa.js","./KFthsW2H.js","./Db9kSA7A.js","./Bo7kLdUR.js","./lL-0_K96.js","./JVTgKN82.js","./HdsRe6lq.js","./QuickImport.wmSgoVtM.css","./Bx9ACB-J.js","./C9H3ht2d.js","./CQugZrqw.js","./index._6B72PDH.css","./Co1c6GHq.js","./Cl-qOJW6.js","./CHgOe2F-.js","./CYkscC4Z.js","./ps5He39s.js","./DEAKw9Pl.js","./SpSJ8E4d.js","./BrfakvRE.js","./D_wq2ltS.js","./Item.C85DUSg3.css","./9aYOtC5C.js","./index.CotXCNy2.css","./JUJEmhCv.js","./Modal.CB1oWLel.css","./C6nWwNvX.js","./EgJz-9W8.js","./PageHeader.CSI_JqoP.css","./JKos0pQW.js","./BRY4OykS.js","./4fFkR2QG.js","./Pagination.XVPzwtel.css","./Table.Dm5r9yDu.css","./CTGo9zv-.js","./AxsiR11P.js","./CFXGfO_A.js","./VKUQM8lk.js","./SJHyi9T4.js","./BJ_KO_Ot.js","./BjlRxDgN.js","./boyBAVNN.js","./Editor.C6FZ3q1a.css","./CFDwQBzt.js","./Overlay.CpKx7Pnx.css","./Ck0WYZ6p.js","./G4Pt-Lbf.js","./DeaWGTJr.js","./D1f5NZz7.js","./CyXz1Zkk.js","./EditOrAdd.A1yfIwAk.css","./DiUleKVo.js","./BhfICdUA.js","./NRjd0XWG.js","./CPChVVVr.js","./D4c215jk.js","./BYGCxle3.js","./InviteDlg.RvOFRUtI.css","./k3vettFV.js","./EditBase.BqBNW7X_.css","./D2vSp_o0.js","./DZVK5DjD.js","./BlIUVhTI.js","./View.ChgPETCw.css","./BHzr5Pv6.js","./sgaWLnOz.js","./C7YyDL4n.js","./yDDL5Hsj.js","./CNPqpuqR.js"])))=>i.map(i=>d[i]);
import{b as ps,_ as wn,a as js}from"./C44sDnaa.js";import{e as ce,bM as Wt,e8 as Mt,dW as _s,b as s,bN as Ue,eI as kn,eJ as $n,bT as me,cy as Es,eK as Sn,cp as Cn,eL as In,cl as je,a$ as Ts,co as Tn,ck as Bs,bS as Dn,cA as Mn,eM as On,e7 as Pn,bL as Nn,n as ee,e9 as jn,el as En,bP as Bn,c as M,o as a,ag as ue,a as t,I as N,ao as os,K as A,d as V,t as m,_ as xe,f as Ae,a9 as rt,bm as As,a8 as ve,al as xt,J as wt,V as Qe,a7 as tt,aa as Kt,r as z,ai as qe,bz as An,w as n,M as ke,L as e,O as We,X as mt,a0 as vt,aS as ot,P as le,bD as ms,ad as He,af as Vt,an as pe,aT as gt,b9 as Nt,a3 as jt,cb as Us,a4 as _e,aW as lt,av as pt,T as Ge,c3 as qt,b7 as Et,c7 as Ot,$ as ct,ax as bt,as as dt,ac as Yt,aq as Be,ap as Xe,bt as Un,eN as Rn,ah as at,ez as vs,eO as fs,eP as Ds,aJ as Qt,c5 as Ln,u as Ht,eQ as Fn,G as Bt,eR as Rs,eo as Ls,bk as et,g as Je,eS as Tt,a5 as Re,aQ as Oe,Y as zn,k as Vn,bo as Gn,d3 as bs,aw as ys,ar as ft,bY as Wn,c4 as Kn,bj as Ft,ep as qn,eT as Yn,eU as Qn,eV as Fs,eW as Hn,eX as zs,U as gs,eY as hs,eZ as Ms,a6 as Jn,cr as he,d0 as _t,e_ as Zn,b$ as Xn,e$ as ea,f0 as ta,bW as ht,Q as At,f1 as Jt,f2 as Zt,a1 as Ke,bB as Vs,bC as sa,N as Ye,cn as Gs,f3 as xs,bn as Ws,aA as Xt,f4 as na,f5 as aa,f6 as it,dj as Ks,dk as ws,aG as ks,f7 as cs,f8 as oa,f9 as la,fa as ia,fb as Gt,fc as qs,du as ca,fd as rs,fe as ra,at as Ys,ff as Qs,fg as Hs,fh as Js,fi as Zs,aj as Ce,c$ as da,fj as ua,fk as pa,bV as _a,ae as ma,bJ as va,cm as ds,j as fa,bi as ba,fl as ya,fm as ga,b0 as ha,bd as xa,fn as wa,fo as ka}from"./DOFFjK0_.js";import{_ as $a}from"./Bx9ACB-J.js";import{_ as $s}from"./CQugZrqw.js";import Sa from"./Co1c6GHq.js";import{S as Ca}from"./Cl-qOJW6.js";import{S as Ia}from"./CYkscC4Z.js";import{_ as kt}from"./SpSJ8E4d.js";import{C as Xs,_ as en}from"./Db9kSA7A.js";import{_ as Ta}from"./BrfakvRE.js";import{_ as es}from"./D_wq2ltS.js";import{_ as ts}from"./9aYOtC5C.js";import{_ as Da}from"./JUJEmhCv.js";import{_ as tn}from"./C6nWwNvX.js";import{_ as Ma}from"./EgJz-9W8.js";import{_ as sn}from"./JKos0pQW.js";import{_ as nn}from"./BRY4OykS.js";import{u as an}from"./CTGo9zv-.js";import{u as ss}from"./AxsiR11P.js";import{u as Ut,_ as Ss,a as on,b as Oa}from"./CFXGfO_A.js";import{_ as Pa,a as Na,v as ja,u as Ea,d as Ba,b as Aa}from"./BJ_KO_Ot.js";import{_ as Ua}from"./CFDwQBzt.js";import{g as Os,a as ls}from"./Ck0WYZ6p.js";import{_ as Ra}from"./VKUQM8lk.js";import ln from"./DiUleKVo.js";import{D as La}from"./BhfICdUA.js";import{u as Fa}from"./SJHyi9T4.js";import{u as za}from"./CPChVVVr.js";import{_ as Va}from"./HdsRe6lq.js";import{_ as Ga,R as Wa}from"./D4c215jk.js";import Ka from"./BjlRxDgN.js";import{u as cn}from"./C9H3ht2d.js";import{u as qa}from"./BYGCxle3.js";var Ya=["class","style"],Qa=function(){return{prefixCls:String,href:String,separator:me.any,overlay:me.any,onClick:Function}};const Pt=ce({compatConfig:{MODE:3},name:"ABreadcrumbItem",inheritAttrs:!1,__ANT_BREADCRUMB_ITEM:!0,props:Qa(),slots:["separator","overlay"],setup:function(o,y){var g=y.slots,c=y.attrs,$=Wt("breadcrumb",o),I=$.prefixCls,w=function(x,P){var p=Mt(g,o,"overlay");return p?s($n,{overlay:p,placement:"bottom"},{default:function(){return[s("span",{class:"".concat(P,"-overlay-link")},[x,s(kn,null,null)])]}}):x};return function(){var f,x=(f=Mt(g,o,"separator"))!==null&&f!==void 0?f:"/",P=Mt(g,o),p=c.class,i=c.style,r=_s(c,Ya),_;return o.href!==void 0?_=s("a",Ue({class:"".concat(I.value,"-link"),onClick:o.onClick},r),[P]):_=s("span",Ue({class:"".concat(I.value,"-link"),onClick:o.onClick},r),[P]),_=w(_,I.value),P?s("span",{class:p,style:i},[_,x&&s("span",{class:"".concat(I.value,"-separator")},[x])]):null}}});var Ha=function(){return{prefixCls:String,routes:{type:Array},params:me.any,separator:me.any,itemRender:{type:Function}}};function Ja(S,o){if(!S.breadcrumbName)return null;var y=Object.keys(o).join("|"),g=S.breadcrumbName.replace(new RegExp(":(".concat(y,")"),"g"),function(c,$){return o[$]||c});return g}function Ps(S){var o=S.route,y=S.params,g=S.routes,c=S.paths,$=g.indexOf(o)===g.length-1,I=Ja(o,y);return $?s("span",null,[I]):s("a",{href:"#/".concat(c.join("/"))},[I])}const yt=ce({compatConfig:{MODE:3},name:"ABreadcrumb",props:Ha(),slots:["separator","itemRender"],setup:function(o,y){var g=y.slots,c=Wt("breadcrumb",o),$=c.prefixCls,I=c.direction,w=function(p,i){return p=(p||"").replace(/^\//,""),Object.keys(i).forEach(function(r){p=p.replace(":".concat(r),i[r])}),p},f=function(p,i,r){var _=Tn(p),l=w(i||"",r);return l&&_.push(l),_},x=function(p){var i=p.routes,r=i===void 0?[]:i,_=p.params,l=_===void 0?{}:_,T=p.separator,k=p.itemRender,u=k===void 0?Ps:k,E=[];return r.map(function(L){var h=w(L.path,l);h&&E.push(h);var O=[].concat(E),U=null;return L.children&&L.children.length&&(U=s(Ts,null,{default:function(){return[L.children.map(function(K){return s(Ts.Item,{key:K.path||K.breadcrumbName},{default:function(){return[u({route:K,params:l,routes:r,paths:f(O,K.path,l)})]}})})]}})),s(Pt,{overlay:U,separator:T,key:h||L.breadcrumbName},{default:function(){return[u({route:L,params:l,routes:r,paths:O})]}})})};return function(){var P,p,i,r=o.routes,_=o.params,l=_===void 0?{}:_,T=Es(Mt(g,o)),k=(P=Mt(g,o,"separator"))!==null&&P!==void 0?P:"/",u=o.itemRender||g.itemRender||Ps;r&&r.length>0?i=x({routes:r,params:l,separator:k,itemRender:u}):T.length&&(i=T.map(function(L,h){return Sn(Cn(L.type)==="object"&&(L.type.__ANT_BREADCRUMB_ITEM||L.type.__ANT_BREADCRUMB_SEPARATOR),"Breadcrumb","Only accepts Breadcrumb.Item and Breadcrumb.Separator as it's children"),In(L,{separator:k,key:h})}));var E=(p={},je(p,$.value,!0),je(p,"".concat($.value,"-rtl"),I.value==="rtl"),p);return s("div",{class:E},[i])}}});var Za=["separator","class"],Xa=function(){return{prefixCls:String}};const us=ce({compatConfig:{MODE:3},name:"ABreadcrumbSeparator",__ANT_BREADCRUMB_SEPARATOR:!0,inheritAttrs:!1,props:Xa(),setup:function(o,y){var g=y.slots,c=y.attrs,$=Wt("breadcrumb",o),I=$.prefixCls;return function(){var w;c.separator;var f=c.class,x=_s(c,Za),P=Es((w=g.default)===null||w===void 0?void 0:w.call(g));return s("span",Ue({class:["".concat(I.value,"-separator"),f]},x),[P.length>0?P:"/"])}}});yt.Item=Pt;yt.Separator=us;yt.install=function(S){return S.component(yt.name,yt),S.component(Pt.name,Pt),S.component(us.name,us),S};var eo=["prefixCls"];const to=ce({compatConfig:{MODE:3},name:"Steps",props:{type:me.string.def("default"),prefixCls:me.string.def("vc-steps"),iconPrefix:me.string.def("vc"),direction:me.string.def("horizontal"),labelPlacement:me.string.def("horizontal"),status:me.string.def("process"),size:me.string.def(""),progressDot:me.oneOfType([me.looseBool,me.func]).def(void 0),initial:me.number.def(0),current:me.number.def(0),icons:me.shape({finish:me.any,error:me.any}).loose,stepIcon:Function},slots:["stepIcon","progressDot"],emits:["change"],setup:function(o,y){var g=y.slots,c=y.emit,$=function(w){var f=o.current;f!==w&&c("change",w)};return function(){var I,w,f=o.prefixCls,x=o.direction,P=o.type,p=o.labelPlacement,i=o.iconPrefix,r=o.status,_=o.size,l=o.current,T=o.progressDot,k=T===void 0?g.progressDot:T,u=o.initial,E=o.icons,L=o.stepIcon,h=L===void 0?g.stepIcon:L,O=P==="navigation",U=k?"vertical":p,D=Bs(f,"".concat(f,"-").concat(x),(I={},je(I,"".concat(f,"-").concat(_),_),je(I,"".concat(f,"-label-").concat(U),x==="horizontal"),je(I,"".concat(f,"-dot"),!!k),je(I,"".concat(f,"-navigation"),O),I)),K=Dn((w=g.default)===null||w===void 0?void 0:w.call(g));return s("div",{class:D},[K.map(function(B,b){var q=B.props||{},se=q.prefixCls,C=se===void 0?f:se,oe=_s(q,eo),Z=u+b,Y=Ue(Ue({},oe),{},{stepNumber:Z+1,stepIndex:Z,key:Z,prefixCls:C,iconPrefix:i,progressDot:k,icons:E,stepIcon:h,onStepClick:$});return r==="error"&&b===l-1&&(Y.class="".concat(f,"-next-error")),oe.status||(Z===l?Y.status=r:Z<l?Y.status="finish":Y.status="wait"),Y.active=Z===l,Mn(B,Y)})])}}});function Ns(S){return typeof S=="string"}function so(){}var rn=function(){return{prefixCls:String,wrapperStyle:{type:Object,default:void 0},itemWidth:String,active:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},status:String,iconPrefix:String,icon:me.any,adjustMarginRight:String,stepNumber:Number,stepIndex:Number,description:me.any,title:me.any,subTitle:me.any,progressDot:On(me.oneOfType([me.looseBool,me.func])),tailContent:me.any,icons:me.shape({finish:me.any,error:me.any}).loose,onClick:Function,onStepClick:Function,stepIcon:Function}};const no=ce({compatConfig:{MODE:3},name:"Step",props:rn(),slots:["title","subTitle","description","tailContent","stepIcon","progressDot"],emits:["click","stepClick"],setup:function(o,y){var g=y.slots,c=y.emit,$=function(f){c("click",f),c("stepClick",o.stepIndex)},I=function(f){var x,P=f.icon,p=f.title,i=f.description,r=o.prefixCls,_=o.stepNumber,l=o.status,T=o.iconPrefix,k=o.icons,u=o.progressDot,E=u===void 0?g.progressDot:u,L=o.stepIcon,h=L===void 0?g.stepIcon:L,O,U=(x={},je(x,"".concat(r,"-icon"),!0),je(x,"".concat(T,"icon"),!0),je(x,"".concat(T,"icon-").concat(P),P&&Ns(P)),je(x,"".concat(T,"icon-check"),!P&&l==="finish"&&k&&!k.finish),je(x,"".concat(T,"icon-close"),!P&&l==="error"&&k&&!k.error),x),D=s("span",{class:"".concat(r,"-icon-dot")},null);return E?typeof E=="function"?O=s("span",{class:"".concat(r,"-icon")},[E({iconDot:D,index:_-1,status:l,title:p,description:i,prefixCls:r})]):O=s("span",{class:"".concat(r,"-icon")},[D]):P&&!Ns(P)?O=s("span",{class:"".concat(r,"-icon")},[P]):k&&k.finish&&l==="finish"?O=s("span",{class:"".concat(r,"-icon")},[k.finish]):k&&k.error&&l==="error"?O=s("span",{class:"".concat(r,"-icon")},[k.error]):P||l==="finish"||l==="error"?O=s("span",{class:U},null):O=s("span",{class:"".concat(r,"-icon")},[_]),h&&(O=h({index:_-1,status:l,title:p,description:i,node:O})),O};return function(){var w,f,x,P,p,i=o.prefixCls,r=o.itemWidth,_=o.active,l=o.status,T=l===void 0?"wait":l,k=o.tailContent,u=o.adjustMarginRight,E=o.disabled,L=o.title,h=L===void 0?(w=g.title)===null||w===void 0?void 0:w.call(g):L,O=o.description,U=O===void 0?(f=g.description)===null||f===void 0?void 0:f.call(g):O,D=o.subTitle,K=D===void 0?(x=g.subTitle)===null||x===void 0?void 0:x.call(g):D,B=o.icon,b=B===void 0?(P=g.icon)===null||P===void 0?void 0:P.call(g):B,q=o.onClick,se=o.onStepClick,C=(p={},je(p,"".concat(i,"-item"),!0),je(p,"".concat(i,"-item-").concat(T),!0),je(p,"".concat(i,"-item-custom"),b),je(p,"".concat(i,"-item-active"),_),je(p,"".concat(i,"-item-disabled"),E===!0),p),oe={class:C},Z={};r&&(Z.width=r),u&&(Z.marginRight=u);var Y={onClick:q||so};return se&&!E&&(Y.role="button",Y.tabindex=0,Y.onClick=$),s("div",Ue(Ue({},oe),{},{style:Z}),[s("div",Ue(Ue({},Y),{},{class:"".concat(i,"-item-container")}),[s("div",{class:"".concat(i,"-item-tail")},[k]),s("div",{class:"".concat(i,"-item-icon")},[I({icon:b,title:h,description:U})]),s("div",{class:"".concat(i,"-item-content")},[s("div",{class:"".concat(i,"-item-title")},[h,K&&s("div",{title:K,class:"".concat(i,"-item-subtitle")},[K])]),U&&s("div",{class:"".concat(i,"-item-description")},[U])])])])}}});var ao=function(){return{prefixCls:String,iconPrefix:String,current:Number,initial:Number,percent:Number,responsive:{type:Boolean,default:void 0},labelPlacement:String,status:String,size:String,direction:String,progressDot:{type:[Boolean,Function],default:void 0},type:String,onChange:Function,"onUpdate:current":Function}},is=ce({compatConfig:{MODE:3},name:"ASteps",inheritAttrs:!1,props:Nn(ao(),{current:0,responsive:!0,labelPlacement:"horizontal"}),slots:["progressDot"],setup:function(o,y){var g=y.attrs,c=y.slots,$=y.emit,I=Wt("steps",o),w=I.prefixCls,f=I.direction,x=I.configProvider,P=za(),p=ee(function(){return o.responsive&&P.value.xs?"vertical":o.direction}),i=ee(function(){return x.getPrefixCls("",o.iconPrefix)}),r=function(T){$("update:current",T),$("change",T)},_=function(T){var k=T.node,u=T.status;if(u==="process"&&o.percent!==void 0){var E=o.size==="small"?32:40,L=s("div",{class:"".concat(w,"-progress-icon")},[s(Va,{type:"circle",percent:o.percent,width:E,strokeWidth:4,format:function(){return null}},null),k]);return L}return k};return function(){var l,T=Bs((l={},je(l,"".concat(w.value,"-rtl"),f.value==="rtl"),je(l,"".concat(w.value,"-with-progress"),o.percent!==void 0),l),g.class),k={finish:s(En,{class:"".concat(w,"-finish-icon")},null),error:s(jn,{class:"".concat(w,"-error-icon")},null)};return s(to,Ue(Ue({icons:k},Bn(o,["percent","responsive"])),{},{direction:p.value,prefixCls:w.value,iconPrefix:i.value,class:T,onChange:r}),Ue(Ue({},c),{},{stepIcon:_}))}}}),zt=ce(Ue(Ue({compatConfig:{MODE:3}},no),{},{name:"AStep",props:rn()}));const oo=Pn(is,{Step:zt,install:function(o){return o.component(is.name,is),o.component(zt.name,zt),o}}),lo={class:"icon-wrapper"},io={class:"flex flex-col gap-1"},co={class:"label"},ro={key:0,class:"subtext"},uo=ce({__name:"Item",props:{disabled:{type:Boolean},label:{},subtext:{},isLoading:{type:Boolean}},setup(S){return(o,y)=>{const g=Ca,c=Ia;return a(),M("div",{role:"button",class:ue(["nc-base-view-all-table-btn",{disabled:o.disabled,"loading cursor-wait":o.isLoading,"cursor-pointer":!o.isLoading}])},[t("div",lo,[o.isLoading?(a(),N(g,{key:0,active:"",shape:"square",class:"!h-full !w-full !children:rounded-md !children:w-8 !children:h-8"})):os(o.$slots,"icon",{key:1},void 0,!0)]),t("div",io,[t("div",co,[o.isLoading?(a(),N(c,{key:0,active:"",title:!1,paragraph:{rows:1}})):os(o.$slots,"label",{key:1},()=>[V(m(o.label),1)],!0)]),o.$slots.subtext||o.subtext||o.isLoading?(a(),M("div",ro,[o.isLoading?(a(),N(c,{key:0,active:"",title:"",paragraph:!1})):os(o.$slots,"subtext",{key:1},()=>[V(m(o.subtext),1)],!0)])):A("",!0)])],2)}}}),po=Object.assign(xe(uo,[["__scopeId","data-v-6117eeb8"]]),{__name:"ProjectActionItem"}),_o={};function mo(S,o){const y=kt;return a(),N(y)}const vo=Object.assign(xe(_o,[["render",mo]]),{__name:"ProjectActionCreateEmptyScript"}),fo={};function bo(S,o){const y=kt;return a(),N(y)}const yo=Object.assign(xe(fo,[["render",bo]]),{__name:"ProjectActionScriptsByNocoDB"}),go={};function ho(S,o){const y=kt;return a(),N(y)}const xo=Object.assign(xe(go,[["render",ho]]),{__name:"ProjectActionCreateEmptyDashboard"}),wo=ot(()=>lt(()=>import("./DLN_u78F.js"),__vite__mapDeps([0,1,2]),import.meta.url).then(S=>S.default||S)),ko={class:"text-base font-weight-bold flex items-center gap-4 mb-6"},$o={key:0},So={key:1},Co={key:2},Io={key:3,href:"https://docs.nocodb.com/bases/import-base-from-nocodb#get-nocodb-credentials",class:"!text-gray-500 prose-sm ml-auto",target:"_blank",rel:"noopener"},To={key:0},Do={class:"mb-2"},Mo={class:"mt-2"},Oo={key:1},Po={class:"flex items-start gap-2"},No={class:"flex flex-row items-center gap-2 mb-2"},jo={class:"text-gray-500 text-[13px] leading-5 ml-6"},Eo={key:2,class:"flex items-start gap-3"},Bo={key:0,class:"text-right mt-4"},Ao={key:0,class:"flex justify-between mt-2"},Uo=ce({__name:"NocoDbImport",props:{modelValue:{type:Boolean},baseId:{},transition:{},showBackBtn:{type:Boolean}},emits:["update:modelValue","back"],setup(S,{emit:o}){const y=o,{$api:g}=Ae(),{t:c}=rt(),{copy:$}=As(),{activeWorkspace:I}=ve(xt()),{appInfo:w}=wt(),{ncSiteUrl:f}=w.value,{$poller:x}=Ae(),P=Qe(),p=tt(),{refreshCommandPalette:i}=Kt(),r=z(!1),_=z(1),l=z(),T=z(),k=z(!1),u=z(null),E=z(!1),L=z(!1),h=z(0),O=ee(()=>h.value>=2),U=z({baseId:S.baseId,workspaceMode:!1,newBase:!1,secretToken:null}),D=ee(()=>U.value.secretToken?`${f}/?secret=${U.value.secretToken}`:""),K=G=>{var v;(v=l.value)==null||v.pushProgress(G.message,"progress"),T.value={msg:G.message,status:"progress"}},B=async(G,v)=>{var H,ne,j,d;T.value={msg:v==null?void 0:v.message,status:G},G===qe.COMPLETED?(r.value=!0,U.value.workspaceMode||U.value.newBase?await p.loadProjects():await P.loadProject(),(H=l.value)==null||H.pushProgress("Done!",G),i()):G===qe.FAILED&&(U.value.workspaceMode||U.value.newBase?await p.loadProjects():await P.loadProject(),E.value=!0,(j=l.value)==null||j.pushProgress((ne=v==null?void 0:v.error)==null?void 0:ne.message,G),T.value={msg:(d=v==null?void 0:v.error)==null?void 0:d.message,status:G},i())},b=ee({get:()=>S.modelValue,set:G=>y("update:modelValue",G)});async function q(){var G;if((G=I.value)!=null&&G.id){k.value=!0;try{const v=await g.internal.postOperation(I.value.id,S.baseId,{operation:"listenRemoteImport"},U.value);U.value.secretToken=v.secret,u.value=v.id,x.subscribe({id:u.value},H=>{H.status!=="close"?H.status?B(H.status,H.data):(_.value=2,K(H.data)):L.value=!1}),await $(D.value),_e.info(c("msg.info.copiedToClipboard"))}catch(v){console.error(v),_e.error("Failed to start listening"),k.value=!1}}}async function se(){var G;(G=I.value)!=null&&G.id&&(U.value.secretToken&&await g.internal.postOperation(I.value.id,S.baseId,{operation:"abortRemoteImport"},{secret:U.value.secretToken}),u.value&&x.unsubscribe({id:u.value}),k.value=!1,L.value=!1,b.value=!1,y("back"))}async function C(){_.value=1,T.value=null,U.value.secretToken=null,k.value=!1}const oe=ee(()=>{var G;return!T.value||![qe.COMPLETED,qe.FAILED].includes((G=T.value)==null?void 0:G.status)}),Z=z(!1),Y=z("");return An(()=>{u.value&&x.unsubscribe({id:u.value})}),(G,v)=>{const H=ke,ne=We,j=wo,d=vt,R=ms,J=en,re=Xs,Ie=mt,$e=ps,ye=Ta,Le=Us;return a(),N(Le,{visible:e(b),"onUpdate:visible":v[8]||(v[8]=Ee=>le(b)?b.value=Ee:null),class:ue(["!top-[25vh]",{active:e(b)}]),closable:!1,"transition-name":G.transition,keyboard:e(_)!==2,"mask-closable":e(_)!==2,width:"448px","wrap-class-name":"nc-modal-nocodb-import",hide:"",onKeydown:v[9]||(v[9]=jt(Ee=>b.value=!1,["esc"]))},{footer:n(()=>[e(_)===1?(a(),M("div",Ao,[e(k)?(a(),N(ne,{key:"abort",type:"danger",size:"small",onClick:se},{default:n(()=>[V(m(G.$t("general.abort")),1)]),_:1})):(a(),N(ne,{key:"back",type:"text",size:"small",onClick:v[7]||(v[7]=()=>{b.value=!1,y("back")})},{default:n(()=>[G.showBackBtn?(a(),N(H,{key:0,icon:"chevronLeft",class:"mr-1"})):A("",!0),V(" "+m(G.showBackBtn?G.$t("general.back"):G.$t("general.cancel")),1)]),_:1})),e(k)?(a(),N(ne,{key:2,type:"ghost",class:"nc-btn-nocodb-import",size:"small",loading:e(k),onClick:q},{default:n(()=>v[16]||(v[16]=[V(" Listening ")])),_:1,__:[16]},8,["loading"])):(a(),N(ne,{key:3,type:"primary",class:"nc-btn-nocodb-import",size:"small",onClick:q},{default:n(()=>v[17]||(v[17]=[V(" Generate & Copy URL ")])),_:1,__:[17]}))])):A("",!0)]),default:n(()=>{var Ee,Pe,Fe;return[t("div",ko,[s(H,{icon:"nocodb1",class:"w-6 h-6",onDblclick:v[0]||(v[0]=ge=>h.value++)}),e(_)===1?(a(),M("span",$o,m(G.$t("title.quickImportNocoDB")),1)):e(oe)?(a(),M("span",So,m(`${G.$t("labels.importingFromNocoDB")}...`),1)):(a(),M("span",Co,m(G.$t("labels.nocoDBBaseImported")),1)),e(_)===1?(a(),M("a",Io," Docs ")):e(_)===2?(a(),N(ne,{key:4,type:"text",size:"xs",class:"ml-auto",onClick:v[1]||(v[1]=ge=>Z.value=!e(Z))},{default:n(()=>[V(m(e(Z)?"Hide":"Show")+" Details ",1),s(H,{icon:"chevronDown",class:ue(["ml-2 transition-all transform",{"rotate-180":e(Z)}])},null,8,["class"])]),_:1})):A("",!0)]),e(_)===1?(a(),M("div",To,[v[12]||(v[12]=t("div",{class:"text-gray-600 text-sm px-2"},[t("p",{class:"mb-2"},"Easily migrate your base with the following steps:"),t("ol",{class:"list-decimal list-inside mt-2 pl-1"},[t("li",null,[V("Open "),t("strong",null,"settings"),V(" in your NocoDB base")]),t("li",null,[V("Navigate to "),t("strong",null,"Migrate"),V(" tab")]),t("li",null,[V("Paste the "),t("strong",null,"URL")]),t("li",null,[V("Click "),t("strong",null,"Migrate")])])],-1)),s(Ie,{ref:"form",model:e(U),name:"quick-import-nocodb-form",layout:"horizontal",class:"!m-0 w-full"},{default:n(()=>[e(k)?(a(),N(d,{key:0,class:"!mt-0 !pb-2 !mb-0"},{default:n(()=>[s(j,{"model-value":e(D),class:"!rounded-lg !mt-2 nc-input-shared-base"},null,8,["model-value"])]),_:1})):A("",!0),e(O)&&!e(k)?(a(),N(ne,{key:1,class:"!mt-2",type:"text",size:"small",onClick:v[2]||(v[2]=ge=>Y.value=e(Y)?"":"advanced-settings")},{default:n(()=>[V(m(G.$t("title.advancedSettings"))+" ",1),s(H,{icon:"chevronDown",class:ue(["ml-2 !transition-all !transform",{"!rotate-180":e(Y)==="advanced-settings"}])},null,8,["class"])]),_:1})):A("",!0),e(k)?A("",!0):(a(),N(re,{key:2,"active-key":e(Y),"onUpdate:activeKey":v[5]||(v[5]=ge=>le(Y)?Y.value=ge:null),ghost:"",class:"nc-import-collapse"},{default:n(()=>[s(J,{key:"advanced-settings"},{default:n(()=>[t("div",Do,[s(R,{checked:e(U).newBase,"onUpdate:checked":v[3]||(v[3]=ge=>e(U).newBase=ge)},{default:n(()=>v[10]||(v[10]=[V(" New Base ")])),_:1,__:[10]},8,["checked"])]),t("div",Mo,[s(R,{checked:e(U).workspaceMode,"onUpdate:checked":v[4]||(v[4]=ge=>e(U).workspaceMode=ge)},{default:n(()=>v[11]||(v[11]=[V(" Workspace Mode ")])),_:1,__:[11]},8,["checked"])])]),_:1})]),_:1},8,["active-key"]))]),_:1},8,["model"])])):A("",!0),e(_)===2?(a(),M("div",Oo,[He(s($e,{ref_key:"progressRef",ref:l,class:"w-full h-[200px]"},null,512),[[Vt,e(Z)]]),He(t("div",Po,[e(oe)?(a(),M(pe,{key:0},[(a(),N(gt(("iconMap"in G?G.iconMap:e(Nt)).loading),{class:"text-primary animate-spin mt-1"})),t("span",null,m(((Ee=e(T))==null?void 0:Ee.msg)??"---"),1)],64)):((Pe=e(T))==null?void 0:Pe.status)===e(qe).FAILED?(a(),N(ye,{key:1,class:"!rounded-lg !bg-transparent !border-gray-200 !p-3 !w-full"},{message:n(()=>[t("div",No,[s(H,{icon:"ncAlertCircleFilled",class:"text-red-500 w-4 h-4"}),v[13]||(v[13]=t("span",{class:"font-weight-700 text-[14px]"},"Import error",-1))])]),description:n(()=>{var ge;return[t("div",jo,m(((ge=e(T))==null?void 0:ge.msg)??"---"),1)]}),default:n(()=>[v[14]||(v[14]=V(" > "))]),_:1,__:[14]})):(a(),M("div",Eo,[s(H,{icon:"checkFill",class:"text-white w-4 h-4 mt-0.75"}),t("span",null,m(G.$t("msg.nocoDBImportSuccess")),1)]))],512),[[Vt,!e(Z)]]),e(oe)?A("",!0):(a(),M("div",Bo,[((Fe=e(T))==null?void 0:Fe.status)===e(qe).FAILED?(a(),N(ne,{key:0,size:"small",onClick:C},{default:n(()=>v[15]||(v[15]=[V(" Retry import ")])),_:1,__:[15]})):(a(),N(ne,{key:1,size:"small",onClick:v[6]||(v[6]=ge=>b.value=!1)},{default:n(()=>[V(m(e(U).workspaceMode||e(U).newBase?"Go To Dashboard":"Go To Base"),1)]),_:1}))]))])):A("",!0)]}),_:1},8,["visible","class","transition-name","keyboard","mask-closable"])}}}),Ro=Object.assign(xe(Uo,[["__scopeId","data-v-1c311989"]]),{__name:"DlgNocoDbImport"}),Lo={class:"flex flex-col px-6 pt-6 pb-9"},Fo={class:"flex items-center gap-3 mb-6"},zo={class:"text-base font-weight-700"},Vo={class:"ml-1 text-[13px] font-weight-700"},Go={class:"ml-1 text-[13px] font-weight-700"},Wo={class:"ml-1 text-[13px] font-weight-700"},Ko={class:"ml-1 text-[13px] font-weight-700"},qo={class:"ml-1 text-[13px] font-weight-700"},Yo=ce({__name:"ImportModal",props:{visible:{type:Boolean},source:{}},emits:["update:visible"],setup(S,{emit:o}){const y=S,g=o,c=pt(y,"source"),$=Ge(y,"visible",g),{$e:I}=Ae(),{isFeatureEnabled:w}=qt(),{showRecordPlanLimitExceededModal:f}=Et();async function x(r,_){if(!r||!_)return;I("a:actions:import-airtable");const l=z(!0);await ct(),$.value=!1;const{close:T}=bt(wn,{modelValue:l,baseId:r,sourceId:_,"onUpdate:modelValue":k,showBackBtn:!0,onBack:()=>{$.value=!0}});function k(){l.value=!1,T(1e3)}}async function P(r){if(!r)return;const _=z(!0);await ct(),$.value=!1;const{close:l}=bt(Ro,{modelValue:_,baseId:r,"onUpdate:modelValue":T,showBackBtn:!0,onBack:()=>{$.value=!0}});function T(){_.value=!1,l(1e3)}}async function p(r){if(!c.value.id||!c.value.base_id)return;I(`a:actions:import-${r}`);const _=z(!0);await ct(),$.value=!1;const{close:l}=bt(js,{modelValue:_,importType:r,baseId:c.value.base_id,sourceId:c.value.id,"onUpdate:modelValue":T,showBackBtn:!0,onBack:()=>{$.value=!0}});function T(){_.value=!1,l(1e3)}}const i=r=>{f()||(r==="airtable"?x(c.value.base_id,c.value.id):r==="nocodb"?P(c.value.base_id):p(r))};return(r,_)=>{const l=ke,T=es,k=ts,u=Da;return a(),N(u,{visible:e($),"onUpdate:visible":_[5]||(_[5]=E=>le($)?$.value=E:null),width:"448px",class:"!top-[25vh]"},{default:n(()=>[t("div",Lo,[t("div",Fo,[t("div",zo,m(r.$t("labels.importDataFrom")),1)]),s(k,{class:"border-1 divide-y-1 nc-import-items-menu overflow-clip"},{default:n(()=>[s(T,{onClick:_[0]||(_[0]=E=>i("airtable"))},{default:n(()=>[s(l,{icon:"importAirtable",class:"w-5 h-5"}),t("span",Vo,m(r.$t("labels.airtable")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(T,{onClick:_[1]||(_[1]=E=>i("csv"))},{default:n(()=>[s(l,{icon:"importCsv",class:"w-5 h-5"}),t("span",Go,m(r.$t("labels.csv")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(T,{onClick:_[2]||(_[2]=E=>i("json"))},{default:n(()=>[s(l,{icon:"importJson",class:"w-5 h-5"}),t("span",Wo,m(r.$t("labels.jsonCapitalized")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),s(T,{onClick:_[3]||(_[3]=E=>i("excel"))},{default:n(()=>[s(l,{icon:"importExcel",class:"w-5 h-5"}),t("span",Ko,m(r.$t("labels.excel")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1}),e(w)(("FEATURE_FLAG"in r?r.FEATURE_FLAG:e(Ot)).IMPORT_FROM_NOCODB)?(a(),N(T,{key:0,onClick:_[4]||(_[4]=E=>i("nocodb"))},{default:n(()=>[s(l,{icon:"nocodb1",class:"w-5 h-5"}),t("span",qo,m(r.$t("objects.syncData.nocodb")),1),s(l,{icon:"chevronRight",class:"ml-auto text-lg"})]),_:1})):A("",!0)]),_:1})])]),_:1},8,["visible"])}}}),Qo=Object.assign(xe(Yo,[["__scopeId","data-v-84abb2af"]]),{__name:"ProjectImportModal"}),Ho=ot(()=>lt(()=>Promise.resolve().then(()=>di),void 0,import.meta.url).then(S=>S.default||S)),Jo=ot(()=>lt(()=>Promise.resolve().then(()=>Br),void 0,import.meta.url).then(S=>S.default||S)),Zo={class:"nc-all-tables-view p-6 nc-scrollbar-thin",style:{height:"calc(100vh - var(--topbar-height) - 44px)"}},Xo={class:"text-subHeading2 text-nc-content-gray mb-5"},el=ce({__name:"Overview",setup(S){const{openedProject:o,isDataSourceLimitReached:y}=ve(tt()),g=Qe(),{base:c}=ve(g),{isFeatureEnabled:$}=qt(),I=z(!1),w=z(!1),{isUIAllowed:f}=dt(),{$e:x}=Ae(),{showExternalSourcePlanLimitExceededModal:P}=Et(),p=z(!1),i=ee(()=>{var T,k;return(k=(T=o.value)==null?void 0:T.sources)==null?void 0:k[0]});function r(T){var h,O;x("c:table:create:navdraw");const k=z(!0);let u=(h=o.value.sources)==null?void 0:h[0].id;if(!u||!((O=o.value)!=null&&O.id))return;const{close:E}=bt(Un,{modelValue:k,sourceId:u,baseId:o.value.id,onCreate:L,"onUpdate:modelValue":()=>L()});function L(U){k.value=!1,U&&(setTimeout(()=>{const D=document.querySelector(`[data-table-id="${U.id}"]`);D&&(D==null||D.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),E(1e3))}}const _=()=>{P()||y.value||(I.value=!0)},l=()=>{w.value=!0};return(T,k)=>{var q,se,C,oe,Z,Y,G,v,H,ne;const u=po,E=ke,L=Xe,h=vo,O=yo,U=xo,D=Qo,K=Ho,B=Jo,b=Yt("e");return a(),M("div",Zo,[t("div",Xo,m(T.$t("labels.actions")),1),t("div",{class:ue(["flex flex-row gap-6 flex-wrap max-w-[1000px]",{"pointer-events-none":(q=e(c))==null?void 0:q.isLoading}])},[(se=e(c))!=null&&se.isLoading?(a(),M(pe,{key:0},Be(7,j=>s(u,{key:j,"is-loading":"",label:"loading"})),64)):(a(),M(pe,{key:1},[e(f)("tableCreate",{source:(oe=(C=e(c))==null?void 0:C.sources)==null?void 0:oe[0]})?(a(),N(u,{key:0,label:T.$t("dashboards.create_new_table"),subtext:T.$t("msg.subText.startFromScratch"),"data-testid":"proj-view-btn__add-new-table",onClick:k[0]||(k[0]=j=>r())},{icon:n(()=>[s(E,{icon:"addOutlineBox",class:"!h-8 !w-8 !text-brand-500"})]),_:1},8,["label","subtext"])):A("",!0),e(f)("tableCreate",{source:(Y=(Z=e(c))==null?void 0:Z.sources)==null?void 0:Y[0]})?He((a(),N(u,{key:1,"data-testid":"proj-view-btn__import-data",label:`${T.$t("activity.import")} ${T.$t("general.data")}`,subtext:T.$t("msg.subText.importData"),onClick:k[1]||(k[1]=j=>p.value=!0)},{icon:n(()=>[s(E,{icon:"download",class:"!h-7.5 !w-7.5 !text-orange-700"})]),_:1},8,["label","subtext"])),[[b,["c:table:import"]]]):A("",!0),e(f)("sourceCreate")?(a(),N(L,{key:2,placement:"bottom",disabled:!e(y),class:"flex-none flex"},{title:n(()=>[V(m(T.$t("tooltip.reachedSourceLimit")),1)]),default:n(()=>[He((a(),N(u,{"data-testid":"proj-view-btn__create-source",disabled:e(y),label:T.$t("labels.connectDataSource"),subtext:T.$t("msg.subText.connectExternalData"),onClick:_},{icon:n(()=>[s(E,{icon:"server1",class:"!h-7 !w-7 !text-green-700"})]),_:1},8,["disabled","label","subtext"])),[[b,["c:table:create-source"]]])]),_:1},8,["disabled"])):A("",!0),e($)(("FEATURE_FLAG"in T?T.FEATURE_FLAG:e(Ot)).SYNC)&&e(f)("tableCreate",{source:(v=(G=e(c))==null?void 0:G.sources)==null?void 0:v[0]})?He((a(),N(u,{key:3,"data-testid":"proj-view-btn__create-sync",label:T.$t("labels.syncData"),subtext:T.$t("msg.subText.syncData"),onClick:l},{icon:n(()=>[s(E,{icon:"ncZap",class:"!h-7 !w-7 !text-green-700"})]),_:1},8,["label","subtext"])),[[b,["c:table:create-sync"]]]):A("",!0),s(h),s(O),s(U)],64))],2),e(i)?(a(),N(D,{key:0,visible:e(p),"onUpdate:visible":k[2]||(k[2]=j=>le(p)?p.value=j:null),source:e(i)},null,8,["visible","source"])):A("",!0),e(I)?(a(),N(K,{key:1,open:e(I),"onUpdate:open":k[3]||(k[3]=j=>le(I)?I.value=j:null),"is-modal":""},null,8,["open"])):A("",!0),e(w)&&((H=e(c))!=null&&H.id)?(a(),N(B,{key:2,open:e(w),"onUpdate:open":k[4]||(k[4]=j=>le(w)?w.value=j:null),"base-id":(ne=e(c))==null?void 0:ne.id},null,8,["open","base-id"])):A("",!0)])}}}),tl=Object.assign(el,{__name:"ProjectOverview"}),sl={};function nl(S,o){const y=kt;return a(),N(y)}const al=Object.assign(xe(sl,[["render",nl]]),{__name:"ProjectPrivateOverlay"}),ol={class:"flex items-center justify-between"},ll={key:0,class:"text-gray-500 text-xs"},il={class:"flex items-center justify-between"},cl={key:0,class:"text-gray-500 text-xs"},rl=ce({__name:"Selector",props:{role:{},roles:{},disabledRoles:{},onRoleChange:{},border:{type:Boolean,default:!0},description:{type:Boolean,default:!0},inherit:{},size:{default:"sm"},showInherit:{type:Boolean,default:!1}},setup(S){const o=S,y=pt(o,"role"),g=pt(o,"inherit"),c=pt(o,"showInherit"),$=pt(o,"description"),I=z(!1),w=z(null),f=pt(o,"size"),x=z(null);async function P(i){x.value=i,await o.onRoleChange(i),x.value=null,I.value=!1}Rn(w,i=>{var r;(r=i.target)!=null&&r.closest(".nc-role-selector-dropdown")||(I.value=!1)});const p=i=>{x.value||i!==y.value||(I.value=!1)};return(i,r)=>{const _=sn,l=Xe,T=ke,k=fs,u=Qt,E=vs,L=Yt("e");return a(),M("div",{ref_key:"dropdownRef",ref:w,size:"lg",class:"nc-roles-selector relative flex items-center gap-3",onClick:r[0]||(r[0]=h=>I.value=!e(I))},[s(_,{border:!1,inherit:e(g)===i.role,role:e(y),size:e(f),clickable:"","data-testid":"roles",class:"flex-none"},null,8,["inherit","role","size"]),e(c)&&("isEeUI"in i?i.isEeUI:e(at))&&e(g)===i.role?(a(),N(l,{key:0,class:"uppercase text-[10px] leading-4 text-gray-500",placement:"bottom"},{title:n(()=>[V(m(i.$t("tooltip.roleInheritedFromWorkspace")),1)]),default:n(()=>[V(" "+m(i.$t("objects.workspace")),1)]),_:1})):A("",!0),s(E,{value:e(y),open:e(I),"dropdown-match-select-width":!1,"dropdown-class-name":"!rounded-lg !h-fit max-w-[350px] nc-role-selector-dropdown",class:"py-1 !absolute top-0 left-0 w-20 h-full z-10 text-xs opacity-0",onChange:P},{default:n(()=>[(a(!0),M(pe,null,Be(o.disabledRoles||[],h=>(a(),N(k,{key:h,value:h,disabled:""},{default:n(()=>[t("div",{class:ue([{"w-full":e($),"w-[200px]":!e($)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",ol,[s(_,{disabled:"",border:!1,inherit:e(g)===h,role:h},null,8,["inherit","role"]),!e(x)&&h===e(y)?(a(),N(T,{key:0,icon:"check",class:"text-primary"})):A("",!0)]),e($)?(a(),M("div",ll,m(e(Ds)[h]),1)):A("",!0)],2)]),_:2},1032,["value"]))),128)),(a(!0),M(pe,null,Be(o.roles,h=>He((a(),N(k,{key:h,value:h,disabled:!!e(x),onClick:O=>p(h)},{default:n(()=>[t("div",{class:ue([{"w-full":e($),"w-[200px]":!e($)},"flex flex-col nc-role-select-dropdown gap-1"])},[t("div",il,[s(_,{border:!1,class:ue(`nc-role-select-${h}`),inherit:e(g)===h,role:h},null,8,["class","inherit","role"]),h===e(x)?(a(),N(u,{key:0,size:"medium"})):!e(x)&&h===e(y)?(a(),N(T,{key:1,icon:"check",class:"text-primary"})):A("",!0)]),e($)?(a(),M("div",cl,m(e(Ds)[h]),1)):A("",!0)],2)]),_:2},1032,["value","disabled","onClick"])),[[L,["c:workspace:settings:user-role-change"]]])),128))]),_:1},8,["value","open"])],512)}}}),dl=Object.assign(rl,{__name:"RolesSelector"}),ul=Ln("orgStore",()=>{const S=z(),o=z(null);return{org:S,orgId:o,updateOrg:async c=>{},loadOrg:async()=>{}}}),pl=ot(()=>lt(()=>import("./Pb3JMxLt.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61]),import.meta.url).then(S=>S.default||S)),_l={key:0},ml={class:"nc-breadcrumb px-2"},vl={class:"nc-breadcrumb-item"},fl={class:"nc-breadcrumb-item"},bl={class:"nc-breadcrumb-item active truncate capitalize"},yl={class:"nc-page-header-icon flex justify-center items-center h-5 w-5"},gl={"data-rec":"true",class:"capitalize"},hl={class:"nc-content-max-w h-full flex flex-col items-center gap-6 px-6 pt-6"},xl={key:1,class:"w-full flex justify-between items-center max-w-full gap-3"},wl={class:"flex items-center gap-1"},kl={key:1,class:"w-full flex gap-3 items-center users-email-grid"},$l={class:"flex flex-col flex-1 max-w-[calc(100%_-_44px)]"},Sl={class:"flex gap-3"},Cl={key:2},Il={key:3},Tl=ce({__name:"AccessSettings",props:{baseId:{}},setup(S){const o=S,y=Ht(),{isPrivateBase:g,base:c}=ve(Qe()),$=tt(),{getBaseUsers:I,createProjectUser:w,updateProjectUser:f,removeProjectUser:x}=$,{activeProjectId:P,bases:p,basesUser:i}=ve($),{orgRoles:r,baseRoles:_,loadRoles:l,isUIAllowed:T}=dt(),{sorts:k,sortDirection:u,loadSorts:E,handleGetSortedData:L,saveOrUpdate:h}=an("Project"),O=ee(()=>{var W;return(W=r.value)==null?void 0:W[Fn.SUPER_ADMIN]}),U=ul(),{orgId:D,org:K}=ve(U),B=Bt(Rs,z(!1)),{$api:b}=Ae(),{t:q}=rt(),{projectPageTab:se}=ve(ss()),{isPaymentEnabled:C,showUserPlanLimitExceededModal:oe}=Et(),Z=Ls(async()=>{let W;return o.baseId?(await l(o.baseId),W=p.value.get(o.baseId),W||(W=await b.base.read(o.baseId))):W=p.value.get(P.value),W}),Y=z(!1),G=z([]),v=z(0),H=z(""),ne=z(!1),j=z([]),d=ee(()=>G.value.filter(W=>{var ae,de;return((de=(ae=W.display_name)==null?void 0:ae.toLowerCase())==null?void 0:de.includes(H.value.toLowerCase()))||W.email.toLowerCase().includes(H.value.toLowerCase())})),R=ee(()=>L(d.value,k.value)),J=async()=>{try{if(!Z.value)return;const{users:W,totalRows:ae}=await I({baseId:Z.value.id,...H.value?{searchText:H.value}:{},force:!0});v.value=ae,G.value=[...W.filter(de=>!(de!=null&&de.deleted)).map(de=>({...de,base_roles:de.roles,roles:de.roles??(de.workspace_roles?Ft[de.workspace_roles]??et.NO_ACCESS:et.NO_ACCESS)}))]}catch(W){_e.error(await Re(W))}},re=ee(()=>{var W,ae;return((W=_.value)==null?void 0:W[et.OWNER])||((ae=_.value)==null?void 0:ae[et.CREATOR])}),Ie=async(W,ae)=>{const de=G.value.find(we=>we.id===W.id);try{!ae||ae===et.NO_ACCESS&&!at?(await x(Z.value.id,de),de.workspace_roles&&Ft[de.workspace_roles]===ae&&at||(de.roles=et.NO_ACCESS),de.base_roles=null):de.base_roles?(de.roles=ae,await f(Z.value.id,de)):(de.roles=ae,de.base_roles=ae,await w(Z.value.id,de));let we=i.value.get(Z.value.id);we!=null&&we.length&&(we=we.map(Ve=>(Ve.id===de.id&&(Ve.roles=de.roles),Ve)),i.value.set(Z.value.id,we))}catch(we){const Ve=await Fs(we);if(C.value&&Ve.error===Hn.PLAN_LIMIT_EXCEEDED){const Ze=Ve.details;oe({details:Ze,role:ae})}else _e.error(Ve.message)}finally{J()}},$e=ee(()=>{var W,ae;return((W=c.value)==null?void 0:W.default_role)&&!((ae=_.value)!=null&&ae[et.OWNER])});Je(async()=>{if(!$e.value){ne.value=!0;try{await J();const W=Tt.findIndex(ae=>_.value&&Object.keys(_.value).includes(ae));O.value?j.value=Tt.slice(0):W!==-1&&(j.value=Tt.slice(W)),E()}catch(W){_e.error(await Re(W))}finally{ne.value=!1}}}),Oe(_,W=>{const ae=Tt.findIndex(de=>W&&Object.keys(W).includes(de));j.value=Tt.slice(ae)});const ye=zn({}),Le=W=>{d.value.forEach(ae=>{ye[ae.id]=W})},Ee=ee({get:()=>Object.values(ye).every(W=>W)&&Object.keys(ye).length>0&&Object.values(ye).length===d.value.length,set:W=>{Le(W)}});Oe(Y,()=>{Y.value||J()}),Oe(Z,()=>{J()});const Pe=ee({get:()=>u.value,set:W=>{if(Object.keys(W).length===0){h({});return}const[ae,de]=Object.entries(W)[0];h({field:ae,direction:de})}}),Fe=[{key:"select",title:"",width:70,minWidth:70},{key:"email",title:q("objects.users"),minWidth:220,dataIndex:"email",showOrderBy:!0},{key:"role",title:q("general.role"),basis:"30%",minWidth:272,dataIndex:"roles",showOrderBy:!0},{key:"created_at",title:q("title.dateJoined"),basis:"25%",minWidth:200}],ge=W=>({class:`${ye[W.id]?"selected":""} user-row`}),ze=ee(()=>{var W;return((W=G.value)==null?void 0:W.filter(ae=>ae.roles===et.OWNER).length)===1}),st=W=>!(ze.value&&W.roles===et.OWNER),nt=()=>{y.push({query:{...y.currentRoute.value.query,page:"base-settings",tab:"baseType"}})};return Oe(se,()=>{H.value&&(H.value="")}),(W,ae)=>{var Rt,Lt;const de=al,we=ke,Ve=tn,Ze=Gn,Q=Ma,F=We,ie=bs,fe=ft,X=Qn,Te=Wn,Ne=Kn,Se=Xe,De=dl,ns=sn,St=nn,as=pl,Ct=Vn("x");return a(),M("div",{class:ue(["nc-collaborator-table-container nc-access-settings-view flex flex-col relative",{"h-[calc(100vh_-_100px)]":!e(B)}])},[e($e)?(a(),N(de,{key:0})):(a(),M(pe,{key:1},[e(B)?(a(),M("div",_l,[t("div",ml,[t("div",vl,m(e(K).title),1),s(we,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),s(Ve,{href:`/admin/${e(D)}/bases`,class:"!hover:text-gray-800 !hover:underline-gray-600 flex items-center !text-gray-700 !underline-transparent max-w-1/4"},{default:n(()=>[t("div",fl,m(W.$t("objects.projects")),1)]),_:1},8,["href"]),s(we,{icon:"ncSlash1",class:"nc-breadcrumb-divider"}),t("div",bl,m((Rt=e(Z))==null?void 0:Rt.title),1)]),s(Q,null,{icon:n(()=>[t("div",yl,[s(Ze,{readonly:""})])]),title:n(()=>{var Me;return[t("span",gl,m((Me=e(Z))==null?void 0:Me.title),1)]}),_:1})])):A("",!0),t("div",hl,[("isEeUI"in W?W.isEeUI:e(at))&&e(g)?(a(),N(ie,{key:0,type:"info",message:W.$t("title.privateBase"),class:"bg-nc-bg-gray-extralight"},ys({icon:n(()=>[s(we,{icon:"ncUser",class:"w-6 h-6 text-nc-content-gray-subtle"})]),description:n(()=>[V(m(W.$t("title.privateBaseAlertDescription")),1)]),_:2},[e(T)("manageBaseType")?{name:"action",fn:n(()=>[s(F,{type:"secondary",size:"small",class:"!mt-[-4px]","inner-class":"!gap-1.5","icon-position":"right",onClick:nt},{icon:n(()=>[s(we,{icon:"ncArrowUpRight",class:"w-4 h-4"})]),default:n(()=>[V(" "+m(W.$t("activity.goToBaseSettings")),1)]),_:1})]),key:"0"}:void 0]),1032,["message"])):A("",!0),e(B)?A("",!0):(a(),M("div",xl,[s(fe,{value:e(H),"onUpdate:value":ae[0]||(ae[0]=Me=>le(H)?H.value=Me:null),placeholder:W.$t("title.searchMembers"),disabled:e(ne),"allow-clear":"",class:"nc-input-border-on-value !max-w-90 !h-8 !px-3 !py-1 !rounded-lg"},{prefix:n(()=>[s(we,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500 group-hover:text-black"})]),_:1},8,["value","placeholder","disabled"]),s(F,{disabled:e(ne),size:"small",onClick:ae[1]||(ae[1]=Me=>Y.value=!0)},{default:n(()=>[t("div",wl,[(a(),N(gt(("iconMap"in W?W.iconMap:e(Nt)).plus),{class:"w-4 h-4"})),V(" "+m(W.$t("activity.addMembers")),1)])]),_:1},8,["disabled"])])),s(St,{"order-by":e(Pe),"onUpdate:orderBy":ae[3]||(ae[3]=Me=>le(Pe)?Pe.value=Me:null),"is-data-loading":e(ne),columns:Fe,data:e(R),bordered:!1,"custom-row":ge,class:"flex-1 nc-collaborators-list max-w-full","body-row-class-name":"!cursor-default",pagination:!0,"pagination-offset":25},{emptyText:n(()=>[s(X,{description:W.$t("title.noMembersFound")},null,8,["description"])]),headerCell:n(({column:Me})=>[Me.key==="select"?(a(),N(Te,{key:0,checked:e(Ee),"onUpdate:checked":ae[2]||(ae[2]=be=>le(Ee)?Ee.value=be:null),disabled:!e(R).length},null,8,["checked","disabled"])):(a(),M(pe,{key:1},[V(m(Me.title),1)],64))]),bodyCell:n(({column:Me,record:be})=>[Me.key==="select"?(a(),N(Te,{key:0,checked:e(ye)[be.id],"onUpdate:checked":It=>e(ye)[be.id]=It},null,8,["checked","onUpdate:checked"])):A("",!0),Me.key==="email"?(a(),M("div",kl,[s(Ne,{size:"base",user:be,class:"flex-none"},null,8,["user"]),t("div",$l,[t("div",Sl,[s(Se,{class:"truncate max-w-full text-gray-800 capitalize font-semibold","show-on-truncate-only":""},{title:n(()=>[V(m(be.display_name||be.email.slice(0,be.email.indexOf("@"))),1)]),default:n(()=>[V(" "+m(be.display_name||be.email.slice(0,be.email.indexOf("@"))),1)]),_:2},1024)]),s(Se,{class:"truncate max-w-full text-xs text-gray-600","show-on-truncate-only":""},{title:n(()=>[V(m(be.email),1)]),default:n(()=>[V(" "+m(be.email),1)]),_:2},1024)])])):A("",!0),Me.key==="role"?(a(),M("div",Cl,[st(be)&&e(re)&&e(j).includes(be.roles)?(a(),N(De,{key:0,role:be.roles,roles:e(j),inherit:("isEeUI"in W?W.isEeUI:e(at))&&be.workspace_roles&&e(Ft)[be.workspace_roles]?e(Ft)[be.workspace_roles]:null,"show-inherit":"",description:!1,"on-role-change":It=>Ie(be,It)},null,8,["role","roles","inherit","on-role-change"])):(a(),N(ns,{key:1,border:!1,role:be.roles},null,8,["role"]))])):A("",!0),Me.key==="created_at"?(a(),M("div",Il,[s(Se,{class:"max-w-full"},{title:n(()=>[V(m(("parseStringDateTime"in W?W.parseStringDateTime:e(Yn))(be.created_at)),1)]),default:n(()=>[t("span",null,m(("timeAgo"in W?W.timeAgo:e(qn))(be.created_at)),1)]),_:2},1024)])):A("",!0)]),_:1},8,["order-by","is-data-loading","data"])]),s(as,{"model-value":e(Y),"onUpdate:modelValue":ae[4]||(ae[4]=Me=>le(Y)?Y.value=Me:null),"base-id":(Lt=e(Z))==null?void 0:Lt.id,users:e(G),type:"base"},null,8,["model-value","base-id","users"])],64)),s(Ct)],2)}}}),Dl=Object.assign(xe(Tl,[["__scopeId","data-v-2dd74b73"]]),{__name:"ProjectAccessSettings"}),Ml=ce({__name:"Permissions",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(S){return(o,y)=>{const g=kt;return a(),N(g)}}}),Ol=Object.assign(Ml,{__name:"DashboardSettingsPermissions"}),Pl={class:"flex flex-col gap-1"},Nl={class:"flex items-center gap-3"},jl={class:"ml-10 text-small leading-[18px] text-gray-500"},El={class:"flex flex-col gap-1"},Bl={class:"flex items-center gap-3"},Al=ce({__name:"SourceRestrictions",props:{allowMetaWrite:{type:Boolean},allowDataWrite:{type:Boolean}},emits:["update:allowMetaWrite","update:allowDataWrite"],setup(S,{emit:o}){const y=S,g=o,c=Ge(y,"allowDataWrite",g),$=Ge(y,"allowMetaWrite",g);return(I,w)=>{const f=zs,x=Xe,P=vt;return a(),M(pe,null,[s(P,{class:"nc-source-restictions-card"},{default:n(()=>[t("div",Pl,[t("div",Nl,[s(x,{disabled:!e($),placement:"topLeft",class:"flex"},{title:n(()=>[V(m(I.$t("tooltip.dataWriteOptionDisabled")),1)]),default:n(()=>[s(f,{checked:e(c),"onUpdate:checked":w[0]||(w[0]=p=>le(c)?c.value=p:null),disabled:e($),"data-testid":"nc-allow-data-write",size:"small"},null,8,["checked","disabled"])]),_:1},8,["disabled"]),t("span",{class:"cursor-pointer",onClick:w[1]||(w[1]=p=>e($)?void 0:c.value=!e(c))},m(I.$t("labels.allowDataWrite")),1)]),t("div",jl,m(I.$t("tooltip.allowDataWrite")),1)])]),_:1}),s(P,{class:"nc-source-restictions-card"},{default:n(()=>[t("div",El,[t("div",Bl,[s(f,{checked:e($),"onUpdate:checked":w[2]||(w[2]=p=>le($)?$.value=p:null),"data-testid":"nc-allow-meta-write",class:"nc-allow-meta-write",size:"small"},null,8,["checked"]),t("span",{class:"cursor-pointer",onClick:w[3]||(w[3]=p=>$.value=!e($))},m(I.$t("labels.allowMetaWrite")),1)]),t("div",{class:ue(["ml-10 text-small leading-[18px] text-gray-500",{"nc-allow-meta-write-help":e($)}])},m(I.$t("labels.notRecommended"))+": "+m(I.$t("tooltip.allowMetaWrite")),3)])]),_:1})],64)}}}),Ul=Object.assign(xe(Al,[["__scopeId","data-v-b77d1107"]]),{__name:"DashboardSettingsDataSourcesSourceRestrictions"}),Rl={class:"w-full flex flex-col gap-3"},Ll={class:"h-7 w-7 flex items-center justify-center"},Fl=["href"],zl=ce({__name:"SupportedDocs",setup(S){const o=[{title:"Integrations",href:"https://nocodb.com/docs/product-docs/integrations"},{title:"Create new connection",href:"https://nocodb.com/docs/product-docs/integrations/create-connection"},{title:"Add new Data source",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source"}];return(y,g)=>{const c=ke;return a(),M("div",Rl,[g[0]||(g[0]=t("div",{class:"text-sm text-gray-800 font-semibold"},"Relevant documentation",-1)),t("div",null,[(a(),M(pe,null,Be(o,($,I)=>t("div",{key:I,class:"flex items-center gap-1"},[t("div",Ll,[s(c,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),t("a",{href:$.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-600 text-sm !no-underline !hover:underline"},m($.title),9,Fl)])),64))])])}}}),Vl=Object.assign(zl,{__name:"DashboardSettingsDataSourcesSupportedDocs"}),Gl={class:"flex-1 flex flex-col max-h-full"},Wl={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},Kl={class:"h-6 self-start flex items-center"},ql={class:"flex items-center gap-3"},Yl={class:"h-[calc(100%_-_58px)] flex"},Ql={class:"nc-add-source-left-panel nc-scrollbar-thin relative"},Hl={class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},Jl={class:"nc-form-section"},Zl={class:"nc-form-section-body"},Xl=["data-testid"],ei={class:"w-full flex items-center gap-2 px-2 py-2 rounded-md hover:bg-gray-100"},ti={class:"nc-form-section"},si={class:"nc-form-section-body"},ni={class:"nc-form-section"},ai={class:"nc-form-section-body"},oi={class:"flex flex-col gap-4"},li={class:"flex flex-col gap-4"},ii={class:"flex items-center justify-center h-full w-full !bg-white !bg-opacity-85 z-1000"},ci={class:"nc-add-source-right-panel"},ri=ce({__name:"CreateBase",props:{open:{type:Boolean},connectionType:{}},emits:["update:open","sourceCreated"],setup(S,{emit:o}){const y=S,g=o,c=Ge(y,"open",g),{loadIntegrations:$,integrations:I,eventBus:w,pageMode:f,IntegrationsPageMode:x}=Ut(),P=Qe(),{loadProject:p}=tt(),{base:i}=ve(P),{loadProjectTables:r}=gs(),{refreshCommandPalette:_}=Kt(),l=Bt(hs,void 0),T=ee(()=>{var Q;return(l==null?void 0:l.value)??((Q=i.value)==null?void 0:Q.id)}),k=ee(()=>I.value.filter(Q=>Q.sub_type!==Ms.NOCODB)),u=mt.useForm,E=z(!1),L=z(!1),h=z(),{api:O}=Jn(),{$e:U}=Ae(),{t:D}=rt(),{isUIAllowed:K}=dt(),B=z(!1),b=z([]),q=z(!1),C=z(((Q=he.MYSQL)=>({title:"",dataSource:{...Os(Q)},inflection:{inflectionColumn:"none",inflectionTable:"none"},sslUse:na.No,extraParameters:[],is_schema_readonly:!0,is_data_readonly:!1}))()),oe=z(!1),Z=z(0),Y=()=>{Z.value+=1,Z.value>=2&&(oe.value=!0)},G=ee(()=>C.value.fk_integration_id&&I.value.find(Q=>Q.id===C.value.fk_integration_id)),v=ee(()=>{var Q,F,ie;return(ie=(F=(Q=G.value)==null?void 0:Q.config)==null?void 0:F.connection)==null?void 0:ie.database}),H=ee(()=>{var Q,F,ie;return(ie=(F=(Q=G.value)==null?void 0:Q.config)==null?void 0:F.searchPath)==null?void 0:ie[0]}),ne=Q=>v.value,j=ee(()=>{let Q={"dataSource.connection.database":G.value&&ne()?[]:[_t()]};switch(C.value.dataSource.client){case he.SQLITE:Q={};break;case he.SNOWFLAKE:Q={"dataSource.connection.database":[_t()],"dataSource.connection.schema":[_t()]};break;case he.PG:Q["dataSource.searchPath.0"]=G.value?[]:[_t()];break}return{title:[{required:!0,message:D("labels.sourceNameRequired")},Xn()],fk_integration_id:[{required:!0,message:"Connection is required"}],extraParameters:[Zn],...Q}}),{validate:d,validateInfos:R,clearValidate:J}=u(C.value,j),re=()=>{C.value.dataSource={...Os(C.value.dataSource.client)}},Ie=["camelize","none"];function $e(){const Q=Object.fromEntries(new Map(C.value.extraParameters.filter(ie=>{var fe;return(fe=ie.key)==null?void 0:fe.trim()}).map(ie=>[ie.key,ie.value]))),F={...C.value.dataSource.connection,...Q};return F.ssl=ja(F,C.value.sslUse,C.value.dataSource.client),F}const ye=()=>{var Q,F,ie,fe,X;(X=(fe=(ie=(F=(Q=h.value)==null?void 0:Q.$el.querySelector(".ant-form-item-explain-error"))==null?void 0:F.parentNode)==null?void 0:ie.parentNode)==null?void 0:fe.querySelector("input"))==null||X.focus()},{$poller:Le}=Ae(),Ee=async()=>{var Q,F;try{await d()}catch{ye();return}try{if(!T.value)return;B.value=!0;const ie=$e(),fe={...C.value.dataSource,connection:ie};G.value&&(((Q=fe.connection)==null?void 0:Q.database)===""&&(fe.connection.database=void 0),((F=fe.searchPath)==null?void 0:F[0])===""&&(fe.searchPath=void 0));const X=await O.source.create(T.value,{fk_integration_id:C.value.fk_integration_id,alias:C.value.title,type:C.value.dataSource.client,config:fe,inflection_column:C.value.inflection.inflectionColumn,inflection_table:C.value.inflection.inflectionTable,is_schema_readonly:C.value.is_schema_readonly,is_data_readonly:C.value.is_data_readonly});Le.subscribe({id:X.id},async Te=>{var Ne,Se;Te.status!=="close"&&(Te.status===qe.COMPLETED?(U("a:base:create:extdb"),T.value&&(await p(T.value,!0),await r(T.value,!0)),g("sourceCreated"),c.value=!1,B.value=!1):Te.status===qe.FAILED&&(_e.error(((Se=(Ne=Te==null?void 0:Te.data)==null?void 0:Ne.error)==null?void 0:Se.message)||"Failed to create base"),B.value=!1))})}catch(ie){_e.error(await Re(ie)),B.value=!1}finally{_()}},Pe=z(),Fe=async()=>{try{await d()}catch{ye();return}U("a:source:create:extdb:test-connection",[]);try{if(L.value=!0,C.value.dataSource.client===he.SQLITE)E.value=!0;else{const Q=$e();Q.database=aa(C.value.dataSource);let F=C.value.dataSource.searchPath;G.value&&(F==null?void 0:F[0])===""&&(F=void 0);const ie={...C.value.dataSource,connection:Q,searchPath:F,fk_integration_id:C.value.fk_integration_id},fe=await O.utils.testConnection(ie);fe.code===0?E.value=!0:(E.value=!1,_e.error(`${D("msg.error.dbConnectionFailed")} ${fe.message}`))}}catch(Q){E.value=!1,Pe.value=await Re(Q)}L.value=!1};Oe(()=>C.value.dataSource,()=>{E.value=!1,Pe.value=null},{deep:!0}),Je(async()=>{var Q;q.value=!0,I.value.length||await $(!0,(Q=i.value)==null?void 0:Q.id),C.value.title=await ea(),ct(()=>{setTimeout(()=>{var ie,fe;const F=(fe=(ie=h.value)==null?void 0:ie.$el)==null?void 0:fe.querySelector("input[type=text]");F==null||F.setSelectionRange(0,C.value.title.length),F==null||F.focus()},500)}),q.value=!1});const ge=ee({get:()=>!C.value.is_schema_readonly,set:Q=>{C.value.is_schema_readonly=!Q,Q&&(C.value.is_data_readonly=!1),U("c:source:schema-write-toggle",{allowed:!Q,edit:!0})}}),ze=ee({get:()=>!C.value.is_data_readonly,set:Q=>{C.value.is_data_readonly=!Q,U("c:source:data-write-toggle",{allowed:!Q})}}),st=(Q=!1)=>{var F;C.value.fk_integration_id&&G.value?C.value.dataSource={client:G.value.sub_type,connection:{database:v.value},searchPath:(F=G.value.config)==null?void 0:F.searchPath}:re(),J(),Q&&setTimeout(()=>{Fe()},300)},nt=()=>{f.value=x.LIST};w.on((Q,F)=>{Q===ta.INTEGRATION_ADD&&(F!=null&&F.id)&&(C.value.fk_integration_id=F.id,ht(()=>{var ie;return((ie=G.value)==null?void 0:ie.id)===F.id}).toBeTruthy().then(()=>{st(!0)}))});const W=Q=>{Q?(b.value=["1"],de(!0,"nc-source-advanced-options")):b.value=[]};let ae;function de(Q,F){ae&&clearTimeout(ae),ct(()=>{const ie=document.querySelector(`.create-source .${F}`);ie&&(ae=setTimeout(()=>{ie.scrollIntoView({block:"center",behavior:"smooth"})},400))})}const we=Q=>[xs.DATABASE].includes(Q.value),Ve=Q=>Q.sub_type!==Ms.NOCODB&&Q.isAvailable,Ze=(Q={})=>{switch(Q.sub_type){case he.SQLITE:return{isDisabled:(Q==null?void 0:Q.source_count)&&Q.source_count>0,msg:"Sqlite support only 1 database per connection"};default:return{isDisabled:!1,msg:""}}};return(Q,F)=>{const ie=ke,fe=We,X=Xe,Te=ft,Ne=vt,Se=Zt,De=Jt,ns=Ss,St=fs,as=sa,Ct=Vs,Rt=Ul,Lt=en,Me=Xs,be=mt,It=Pa,fn=Na,bn=Ws,yn=Ua,gn=Vl,hn=Xt,xn=At;return a(),N(xn,{visible:e(c),"onUpdate:visible":F[18]||(F[18]=te=>le(c)?c.value=te:null),closable:!1,"mask-closable":!e(B),keyboard:!e(B),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:F[19]||(F[19]=jt(te=>c.value=!1,["esc"]))},{default:n(()=>[t("div",Gl,[t("div",Wl,[t("div",Kl,[s(ie,{icon:"server1",class:"!text-green-700 !h-4 !w-4"})]),F[21]||(F[21]=t("div",{class:"flex-1 text-base font-weight-700"},"Add Data Source",-1)),t("div",ql,[t("div",{class:"w-[15px] h-[15px] cursor-pointer",onDblclick:Y},null,32),s(X,{disabled:!e(Pe)},{title:n(()=>[V(m(e(Pe)),1)]),default:n(()=>[s(fe,{type:"secondary",size:"small",class:ue(["nc-extdb-btn-test-connection",{"pointer-events-none":e(E)}]),disabled:!e(G)||e(q),loading:e(L),"icon-position":"right",onClick:F[0]||(F[0]=te=>Fe())},{icon:n(()=>[e(E)?(a(),N(ie,{key:0,icon:"circleCheckSolid",class:"!text-green-700 w-4 h-4"})):e(Pe)?(a(),N(ie,{key:1,icon:"alertTriangleSolid",class:"!text-red-700 w-4 h-4"})):A("",!0)]),default:n(()=>[t("span",null,m(e(E)?"Test successful":"Test connection"),1)]),_:1},8,["class","disabled","loading"])]),_:1},8,["disabled"]),s(fe,{size:"small",type:"primary",disabled:!e(E)||!e(G)||e(q),loading:e(B),class:"nc-extdb-btn-submit",onClick:Ee},{default:n(()=>F[20]||(F[20]=[V(" Add Source ")])),_:1,__:[20]},8,["disabled","loading"]),s(fe,{disabled:e(B),size:"small",type:"text",onClick:F[1]||(F[1]=te=>c.value=!1)},{default:n(()=>[s(ie,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",Yl,[t("div",Ql,[t("div",Hl,[s(be,{ref_key:"form",ref:h,model:e(C),"hide-required-mark":"",name:"external-base-create-form",layout:"vertical","no-style":"",class:"flex flex-col gap-5.5"},{default:n(()=>[t("div",Jl,[t("div",Zl,[s(De,{gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:"Data Source Name"},e(R).title),{default:n(()=>[s(Te,{value:e(C).title,"onUpdate:value":F[2]||(F[2]=te=>e(C).title=te)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),s(De,{gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:"Select connection"},e(R).fk_integration_id),{default:n(()=>[s(Ct,{value:e(C).fk_integration_id,"onUpdate:value":F[4]||(F[4]=te=>e(C).fk_integration_id=te),class:"nc-extdb-db-type nc-select-shadow","dropdown-class-name":"nc-dropdown-ext-db-type",placeholder:"Select connection","allow-clear":"","show-search":"","dropdown-match-select-width":"",onChange:F[5]||(F[5]=te=>st())},ys({default:n(()=>[(a(!0),M(pe,null,Be(e(k),te=>(a(),N(St,{key:te.id,value:te.id,disabled:Ze(te).isDisabled},{default:n(()=>[t("div",{class:"w-full flex gap-2 items-center","data-testid":te.title},[te!=null&&te.sub_type?(a(),N(ns,{key:0,type:te.sub_type,style:Gs({filter:Ze(te).isDisabled?"grayscale(100%) brightness(115%)":void 0})},null,8,["type","style"])):A("",!0),s(X,{class:"flex-1 truncate","show-on-truncate-only":!Ze(te).isDisabled},{title:n(()=>[V(m(Ze(te).isDisabled?Ze(te).msg:te.title),1)]),default:n(()=>[V(" "+m(te.title),1)]),_:2},1032,["show-on-truncate-only"]),e(C).fk_integration_id===te.id?(a(),N(gt(("iconMap"in Q?Q.iconMap:e(Nt)).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):A("",!0)],8,Xl)]),_:2},1032,["value","disabled"]))),128))]),_:2},[e(K)("workspaceIntegrations")?{name:"dropdownRender",fn:n(({menuNode:te})=>[(a(),N(gt(te))),s(as,{style:{margin:"4px 0"}}),t("div",{class:"px-1.5 flex items-center text-brand-500 text-sm cursor-pointer",onMousedown:F[3]||(F[3]=Ye(()=>{},["prevent"])),onClick:nt},[t("div",ei,[s(ie,{icon:"plus",class:"flex-none"}),V(" "+m(Q.$t("general.new"))+" "+m(Q.$t("general.connection").toLowerCase()),1)])],32)]),key:"0"}:void 0]),1032,["value"])]),_:1},16)]),_:1})]),_:1})])]),e(G)?(a(),M(pe,{key:0},[t("div",ti,[t("div",si,[e(C).dataSource.client===e(he).SQLITE?(a(),M(pe,{key:0},[],64)):e(C).dataSource.client===e(he).SNOWFLAKE?(a(),N(De,{key:1,gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:Q.$t("labels.database")},e(R)["dataSource.connection.database"]),{default:n(()=>[s(Te,{value:e(C).dataSource.connection.database,"onUpdate:value":F[6]||(F[6]=te=>e(C).dataSource.connection.database=te),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16,["label"])]),_:1}),s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:"Schema"},e(R)["dataSource.connection.schema"]),{default:n(()=>[s(Te,{value:e(C).dataSource.connection.schema,"onUpdate:value":F[7]||(F[7]=te=>e(C).dataSource.connection.schema=te),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):e(C).dataSource.client===e(he).DATABRICKS?(a(),N(De,{key:2,gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:"Database"},e(R)["dataSource.connection.database"]),{default:n(()=>[s(Te,{value:e(C).dataSource.connection.database,"onUpdate:value":F[8]||(F[8]=te=>e(C).dataSource.connection.database=te),class:"nc-extdb-host-database"},null,8,["value"])]),_:1},16)]),_:1}),s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:"Schema"},e(R)["dataSource.connection.schema"]),{default:n(()=>[s(Te,{value:e(C).dataSource.connection.schema,"onUpdate:value":F[9]||(F[9]=te=>e(C).dataSource.connection.schema=te),class:"nc-extdb-host-schema"},null,8,["value"])]),_:1},16)]),_:1})]),_:1})):(a(),N(De,{key:3,gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,Ke({label:Q.$t("labels.database")},e(R)["dataSource.connection.database"]),{default:n(()=>[s(Te,{value:e(C).dataSource.connection.database,"onUpdate:value":F[10]||(F[10]=te=>e(C).dataSource.connection.database=te),placeholder:Q.$t("labels.dbCreateIfNotExists"),class:"nc-extdb-host-database"},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1}),s(Se,{span:12},{default:n(()=>{var te;return[([e(he).PG].includes(e(C).dataSource.client)||[e(he).PG].includes((te=e(G))==null?void 0:te.sub_type))&&e(C).dataSource.searchPath?(a(),N(Ne,Ke({key:0,label:Q.$t("labels.schemaName")},e(R)["dataSource.searchPath.0"]),{default:n(()=>[s(Te,{value:e(C).dataSource.searchPath[0],"onUpdate:value":F[11]||(F[11]=Is=>e(C).dataSource.searchPath[0]=Is),placeholder:e(H)&&`${e(H)} (default)`},null,8,["value","placeholder"])]),_:1},16,["label"])):A("",!0)]}),_:1})]),_:1}))])]),t("div",ni,[F[22]||(F[22]=t("div",{class:"nc-form-section-title"},"Permissions",-1)),t("div",ai,[s(Rt,{"allow-meta-write":e(ge),"onUpdate:allowMetaWrite":F[12]||(F[12]=te=>le(ge)?ge.value=te:null),"allow-data-write":e(ze),"onUpdate:allowDataWrite":F[13]||(F[13]=te=>le(ze)?ze.value=te:null)},null,8,["allow-meta-write","allow-data-write"])])]),[e(he).SQLITE,e(he).SNOWFLAKE,e(he).DATABRICKS].includes(e(C).dataSource.client)?A("",!0):(a(),N(Me,{key:0,"active-key":e(b),"onUpdate:activeKey":F[17]||(F[17]=te=>le(b)?b.value=te:null),ghost:"",class:"nc-source-advanced-options !mt-4"},{expandIcon:n(({isActive:te})=>[s(fe,{type:"text",size:"small",class:"!-ml-1.5",onClick:F[14]||(F[14]=Is=>W(!e(b).length))},{default:n(()=>[F[23]||(F[23]=t("div",{class:"nc-form-section-title"},"Advanced options",-1)),s(ie,{icon:"chevronDown",class:ue(["ml-2 flex-none cursor-pointer transform transition-transform duration-500",{"!rotate-180":te}])},null,8,["class"])]),_:2,__:[23]},1024)]),default:n(()=>[s(Lt,{key:"1",collapsible:"disabled"},{header:n(()=>F[24]||(F[24]=[t("span",null,null,-1)])),default:n(()=>[t("div",oi,[t("div",li,[s(De,{gutter:24},{default:n(()=>[s(Se,{span:12},{default:n(()=>[s(Ne,{label:Q.$t("labels.inflection.tableName")},{default:n(()=>[s(Ct,{value:e(C).inflection.inflectionTable,"onUpdate:value":F[15]||(F[15]=te=>e(C).inflection.inflectionTable=te),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-table-name"},{default:n(()=>[(a(),M(pe,null,Be(Ie,te=>s(St,{key:te,value:te},{default:n(()=>[V(m(te),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1}),s(Se,{span:12},{default:n(()=>[s(Ne,{label:Q.$t("labels.inflection.columnName")},{default:n(()=>[s(Ct,{value:e(C).inflection.inflectionColumn,"onUpdate:value":F[16]||(F[16]=te=>e(C).inflection.inflectionColumn=te),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-inflection-column-name"},{default:n(()=>[(a(),M(pe,null,Be(Ie,te=>s(St,{key:te,value:te},{default:n(()=>[V(m(te),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1},8,["label"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["active-key"]))],64)):A("",!0),F[25]||(F[25]=t("div",null,null,-1))]),_:1,__:[25]},8,["model"]),s(It,{"is-modal":"","filter-category":we,"filter-integration":Ve}),s(fn,{"load-datasource-info":"","base-id":e(T)},null,8,["base-id"])]),s(yn,{"model-value":e(q),inline:"",transition:"",class:"!bg-opacity-15"},{default:n(()=>[t("div",ii,[s(bn,{size:"large"})])]),_:1},8,["model-value"])]),t("div",ci,[s(gn),s(hn)])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),dn=Object.assign(xe(ri,[["__scopeId","data-v-2df41c96"]]),{__name:"DashboardSettingsDataSourcesCreateBase"}),di=Object.freeze(Object.defineProperty({__proto__:null,default:dn},Symbol.toStringTag,{value:"Module"})),ui=ot(()=>lt(()=>import("./k3vettFV.js"),__vite__mapDeps([62,40,1,2,41,42,47,48,43,44,45,46,49,50,7,51,6,14,15,52,53,54,4,5,8,9,10,11,12,13,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,55,56,57,58,59,60,63]),import.meta.url).then(S=>S.default||S)),pi=ot(()=>lt(()=>import("./D2vSp_o0.js"),__vite__mapDeps([64,65,1,2,47,48,66,67]),import.meta.url).then(S=>S.default||S)),_i=ot(()=>lt(()=>import("./BHzr5Pv6.js"),__vite__mapDeps([68,1,2,69,34,35,36,37]),import.meta.url).then(S=>S.default||S)),mi=ot(()=>lt(()=>import("./C7YyDL4n.js"),__vite__mapDeps([70,4,1,2,5,6,7,8,9,10,11,69,34,35,36,37,23]),import.meta.url).then(S=>S.default||S)),vi={class:"flex flex-col h-full p-6","data-testid":"nc-settings-datasources-tab"},fi={class:"mb-6 flex items-center justify-between gap-3"},bi={class:"flex flex-row items-center w-full gap-x-1"},yi={class:"flex"},gi={key:0,class:"h-full"},hi={class:"px-4 pt-4 pb-2 flex items-center justify-between gap-3"},xi={class:"capitalize text-base"},wi={class:"tab","data-testid":"nc-connection-tab"},ki={class:"h-full"},$i={class:"tab","data-testid":"nc-erd-tab"},Si={class:"h-full p-6"},Ci={class:"tab","data-testid":"nc-acl-tab"},Ii={class:"p-6 h-full"},Ti={class:"tab","data-testid":"nc-meta-sync-tab"},Di={class:"p-6 h-full"},Mi={key:1,class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},Oi={class:"ds-table-head sticky top-0 bg-white z-10"},Pi={class:"ds-table-row !border-0"},Ni={class:"ds-table-col ds-table-enabled cursor-pointer"},ji={class:"ds-table-col ds-table-name"},Ei={class:"ds-table-col ds-table-integration-name"},Bi={class:"ds-table-col ds-table-type"},Ai={class:"ds-table-col ds-table-actions"},Ui={class:"ds-table-body relative"},Ri={class:"ds-table-col ds-table-enabled"},Li={key:0,class:"ds-table-handle"},Fi={class:"ds-table-col ds-table-name font-medium"},zi={class:"flex items-center gap-1"},Vi={class:"ds-table-col ds-table-actions"},Gi=["onClick"],Wi={class:"ds-table-col ds-table-enabled"},Ki={class:"ds-table-col ds-table-name font-medium w-full"},qi={key:0,class:"h-8 w-1"},Yi={class:"ds-table-col ds-table-integration-name w-full"},Qi={class:"ds-table-col ds-table-type"},Hi={class:"flex justify-end"},Ji={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Zi={class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},Xi={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},ec={class:"flex flex-col justify-center items-center gap-2"},tc={class:"text-center"},sc={key:0,class:"flex flex-row items-center py-2 px-3.25 bg-gray-50 rounded-lg text-gray-700 mb-4"},nc={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},ac=ce({__name:"DataSources",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(S,{emit:o}){const y=S,g=o,c=Ge(y,"state",g),$=Ge(y,"reload",g),{$api:I,$e:w}=Ae(),f=tt(),{loadProject:x}=f,{isDataSourceLimitReached:P,bases:p}=ve(f),i=ee(()=>p.value.get(y.baseId)??{}),{isUIAllowed:r}=dt(),{projectPageTab:_}=ve(ss()),{refreshCommandPalette:l}=Kt(),{updateStatLimit:T,showExternalSourcePlanLimitExceededModal:k}=Et(),u=z([]),E=z(""),L=z(he.MYSQL),h=z(!1),O=z(!1),U=z(),D=z("");async function K(){const j=new Set;let d=!1;for(const R of u.value){if(R.order===null||j.has(R.order)){d=!0;break}j.add(R.order)}if(d){u.value=u.value.sort((R,J)=>R.is_local||R.is_meta?-1:J.is_local||J.is_meta?1:(R.order??0)-(J.order??0)),u.value=u.value.map((R,J)=>({...R,order:J+1}));try{await Promise.all(u.value.map(async R=>{await I.source.update(R.base_id,R.id,{id:R.id,base_id:R.base_id,order:R.order})})),await x(i.value.id,!0)}catch(R){_e.error(await Re(R))}}}async function B(j){try{j&&l(),await ht(()=>!!i.value.id).toBeTruthy(),h.value=!0,$.value=!0;const d=await I.source.list(i.value.id);d.list&&d.list.length&&(u.value=d.list),await K()}catch(d){console.error(d)}finally{$.value=!1,h.value=!1}}const b=(j,d)=>{j&&(E.value=j,c.value=d||"")},q=j=>{w("c:source:delete"),O.value=!0,U.value=j},se=async()=>{if(U.value)try{await I.source.delete(U.value.base_id,U.value.id),w("a:source:delete"),u.value.splice(u.value.indexOf(U.value),1),T(oa.LIMIT_EXTERNAL_SOURCE_PER_WORKSPACE,-1),await x(i.value.id,!0)}catch(j){_e.error(await Re(j))}finally{l()}},C=async(j,d)=>{try{if(!d&&u.value.filter(R=>R.enabled).length<2){_e.info("There should be at least one enabled source!");return}j.enabled=d,await I.source.update(j.base_id,j.id,{id:j.id,base_id:j.base_id,enabled:j.enabled}),await x(i.value.id,!0)}catch(R){_e.error(await Re(R))}finally{l()}},oe=async j=>{var d,R;try{if(j.oldIndex===j.newIndex)return;const J=u.value[j.newIndex];if(J){let re;u.value.length-1===j.newIndex?re=Math.max(...u.value.map($e=>($e==null?void 0:$e.order)??0))+1:re=(parseFloat(String(((d=u.value[j.newIndex-1])==null?void 0:d.order)??0))+parseFloat(String(((R=u.value[j.newIndex+1])==null?void 0:R.order)??0)))/2;const Ie=isNaN(Number(re))?j.oldIndex:re;await I.source.update(J.base_id,J.id,{id:J.id,base_id:J.base_id,order:Ie})}await x(i.value.id,!0),await B()}catch(J){_e.error(await Re(J))}finally{await l()}};Oe(_,()=>{D.value&&(D.value=""),_.value==="data-source"&&B()},{immediate:!0}),Oe(()=>y.reload,async j=>{j&&!h.value&&await B()}),Oe(c,async j=>{switch(u.value.length||await B(),j){case he.MYSQL:L.value=he.MYSQL,c.value=it.New;break;case he.PG:L.value=he.PG,c.value=it.New;break;case he.SQLITE:L.value=he.SQLITE,c.value=it.New;break;case he.SNOWFLAKE:L.value=he.SNOWFLAKE,c.value=it.New;break;case it.New:(k()||P.value)&&(c.value="");break}l()},{immediate:!0});const Z=ee({get:()=>[it.New].includes(c.value),set:j=>{j||(c.value="")}}),Y=z(null),G=z("erd"),v=()=>{var j;return u.value.filter(d=>{var R,J,re;return(re=(R=d==null?void 0:d.alias)==null?void 0:R.toLowerCase())==null?void 0:re.includes((J=D.value)==null?void 0:J.toLowerCase())}).length||"default".includes((j=D.value)==null?void 0:j.toLowerCase())},H=ee({get:()=>!!Y.value,set:j=>{j||(Y.value=null)}}),ne=(j,d)=>{d&&d!==G.value&&(G.value=d),Y.value=j};return(j,d)=>{var fe;const R=ke,J=ft,re=We,Ie=Pt,$e=yt,ye=ui,Le=ws,Ee=pi,Pe=_i,Fe=mi,ge=Ks,ze=At,st=dn,nt=zs,W=Xe,ae=Ra,de=$s,we=es,Ve=Xt,Ze=ts,Q=ks,F=Qt,ie=ln;return a(),M("div",vi,[t("div",fi,[s(J,{value:e(D),"onUpdate:value":d[0]||(d[0]=X=>le(D)?D.value=X:null),type:"text",class:"nc-search-data-source-input nc-input-border-on-value !max-w-90 nc-input-sm",placeholder:"Search data source","allow-clear":""},{prefix:n(()=>[s(R,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),!e(P)&&e(r)("sourceCreate")?(a(),N(re,{key:0,size:"large",class:"z-10 !px-2",type:"primary",onClick:d[1]||(d[1]=()=>{e(k)()||(c.value=("DataSourcesSubTab"in j?j.DataSourcesSubTab:e(it)).New)})},{default:n(()=>[t("div",bi,[(a(),N(gt(("iconMap"in j?j.iconMap:e(Nt)).plus))),t("div",yi,m(j.$t("activity.newSource")),1)])]),_:1})):A("",!0)]),t("div",{"data-testid":"nc-settings-datasources",class:"flex flex-row w-full nc-data-sources-view flex-grow min-h-0",style:Gs({maxHeight:e(Z)?"100%":e(Y)?"calc(100% - 46px)":"calc(100% - 66px)"})},[s(ze,{visible:e(H),"onUpdate:visible":d[8]||(d[8]=X=>le(H)?H.value=X:null),centered:"",size:"large","wrap-class-name":"nc-active-data-sources-view",onKeydown:d[9]||(d[9]=jt(X=>Y.value=null,["esc"]))},{default:n(()=>[e(Y)?(a(),M("div",gi,[t("div",hi,[s($e,{separator:">",class:"flex-1 cursor-pointer font-weight-bold !ml-1"},{default:n(()=>[s(Ie,{onClick:d[2]||(d[2]=X=>Y.value=null)},{default:n(()=>d[19]||(d[19]=[t("a",{class:"!no-underline text-base"},"Data Sources",-1)])),_:1,__:[19]}),e(Y)?(a(),N(Ie,{key:0},{default:n(()=>[t("span",xi,m(e(Y).alias||"Default Source"),1)]),_:1})):A("",!0)]),_:1}),s(re,{size:"small",type:"text",class:"nc-close-btn",onClick:d[3]||(d[3]=X=>H.value=!1)},{default:n(()=>[s(R,{icon:"close",class:"text-gray-600"})]),_:1})]),s(ge,{"active-key":e(G),"onUpdate:activeKey":d[7]||(d[7]=X=>le(G)?G.value=X:null),class:"nc-source-tab w-full h-[calc(100%_-_58px)] max-h-[calc(100%_-_58px)]"},{default:n(()=>[!e(Y).is_meta&&!e(Y).is_local?(a(),N(Le,{key:"edit"},{tab:n(()=>[t("div",wi,[t("div",null,m(j.$t("labels.connectionDetails")),1)])]),default:n(()=>[t("div",ki,[s(ye,{"source-id":e(Y).id,onSourceUpdated:d[4]||(d[4]=X=>B(!0)),onClose:d[5]||(d[5]=X=>Y.value=null)},null,8,["source-id"])])]),_:1})):A("",!0),s(Le,{key:"erd"},{tab:n(()=>[t("div",$i,[t("div",null,m(j.$t("title.erdView")),1)])]),default:n(()=>[t("div",Si,[s(Ee,{class:"h-full overflow-auto","base-id":e(i).id,"source-id":e(Y).id,"show-all-columns":!1},null,8,["base-id","source-id"])])]),_:1}),s(Le,{key:"acl"},{tab:n(()=>[t("div",Ci,[t("div",null,m(j.$t("labels.viewHide")),1)])]),default:n(()=>[t("div",Ii,[s(Pe,{"source-id":e(Y).id},null,8,["source-id"])])]),_:1}),!e(Y).is_meta&&!e(Y).is_local?(a(),N(Le,{key:"meta-sync"},{tab:n(()=>[t("div",Ti,[t("div",null,m(j.$t("labels.metaSync")),1)])]),default:n(()=>[t("div",Di,[s(Fe,{"source-id":e(Y).id,onSourceSynced:d[6]||(d[6]=X=>B(!0))},null,8,["source-id"])])]),_:1})):A("",!0)]),_:1},8,["active-key"])])):A("",!0)]),_:1},8,["visible"]),t("div",{class:ue(["flex flex-col w-full",{"overflow-auto":!e(Z)}])},[e(Z)?(a(),N(st,{key:0,open:e(Z),"onUpdate:open":d[10]||(d[10]=X=>le(Z)?Z.value=X:null),"connection-type":e(L),"is-modal":"",onSourceCreated:d[11]||(d[11]=X=>B(!0))},null,8,["open","connection-type"])):(a(),M("div",Mi,[t("div",Oi,[t("div",Pi,[t("div",Ni,m(j.$t("general.visibility")),1),t("div",ji,m(j.$t("general.name")),1),t("div",Ei,m(j.$t("general.connection"))+" "+m(j.$t("general.name")),1),t("div",Bi,m(j.$t("general.type")),1),t("div",Ai,m(j.$t("labels.actions")),1)])]),t("div",Ui,[s(e(La),{list:e(u),"item-key":"id",handle:".ds-table-handle",onEnd:oe},ys({item:n(({element:X,index:Te})=>{var Ne,Se;return[Te!==0?(a(),M("div",{key:0,class:ue(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":!((Se=(Ne=X==null?void 0:X.alias)==null?void 0:Ne.toLowerCase())!=null&&Se.includes(e(D).toLowerCase()))}]),onClick:De=>ne(X,"edit")},[t("div",Wi,[t("div",{class:"flex items-center gap-1",onClick:d[16]||(d[16]=Ye(()=>{},["stop"]))},[e(u).length>2?(a(),N(R,{key:0,icon:"dragVertical",small:"",class:"ds-table-handle"})):A("",!0),s(W,null,{title:n(()=>[X.enabled?(a(),M(pe,{key:0},[V(m(j.$t("activity.hideInUI")),1)],64)):(a(),M(pe,{key:1},[V(m(j.$t("activity.showInUI")),1)],64))]),default:n(()=>[s(nt,{checked:!!X.enabled,class:"cursor-pointer",size:"small",onChange:De=>C(X,De)},null,8,["checked","onChange"])]),_:2},1024)])]),t("div",Ki,[X.is_meta||X.is_local?(a(),M("div",qi,"-")):(a(),N(W,{key:1,class:"truncate","show-on-truncate-only":""},{title:n(()=>[V(m(X.is_meta||X.is_local?j.$t("general.base"):X.alias),1)]),default:n(()=>[V(" "+m(X.is_meta||X.is_local?j.$t("general.base"):X.alias),1)]),_:2},1024))]),t("div",Yi,[s(W,{class:"truncate","show-on-truncate-only":""},{title:n(()=>[V(m((X==null?void 0:X.integration_title)||"-"),1)]),default:n(()=>[V(" "+m((X==null?void 0:X.integration_title)||"-"),1)]),_:2},1024)]),t("div",Qi,[s(de,{rounded:"lg",class:"flex items-center gap-2 px-0 py-1 !h-7 truncate !border-transparent"},{default:n(()=>[s(ae,{"source-type":X.type,class:"flex-none !w-4 !h-4"},null,8,["source-type"]),s(W,{placement:"bottom","show-on-truncate-only":"",class:"text-sm truncate"},{title:n(()=>{var De;return[V(m(((De=("clientTypesMap"in j?j.clientTypesMap:e(ls))[X.type])==null?void 0:De.text)||X.type),1)]}),default:n(()=>{var De;return[V(" "+m(X.type&&("clientTypesMap"in j?j.clientTypesMap:e(ls))[X.type]?(De=("clientTypesMap"in j?j.clientTypesMap:e(ls))[X.type])==null?void 0:De.text:X.type),1)]}),_:2},1024)]),_:2},1024)]),t("div",{class:"ds-table-col justify-end gap-x-1 ds-table-actions",onClick:d[17]||(d[17]=Ye(()=>{},["stop"]))},[t("div",Hi,[!X.is_meta&&!X.is_local?(a(),N(Q,{key:0,placement:"bottomRight"},{overlay:n(()=>[s(Ze,{variant:"small"},{default:n(()=>[s(we,{onClick:De=>ne(X,"edit")},{default:n(()=>[s(R,{icon:"edit"}),t("span",null,m(j.$t("general.edit")),1)]),_:2},1032,["onClick"]),s(Ve),s(we,{class:"!text-red-500 !hover:bg-red-50",onClick:Ye(De=>q(X),["stop"])},{default:n(()=>[s(R,{icon:"delete"}),V(" "+m(j.$t("general.remove")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(re,{size:"small",type:"secondary"},{default:n(()=>[s(R,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)):A("",!0)])])],10,Gi)):A("",!0)]}),_:2},["default".includes(e(D).toLowerCase())?{name:"header",fn:n(()=>[e(u)[0]?(a(),M("div",{key:0,class:"ds-table-row border-gray-200 cursor-pointer",onClick:d[15]||(d[15]=X=>ne(e(u)[0],"erd"))},[t("div",Ri,[t("div",{class:"flex items-center gap-1",onClick:d[13]||(d[13]=Ye(()=>{},["stop"]))},[e(u).length>2?(a(),M("div",Li)):A("",!0),s(W,null,{title:n(()=>[e(u)[0].enabled?(a(),M(pe,{key:0},[V(m(j.$t("activity.hideInUI")),1)],64)):(a(),M(pe,{key:1},[V(m(j.$t("activity.showInUI")),1)],64))]),default:n(()=>[s(nt,{checked:!!e(u)[0].enabled,class:"cursor-pointer",size:"small",onChange:d[12]||(d[12]=X=>C(e(u)[0],X))},null,8,["checked"])]),_:1})])]),t("div",Fi,[t("div",zi,m(j.$t("general.default")),1)]),d[20]||(d[20]=t("div",{class:"ds-table-col ds-table-integration-name"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),d[21]||(d[21]=t("div",{class:"ds-table-col ds-table-type"},[t("div",{class:"flex items-center gap-1"},"-")],-1)),t("div",Vi,[!e(u)[0].is_meta&&!e(u)[0].is_local?(a(),N(re,{key:0,size:"small",class:"nc-action-btn nc-edit-base cursor-pointer outline-0 !w-8 !px-1 !rounded-lg",type:"text",onClick:d[14]||(d[14]=Ye(X=>b(e(u)[0].id,("DataSourcesSubTab"in j?j.DataSourcesSubTab:e(it)).Edit),["stop"]))},{default:n(()=>[s(R,{icon:"edit",class:"text-gray-600"})]),_:1})):A("",!0)])])):A("",!0)]),key:"0"}:void 0]),1032,["list"]),!e(h)&&((fe=e(u))!=null&&fe.length)&&!v()?(a(),M("div",Ji,[t("div",Zi,[d[22]||(d[22]=t("img",{src:cs,class:"!w-[164px] flex-none",alt:"No search results found"},null,-1)),V(" "+m(j.$t("title.noResultsMatchedYourSearch")),1)])])):A("",!0)]),He(t("div",Xi,[t("div",ec,[s(F,{size:"xlarge"}),t("span",tc,m(j.$t("general.loading")),1)])],512),[[Vt,e(h)]])])),s(ie,{visible:e(O),"onUpdate:visible":d[18]||(d[18]=X=>le(O)?O.value=X:null),"entity-name":j.$t("general.datasource"),"on-delete":se,"delete-label":j.$t("general.remove")},{"entity-preview":n(()=>[e(U)?(a(),M("div",sc,[s(ae,{"source-type":e(U).type},null,8,["source-type"]),t("div",nc,m(e(U).alias),1)])):A("",!0)]),_:1},8,["visible","entity-name","delete-label"])],2)],4)])}}}),oc=Object.assign(xe(ac,[["__scopeId","data-v-f536c2ce"]]),{__name:"DashboardSettingsDataSources"}),ut=ca(),lc={title:"New Source",sync_type:qs.Full,sync_trigger:Gt.Manual,sync_category:ia.TICKETING,exclude_models:[],on_delete_action:la.MarkDeleted,sync_trigger_cron:null},Dt={type:rs.Sync,sub_type:null,config:{}},[un,ic]=Fa((S,o)=>{const y=z(lc),g=z(),c=z(!1),$=z("sync"),I=z(!1),w=z(!1),f=z(!1),x=z(null),{validate:P,validateInfos:p}=mt.useForm(y,z({title:[_t()],sync_type:[_t()],sync_trigger:[_t()]})),i=z([ut(Dt)]),r=z({}),_=z(0),l=z(),{getIntegrationForm:T}=Ut(),{$api:k}=Ae(),{formState:u,isLoading:E,validate:L,clearValidate:h,validateInfos:O}=Ea({formSchema:l,fetchOptions:async d=>{const R=e(S),J=e(o);return!d||!R||!J?[]:await k.internal.postOperation(R,J,{operation:"syncIntegrationFetchOptions"},{integration:u.value,key:d})}}),U=d=>Ba(u,d),D=async d=>{if(!d){l.value=void 0;return}const R=r.value[d]||await T(rs.Sync,d);l.value=[...R],u.value.type=rs.Sync,u.value.sub_type=d,u.value.config||(u.value.config={}),u.value.config.sync||(u.value.config.sync={}),u.value.config.sync.sync_trigger||(u.value.config.sync.sync_trigger=Gt.Manual)},K=d=>{i.value[d]&&(i.value[d]=ut(Dt),i.value.splice(d,1)),i.value.length===0&&i.value.push(ut(Dt))},B=async()=>{if(i.value[_.value]!==void 0){try{await L()}catch{return!1}return i.value[_.value]=ut(u.value),!0}},b=async d=>{if(i.value[d]){if(I.value&&i.value[d].id&&!i.value[d].config){const R=await k.integration.read(i.value[d].id,{includeConfig:!0});i.value[d].config=R.config}i.value[d]&&(await D(i.value[d].sub_type),u.value=ut(i.value[d])),ct(()=>{h(),_.value=d})}},q=async()=>{await B()&&(i.value.push(ut(Dt)),await b(i.value.length-1),I.value&&(w.value=!0,f.value=!0))},se=async d=>{K(d);const R=i.value.length-1;await b(R)},C=async d=>{await B(),await b(d)},oe=()=>{i.value=[ut(Dt)],l.value=void 0,b(0)},Z=ee(()=>on.filter(d=>d.type===xs.SYNC&&(!U("sync_category")||d.sync_category===U("sync_category"))));return{syncConfigForm:y,syncConfigEditForm:g,syncConfigEditFormChanged:c,validateSyncConfig:P,validateInfosSyncConfig:p,integrationConfigs:i,selectedIntegrationIndex:_,formState:u,activeIntegrationItemForm:l,isLoading:E,availableIntegrations:Z,addIntegrationConfig:q,removeIntegrationConfig:se,switchToIntegrationConfig:C,loadConfig:b,changeIntegration:D,resetStore:oe,deepReference:U,saveCurrentFormState:B,validateInfos:O,editMode:I,editModeSync:x,editModeModified:f,editModeAddIntegration:w,readSync:async d=>{const R=e(S),J=e(o);if(!(!d||!R||!J))return await k.internal.getOperation(R,J,{operation:"readSync",id:d})},createSync:async()=>{const d=e(S),R=e(o);return!d||!R?void 0:await k.internal.postOperation(d,R,{operation:"createSync"},{title:y.value.title,sync_type:y.value.sync_type,sync_trigger:y.value.sync_trigger,sync_trigger_cron:y.value.sync_trigger_cron,on_delete_action:y.value.on_delete_action,sync_category:y.value.sync_category,exclude_models:y.value.exclude_models,configs:i.value})},updateSync:async()=>{var Ie,$e;const d=e(S),R=e(o);if(!d||!R||!g.value)return;try{await L()}catch{return}const{syncConfig:J,integration:re}=await k.internal.postOperation(d,R,{operation:"updateSync"},{syncConfigId:$.value==="sync-settings"?(Ie=g.value)==null?void 0:Ie.id:u.value.syncConfigId,...$.value==="sync-settings"?g.value:{},...$.value==="integrations"?{syncConfigId:u.value.syncConfigId??(($e=g.value)==null?void 0:$e.id),config:u.value}:{}});re&&i.value[_.value]&&(u.value.syncConfigId=J.id,u.value.parentSyncConfigId=J.fk_parent_sync_config_id,Object.assign(u.value,re),Object.assign(i.value[_.value],u.value)),u.value.syncConfigId===J.id&&(x.value=J),c.value=!1,f.value=!1,await b(_.value)},triggerSync:async(d,R)=>{const J=e(S),re=e(o);return!J||!re||!d?void 0:await k.internal.postOperation(J,re,{operation:"triggerSync"},{syncConfigId:d,bulk:!!R})},deleteSync:async d=>{const R=e(S),J=e(o);!R||!J||!d||(await k.internal.postOperation(R,J,{operation:"deleteSync"},{syncConfigId:d}),await se(_.value))},editTab:$,integrationFetchDestinationSchema:async d=>{const R=e(S),J=e(o);if(!(!R||!J||!d))return await k.internal.postOperation(R,J,{operation:"syncIntegrationFetchDestinationSchema"},{integration:d})}}},"use-sync-store");function $t(){const S=ic();if(S==null)throw new Error("Please call `useSyncStore` on the appropriate parent component");return S}const cc=ce({__name:"Steps",props:{current:{}},setup(S){const{syncConfigForm:o}=$t();return(y,g)=>{const c=zt,$=oo;return a(),N($,{class:"pointer-events-none",current:y.current,size:"small"},{default:n(()=>[s(c,{title:"Sync Category"}),s(c,{title:"Sync Settings"}),s(c,{title:"Sources"}),e(o).sync_category==="custom"?(a(),N(c,{key:0,title:"Destination Schema"})):A("",!0),s(c,{title:"Review"})]),_:1},8,["current"])}}}),rc=Object.assign(cc,{__name:"DashboardSettingsSyncSteps"}),dc={class:"w-full flex flex-wrap gap-4 overflow-y-auto"},uc=ce({__name:"CategorySelect",props:{modelValue:{}},emits:["update:modelValue","change"],setup(S,{emit:o}){const y=S,g=o,c=Object.values(ra),$=Ge(y,"modelValue",g),I=w=>{$.value=w,g("change",w)};return(w,f)=>{const x=ke,P=bs;return a(),M("div",dc,[(a(!0),M(pe,null,Be(e(c),p=>(a(),N(P,{key:p.value,type:"info",message:p.label,description:p.description,"show-icon":"",class:ue(["cursor-pointer hover:!bg-gray-50",{"!border-primary":e($)===p.value}]),onClick:i=>I(p.value)},{icon:n(()=>[s(x,{icon:p.icon,class:"text-primary mt-1"},null,8,["icon"])]),_:2},1032,["message","description","class","onClick"]))),128))])}}}),pc=Object.assign(uc,{__name:"DashboardSettingsSyncCategorySelect"}),_c={class:"flex items-center mb-4 border-b border-gray-200 flex-wrap"},mc=["onClick"],vc={key:1,class:"h-5 w-5 flex items-center justify-center bg-gray-100 rounded-full"},fc=ce({__name:"IntegrationTabs",setup(S){const{formState:o,syncConfigForm:y,integrationConfigs:g,selectedIntegrationIndex:c,addIntegrationConfig:$,removeIntegrationConfig:I,switchToIntegrationConfig:w,editModeModified:f,editMode:x}=$t(),P=ee(()=>g.value.map((p,i)=>i===c.value?o.value:p));return(p,i)=>{const r=Ss,_=ke,l=Ys;return a(),M("div",_c,[(a(!0),M(pe,null,Be(e(P),(T,k)=>(a(),M("div",{key:k,class:ue(["px-4 py-2 cursor-pointer flex items-center gap-2",{"border-b-2 border-primary text-primary":e(c)===k,"text-gray-500":e(c)!==k}]),onClick:u=>e(w)(k)},[T.sub_type?(a(),N(r,{key:0,type:T.sub_type,class:"h-5 w-5"},null,8,["type"])):(a(),M("span",vc,m(k+1),1)),t("span",null,m((T==null?void 0:T.title)||(T==null?void 0:T.sub_type)||"New Source"),1),e(g).length>1&&!e(x)?(a(),N(l,{key:2,type:"text",size:"small",class:"!p-0 !min-w-0 !h-auto text-gray-400 hover:text-red-500",onClick:Ye(u=>e(I)(k),["stop"])},{default:n(()=>[s(_,{icon:"close",class:"h-3 w-3"})]),_:2},1032,["onClick"])):A("",!0)],10,mc))),128)),(!e(x)||!e(f))&&e(y).sync_category!=="custom"?(a(),N(l,{key:0,type:"text",class:"ml-2 flex items-center",onClick:e($)},{default:n(()=>[s(_,{icon:"plus",class:"h-3 w-3 mr-1"}),i[0]||(i[0]=V(" Add Source "))]),_:1,__:[0]},8,["onClick"])):A("",!0)])}}}),pn=Object.assign(fc,{__name:"DashboardSettingsSyncIntegrationTabs"}),bc={class:"w-full flex gap-2 items-center"},yc=ce({__name:"Select",props:{value:{},category:{}},emits:["update:value","change"],setup(S,{emit:o}){const y=S,g=o,c=ee({get:()=>y.value,set:f=>g("update:value",f)}),{integrationsRefreshKey:$}=Ut(),I=ee(()=>($.value,on.filter(f=>f.type===xs.SYNC&&(!y.category||f.sync_category===y.category)))),w=f=>{g("change",f)};return(f,x)=>{const P=Ss,p=Xe,i=fs,r=Vs;return a(),N(r,{value:e(c),class:"nc-select-shadow","dropdown-class-name":"nc-dropdown-sync-type",placeholder:"Select Source",onChange:w},{default:n(()=>[(a(!0),M(pe,null,Be(e(I),_=>(a(),N(i,{key:`${_.sub_type}`,value:_.sub_type},{default:n(()=>[t("div",bc,[_!=null&&_.sub_type?(a(),N(P,{key:0,type:_.sub_type},null,8,["type"])):A("",!0),s(p,{class:"flex-1 truncate"},{title:n(()=>[V(m(_.title),1)]),default:n(()=>[V(" "+m(_.title),1)]),_:2},1024),e(c)===_.sub_type?(a(),N(gt(e(Nt).check),{key:1,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):A("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value"])}}}),gc=Object.assign(xe(yc,[["__scopeId","data-v-cfdf71b5"]]),{__name:"DashboardSettingsSyncSelect"}),hc={key:2,class:"flex justify-between"},xc=ce({__name:"IntegrationConfig",setup(S){const{formState:o,syncConfigForm:y,selectedIntegrationIndex:g,deleteSync:c,changeIntegration:$,editMode:I,editModeModified:w,editModeAddIntegration:f,updateSync:x}=$t(),{t:P}=rt(),p=async()=>{Us.confirm({title:"Do you want to delete this integration?",type:"warning",onOk:async()=>{try{await c(o.value.syncConfigId)}catch(i){_e.error(`${P("msg.error.deleteFailed")}: ${await Re(i)}`)}}})};return(i,r)=>{const _=gc,l=vt,T=Zt,k=Jt,u=Aa,E=We,L=Xe;return a(),M("div",null,[!e(I)||e(f)?(a(),N(k,{key:0,gutter:24,class:ue({"mb-4":e(I)})},{default:n(()=>[s(T,{span:24},{default:n(()=>[s(l,{label:"Select Source",class:"w-full"},{default:n(()=>[s(_,{value:e(o).sub_type,category:e(y).sync_category,onChange:e($)},null,8,["value","category","onChange"])]),_:1})]),_:1})]),_:1},8,["class"])):A("",!0),e(o).sub_type?(a(),N(u,{key:`${e(g)}-${e(o).sub_type}`,class:"pt-4",onChange:r[0]||(r[0]=h=>w.value=!0)})):A("",!0),e(I)?(a(),M("div",hc,[e(o).parentSyncConfigId?(a(),N(E,{key:1,class:"!px-4",type:"danger",size:"small",onClick:p},{default:n(()=>r[3]||(r[3]=[V(" Delete Integration ")])),_:1,__:[3]})):(a(),N(L,{key:0,placement:"top"},{title:n(()=>r[1]||(r[1]=[V(" You can't delete first integration ")])),default:n(()=>[s(E,{class:"!px-4",type:"danger",size:"small",disabled:""},{default:n(()=>r[2]||(r[2]=[V(" Delete Integration ")])),_:1,__:[2]})]),_:1})),s(E,{class:"!px-4",type:"primary",size:"small",disabled:!e(w),onClick:e(x)},{default:n(()=>r[4]||(r[4]=[V(" Update Integration ")])),_:1,__:[4]},8,["disabled","onClick"])])):A("",!0)])}}}),_n=Object.assign(xc,{__name:"DashboardSettingsSyncIntegrationConfig"}),wc={key:0,class:"flex justify-end"},kc={key:1,class:"mt-4"},$c={class:"flex items-start mb-4"},Sc={class:"flex items-start"},Cc={key:0,class:"border rounded-lg px-1 py-2"},Ic={class:"flex justify-center flex-col ml-2"},Tc={class:"flex items-center"},Dc={class:"flex-none mr-2"},Mc={class:"!text-black"},Oc={class:"text-gray-500 text-xs"},Pc=ce({__name:"Settings",setup(S){const{syncConfigForm:o,validateInfosSyncConfig:y,updateSync:g,syncConfigEditForm:c,syncConfigEditFormChanged:$,editMode:I}=$t(),w=Object.values(Hs),f=Object.values(Js),x=Object.values(Zs),P=z(!0),p=ee(()=>Object.values(Qs).filter(_=>_.category===o.value.sync_category||!o.value.sync_category)),i=_=>{o.value.exclude_models.includes(_)?o.value.exclude_models=o.value.exclude_models.filter(l=>l!==_):o.value.exclude_models.push(_)},r=ee(()=>I.value?c.value:o.value);return(_,l)=>{const T=ft,k=vt,u=Zt,E=Jt,L=vs,h=We,O=Wa,U=Ga,D=ke,K=ms;return e(r)?(a(),M(pe,{key:0},[s(E,{gutter:24},{default:n(()=>[s(u,{span:24},{default:n(()=>[s(k,Ke({label:"Sync Title"},e(y).title,{"hide-required-mark":""}),{default:n(()=>[s(T,{value:e(r).title,"onUpdate:value":l[0]||(l[0]=B=>e(r).title=B),onChange:l[1]||(l[1]=B=>$.value=!0)},null,8,["value"])]),_:1},16)]),_:1})]),_:1}),s(E,{gutter:24},{default:n(()=>[s(u,{span:12},{default:n(()=>[s(k,Ke({label:"Sync Type"},e(y).sync_type,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(r).sync_type,"onUpdate:value":l[2]||(l[2]=B=>e(r).sync_type=B),options:e(w),onChange:l[3]||(l[3]=B=>$.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1}),s(u,{span:12},{default:n(()=>[s(k,Ke({label:"Sync Trigger"},e(y).sync_trigger,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(r).sync_trigger,"onUpdate:value":l[4]||(l[4]=B=>e(r).sync_trigger=B),options:e(f),onChange:l[5]||(l[5]=B=>$.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1})]),_:1}),s(E,{gutter:24},{default:n(()=>[s(u,{span:12},{default:n(()=>[s(k,Ke({label:"On Delete Action"},e(y).on_delete_action,{"hide-required-mark":""}),{default:n(()=>[s(L,{value:e(r).on_delete_action,"onUpdate:value":l[6]||(l[6]=B=>e(r).on_delete_action=B),options:e(x),onChange:l[7]||(l[7]=B=>$.value=!0)},null,8,["value","options"])]),_:1},16)]),_:1})]),_:1}),e(I)?(a(),M("div",wc,[s(h,{class:"!px-4",type:"primary",size:"small",disabled:!e($),onClick:e(g)},{default:n(()=>l[10]||(l[10]=[V(" Update Sync Settings ")])),_:1,__:[10]},8,["disabled","onClick"])])):A("",!0),e(o).sync_category!=="custom"&&!e(I)?(a(),M("div",kc,[s(U,{value:e(P),"onUpdate:value":l[8]||(l[8]=B=>le(P)?P.value=B:null),class:"w-full",onChange:l[9]||(l[9]=B=>$.value=!0)},{default:n(()=>[t("div",$c,[s(O,{value:!0,class:"!mt-0.5"},{default:n(()=>l[11]||(l[11]=[t("div",{class:"ml-2"},[t("div",{class:"text-base"},"Sync all available models"),t("div",{class:"text-gray-500 text-xs mt-1"}," All models for the category will be synced. This may take longer and use more resources. ")],-1)])),_:1,__:[11]})]),t("div",Sc,[s(O,{value:!1,class:"!mt-0.5"},{default:n(()=>l[12]||(l[12]=[t("div",{class:"ml-2"},[t("div",{class:"text-base"},"Select specific models")],-1)])),_:1,__:[12]})])]),_:1},8,["value"]),e(P)?A("",!0):(a(),M("div",Cc,[(a(!0),M(pe,null,Be(e(p),B=>{var b;return a(),M("div",{key:B.value,class:"flex items-start px-3"},[s(K,{value:B.value,checked:!((b=e(r).exclude_models)!=null&&b.includes(B.value)),disabled:B.required,onChange:q=>i(B.value)},{default:n(()=>[t("div",Ic,[t("div",Tc,[t("div",Dc,[s(D,{icon:B.icon,class:"text-primary"},null,8,["icon"])]),t("div",Mc,m(B.label),1)]),t("div",Oc,m(B.description),1)])]),_:2},1032,["value","checked","disabled","onChange"])])}),128))]))])):A("",!0)],64)):A("",!0)}}}),mn=Object.assign(Pc,{__name:"DashboardSettingsSyncSettings"}),Nc={class:"column-mapping-container"},jc={class:"table-selector"},Ec={class:"tabs-container"},Bc={class:"tabs"},Ac=["onClick"],Uc={key:0,class:"column-mapping"},Rc={class:"table-header"},Lc={class:"select-all"},Fc={class:"table-container"},zc={class:"column-table"},Vc={class:"center-column"},Gc={class:"center-column"},Wc={class:"center-column"},Kc={key:1,class:"no-table"},qc=ce({__name:"DestinationSchema",setup(S){const{formState:o,integrationFetchDestinationSchema:y}=$t();o.value.config.custom_schema||(o.value.config.custom_schema={});const g=ee(()=>o.value.config.custom_schema),c=z(""),$=ee(()=>Object.keys(g.value)),I={string:[Ce.SingleLineText,Ce.LongText,Ce.Email,Ce.URL,Ce.PhoneNumber,Ce.SingleSelect,Ce.MultiSelect],number:[Ce.Number,Ce.Decimal,Ce.Rating,Ce.Percent],boolean:[Ce.Checkbox],date:[Ce.Date],datetime:[Ce.DateTime],json:[Ce.JSON],jsonb:[Ce.JSON],decimal:[Ce.Decimal,Ce.Number]},w=ee(()=>{var O;const h=g.value[c.value];return((O=h==null?void 0:h.columns)==null?void 0:O.every(U=>!U.exclude))??!1}),f=()=>{$.value.length>0&&!c.value&&(c.value=$.value[0]||"")},x=h=>{const O=Object.keys(I).find(U=>h.includes(U));return O&&I[O]?I[O]:[Ce.SingleLineText,Ce.LongText]},P=h=>x(h.abstractType).map(U=>({text:U,value:U})),p=h=>{o.value.config.custom_schema=h},i=h=>{var U;const O=g.value[c.value];return(U=O==null?void 0:O.systemFields)!=null&&U.primaryKey?O.systemFields.primaryKey.includes(h):!1},r=()=>{var O;const h=g.value[c.value];return(O=h==null?void 0:h.systemFields)!=null&&O.primaryKey?h.systemFields.primaryKey.length:0},_=h=>{if(!g.value[c.value])return;const U={...g.value},D=U[c.value];D&&D.columns&&D.columns.forEach(K=>{i(K.title)||(K.exclude=!h)}),p(U)},l=(h,O,U)=>{const D=g.value[c.value];if(!D||!D.columns||!D.columns[h])return;const K=D.columns[h];if(O==="exclude"&&U===!0&&i(K.title))return;const B={...g.value},b=B[c.value];b&&b.columns&&b.columns[h]&&(b.columns[h][O]=U),p(B)},T=(h,O)=>{if(!g.value[c.value]||!O&&i(h)&&r()===1)return;const D={...g.value},K=D[c.value];if(K){if(K.systemFields||(K.systemFields={primaryKey:[]}),O){if(!K.systemFields.primaryKey.includes(h)){K.systemFields.primaryKey.push(h);const B=K.columns.findIndex(b=>b.title===h);B!==-1&&K.columns[B]&&(K.columns[B].exclude=!1)}}else K.systemFields.primaryKey=K.systemFields.primaryKey.filter(B=>B!==h);p(D)}},k=h=>{if(!g.value[c.value])return;const U={...g.value},D=U[c.value];D&&(D.systemFields||(D.systemFields={primaryKey:[]}),D.systemFields.createdAt===h?D.systemFields.createdAt=void 0:D.systemFields.createdAt=h,p(U))},u=h=>{if(!g.value[c.value])return;const U={...g.value},D=U[c.value];D&&(D.systemFields||(D.systemFields={primaryKey:[]}),D.systemFields.updatedAt===h?D.systemFields.updatedAt=void 0:D.systemFields.updatedAt=h,p(U))},E=ee(()=>{var O;const h=g.value[c.value];return(O=h==null?void 0:h.systemFields)==null?void 0:O.createdAt}),L=ee(()=>{var O;const h=g.value[c.value];return(O=h==null?void 0:h.systemFields)==null?void 0:O.updatedAt});return Je(async()=>{if(g.value&&Object.keys(g.value).length>0){const U=o.value.config.tables||[];if(Object.keys(g.value).every(D=>U.includes(D))){f();return}}const h=await y(o.value);o.value.config.custom_schema=h;const O={...g.value};Object.keys(O).forEach(U=>{const D=O[U];if(D&&D.columns){if(D.relations||(D.relations=[]),D.systemFields||(D.systemFields={primaryKey:[]}),D.columns.forEach(K=>{K.exclude=!!K.exclude}),D.systemFields.primaryKey.length===0&&D.columns.length>0){const K=D.columns[0];K&&(D.systemFields.primaryKey=[K.title])}D.systemFields.primaryKey.forEach(K=>{const B=D.columns.find(b=>b.title===K);B&&(B.exclude=!1)})}}),p(O),f()}),(h,O)=>{var B;const U=ms,D=vs,K=Ys;return a(),M("div",Nc,[t("div",jc,[O[0]||(O[0]=t("div",{class:"header"},[t("h2",null,"Map Table Columns"),t("p",null,"Review and configure the columns for each selected table")],-1)),t("div",Ec,[t("div",Bc,[(a(!0),M(pe,null,Be(e($),b=>(a(),M("button",{key:b,class:ue(["tab-button",{active:e(c)===b}]),onClick:q=>c.value=b},m(b),11,Ac))),128))])])]),e(c)&&e(g)[e(c)]?(a(),M("div",Uc,[t("div",Rc,[t("h3",null,"Table: "+m(e(c)),1),t("div",Lc,[s(U,{checked:e(w),"onUpdate:checked":_},{default:n(()=>O[1]||(O[1]=[V("Select All Columns")])),_:1,__:[1]},8,["checked"])])]),t("div",Fc,[t("table",zc,[O[4]||(O[4]=t("thead",null,[t("tr",null,[t("th",null,"Include"),t("th",null,"Column Name"),t("th",null,"Original Type"),t("th",null,"Target Type"),t("th",null,"Unique ID"),t("th",null,"Created At"),t("th",null,"Updated At")])],-1)),t("tbody",null,[(a(!0),M(pe,null,Be(((B=e(g)[e(c)])==null?void 0:B.columns)||[],(b,q)=>(a(),M("tr",{key:b.title},[t("td",null,[s(U,{checked:!b.exclude||i(b.title),disabled:i(b.title),"onUpdate:checked":se=>l(q,"exclude",!se)},null,8,["checked","disabled","onUpdate:checked"])]),t("td",null,m(b.title),1),t("td",null,m(b.abstractType),1),t("td",null,[s(D,{value:b.uidt,"onUpdate:value":[se=>b.uidt=se,se=>l(q,"uidt",se)],options:P(b),style:{width:"100%"}},null,8,["value","onUpdate:value","options"])]),t("td",Vc,[s(U,{checked:i(b.title),"onUpdate:checked":se=>T(b.title,se)},null,8,["checked","onUpdate:checked"])]),t("td",Gc,[s(K,{type:"text",size:"small",class:ue(["radio-button",{selected:e(E)===b.title}]),onClick:se=>k(b.title)},{default:n(()=>O[2]||(O[2]=[t("div",{class:"custom-radio-circle"},null,-1)])),_:2,__:[2]},1032,["class","onClick"])]),t("td",Wc,[s(K,{type:"text",size:"small",class:ue(["radio-button",{selected:e(L)===b.title}]),onClick:se=>u(b.title)},{default:n(()=>O[3]||(O[3]=[t("div",{class:"custom-radio-circle"},null,-1)])),_:2,__:[3]},1032,["class","onClick"])])]))),128))])])])])):(a(),M("div",Kc,O[5]||(O[5]=[t("p",null,"No tables available for mapping",-1)])))])}}}),Yc=Object.assign(xe(qc,[["__scopeId","data-v-d5c40602"]]),{__name:"DashboardSettingsSyncDestinationSchema"}),Qc={class:"review-container"},Hc={class:"section"},Jc={class:"section-title"},Zc={class:"grid grid-cols-2 gap-4"},Xc={class:"info-item"},er={class:"info-value"},tr={class:"info-item"},sr={class:"info-value"},nr={class:"info-item"},ar={class:"info-value"},or={class:"info-item"},lr={class:"info-value"},ir={class:"section"},cr={class:"section-title"},rr={class:"text-xs text-gray-500 ml-auto"},dr={class:"model-list"},ur={key:0,class:"flex items-center py-2"},pr={key:1,class:"grid grid-cols-2 gap-2"},_r=ce({__name:"Review",setup(S){const{syncConfigForm:o}=$t(),y=ee(()=>{var x;const f=o.value.sync_type;return((x=Hs[f])==null?void 0:x.label)||f}),g=ee(()=>{var x;const f=o.value.sync_trigger;return((x=Js[f])==null?void 0:x.label)||f}),c=ee(()=>{var x;const f=o.value.on_delete_action;return((x=Zs[f])==null?void 0:x.label)||f}),$=ee(()=>Object.values(Qs).filter(f=>f.category===o.value.sync_category||!o.value.sync_category)),I=ee(()=>o.value.exclude_models.length===0),w=ee(()=>I.value?$.value:$.value.filter(f=>!o.value.exclude_models.includes(f.value)));return(f,x)=>{const P=ke,p=da;return a(),M("div",Qc,[t("div",Hc,[t("div",Jc,[s(P,{icon:"settings",class:"text-primary mr-2"}),x[0]||(x[0]=t("h3",null,"Sync Configuration",-1))]),s(p,{class:"mb-4 !rounded-lg"},{default:n(()=>[t("div",Zc,[t("div",Xc,[x[1]||(x[1]=t("div",{class:"info-label"},"Title",-1)),t("div",er,m(e(o).title),1)]),t("div",tr,[x[2]||(x[2]=t("div",{class:"info-label"},"Sync Type",-1)),t("div",sr,[s(P,{icon:"refresh",class:"text-primary mr-2"}),V(" "+m(e(y)),1)])]),t("div",nr,[x[3]||(x[3]=t("div",{class:"info-label"},"Sync Trigger",-1)),t("div",ar,[s(P,{icon:"clock",class:"text-primary mr-2"}),V(" "+m(e(g)),1)])]),t("div",or,[x[4]||(x[4]=t("div",{class:"info-label"},"On Delete Action",-1)),t("div",lr,[s(P,{icon:"delete",class:"text-primary mr-2"}),V(" "+m(e(c)),1)])])])]),_:1})]),t("div",ir,[t("div",cr,[s(P,{icon:"table",class:"text-primary mr-2"}),x[5]||(x[5]=t("h3",null,"Models to Sync",-1)),t("div",rr,m(e(I)?"All models will be synced":`${e(w).length} of ${e($).length} models selected`),1)]),s(p,{class:"mb-4 !rounded-lg"},{default:n(()=>[t("div",dr,[e(I)?(a(),M("div",ur,[s(P,{icon:"check",class:"text-green-600 mr-2"}),x[6]||(x[6]=t("span",{class:"text-sm"},"All available models will be synced",-1))])):(a(),M("div",pr,[(a(!0),M(pe,null,Be(e(w),i=>(a(),M("div",{key:i.value,class:"model-item"},[s(P,{icon:i.icon,class:"text-primary mr-2"},null,8,["icon"]),t("span",null,m(i.label),1)]))),128))]))])]),_:1})])])}}}),mr=Object.assign(xe(_r,[["__scopeId","data-v-295586ca"]]),{__name:"DashboardSettingsSyncReview"}),vr={class:"flex-1 flex flex-col max-h-full create-source"},fr={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},br={class:"flex items-center"},yr={class:"flex items-center gap-3"},gr={class:"h-[calc(100%_-_58px)] flex justify-center p-5"},hr={class:"flex flex-col gap-10 w-full items-center overflow-y-auto"},xr={class:"w-5xl"},wr={class:"flex rounded-lg p-6 border-1 border-nc-border-gray-medium"},kr={class:"nc-form-section"},$r={class:"flex flex-col gap-5"},Sr={key:0,class:"w-3xl"},Cr={key:1,class:"w-3xl"},Ir={key:2,class:"w-3xl"},Tr={key:3},Dr={key:4,class:"w-3xl"},Mr={key:0},Or={key:0,class:"flex justify-center items-center"},Pr={key:1,class:"flex justify-center items-center"},Nr={key:1},jr={key:0,class:"w-3xl flex justify-between"},Er=ce({__name:"Create",props:{open:{type:Boolean},baseId:{},isModal:{type:Boolean}},emits:["update:open","syncCreated"],setup(S,{emit:o}){const y=S,g=o,c=Ge(y,"open",g),{loadDynamicIntegrations:$}=Ut(),{activeWorkspaceId:I}=ve(xt()),w=Qe(),{loadTables:f}=w,{refreshCommandPalette:x}=Kt(),{$poller:P}=Ae(),p=z(0),i=z(!1),r=z(!1),_=z(),l=z(!1),{createSync:T,formState:k,syncConfigForm:u,isLoading:E,deepReference:L,switchToIntegrationConfig:h,resetStore:O,saveCurrentFormState:U,validateSyncConfig:D}=un(I,y.baseId),K=async()=>{E.value=!0,l.value=!0;try{const G=await T();if(!G)return;P.subscribe({id:G.job.id},async v=>{var H,ne,j,d,R,J;v.status!=="close"&&(v.status===qe.COMPLETED?((H=_.value)==null||H.pushProgress("Done!",v.status),await f(),x(),i.value=!0):v.status===qe.FAILED?((d=_.value)==null||d.pushProgress(((j=(ne=v.data)==null?void 0:ne.error)==null?void 0:j.message)??"Sync failed",v.status),await f(),x(),r.value=!0):(J=_.value)==null||J.pushProgress(((R=v.data)==null?void 0:R.message)??"Syncing...","progress"),g("syncCreated"))})}catch(G){_e.error(await Re(G)),l.value=!1}finally{E.value=!1}},B=async()=>{switch(p.value){case 0:p.value=1;break;case 2:await U()&&(u.value.sync_category==="custom"?p.value=3:p.value=4);break;case 1:try{await D(),p.value=2}catch{}break;case 3:if(k.value.config.custom_schema){for(const G of Object.values(k.value.config.custom_schema))if(!G.systemFields.primaryKey||G.systemFields.primaryKey.length===0){_e.error("Every table must have at least one unique identifier column");return}await U()&&(p.value=4)}break;case 4:K();break}},b=()=>{switch(p.value){case 0:p.value=0;break;case 1:p.value=0;break;case 2:p.value=1;break;case 3:p.value=2;break;case 4:u.value.sync_category==="custom"?p.value=3:p.value=2;break}},q=G=>{u.value.sync_category=G,p.value=1},se=ee(()=>{switch(p.value){case 0:return!!u.value.sync_category;case 2:return k.value.sub_type;default:return!0}});Je(async()=>{E.value=!0,await $(),ct(()=>{h(0)}),E.value=!1}),Oe(()=>c.value,G=>{G&&(p.value=0,O())});const C=()=>{r.value=!1,l.value=!1,i.value=!1};function oe(){C(),c.value=!1}const Z=()=>{C(),c.value=!1},Y=ee(()=>!l.value);return(G,v)=>{const H=ke,ne=We,j=rc,d=pc,R=vt,J=Zt,re=Jt,Ie=pn,$e=_n,ye=mn,Le=Yc,Ee=ps,Pe=mr,Fe=mt,ge=At;return a(),N(ge,{visible:e(c),"onUpdate:visible":v[1]||(v[1]=ze=>le(c)?c.value=ze:null),"mask-closable":e(Y),keyboard:e(Y),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:jt(Z,["esc"])},{default:n(()=>[t("div",vr,[t("div",fr,[t("div",br,[s(H,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"})]),v[2]||(v[2]=t("div",{class:"flex-1 text-base font-weight-700"},"Create Sync",-1)),t("div",yr,[s(ne,{disabled:e(l),size:"small",type:"text",onClick:Z},{default:n(()=>[s(H,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",gr,[t("div",hr,[t("div",xr,[s(j,{current:e(p)},null,8,["current"])]),t("div",wr,[s(Fe,{name:"external-base-create-form",layout:"vertical","no-style":"","hide-required-mark":"",class:"flex flex-col w-full"},{default:n(()=>[t("div",kr,[t("div",$r,[e(p)===0?(a(),M("div",Sr,[s(re,{gutter:24},{default:n(()=>[s(J,{span:24},{default:n(()=>[s(R,{label:"Sync Category"},{default:n(()=>[s(d,{"model-value":e(L)("sync_category"),onChange:v[0]||(v[0]=ze=>q(ze))},null,8,["model-value"])]),_:1})]),_:1})]),_:1})])):A("",!0),e(p)===2?(a(),M("div",Cr,[t("div",null,[s(Ie),s($e)])])):A("",!0),e(p)===1?(a(),M("div",Ir,[s(ye)])):A("",!0),e(u).sync_category==="custom"&&e(p)===3?(a(),M("div",Tr,[s(Le)])):A("",!0),e(p)===4?(a(),M("div",Dr,[e(l)?(a(),M("div",Mr,[v[5]||(v[5]=t("div",{class:"mb-4 prose-xl font-bold"},"Creating sync schema and syncing initial data",-1)),s(Ee,{ref_key:"progressRef",ref:_,class:"w-full"},null,512),e(i)?(a(),M("div",Or,[s(ne,{class:"mt-6 mb-8",size:"medium",onClick:oe},{default:n(()=>v[3]||(v[3]=[V(" 🚀 Go To Dashboard 🚀")])),_:1,__:[3]})])):e(r)?(a(),M("div",Pr,[s(ne,{class:"mt-6 mb-8",type:"ghost",size:"medium",onClick:oe},{default:n(()=>v[4]||(v[4]=[V("Go Dashboard")])),_:1,__:[4]})])):A("",!0)])):(a(),M("div",Nr,[s(Pe)]))])):A("",!0)])])]),_:1})]),e(l)?A("",!0):(a(),M("div",jr,[s(ne,{type:"ghost",disabled:e(p)===0,onClick:b},{default:n(()=>v[6]||(v[6]=[V(" Back ")])),_:1,__:[6]},8,["disabled"]),s(ne,{type:"primary",loading:e(l),disabled:!e(se),onClick:B},{default:n(()=>[V(m(e(p)===4?"Create":"Continue"),1)]),_:1},8,["loading","disabled"])]))])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),vn=Object.assign(xe(Er,[["__scopeId","data-v-d96ebc09"]]),{__name:"DashboardSettingsSyncCreate"}),Br=Object.freeze(Object.defineProperty({__proto__:null,default:vn},Symbol.toStringTag,{value:"Module"})),Ar=["onClick"],Ur={key:0,class:"tab-title nc-tab"},Rr=ce({__name:"SelectTab",props:ua({disabled:{type:Boolean},tooltip:{},items:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(S){const o=S,y=pa(S,"modelValue");return(g,c)=>{const $=ke,I=Xe,w=Yt("e");return a(),N(I,{disabled:!o.tooltip},{title:n(()=>[V(m(o.tooltip),1)]),default:n(()=>[t("div",{class:ue(["flex flex-row p-1 bg-gray-200 rounded-lg gap-x-0.5",{"!cursor-not-allowed opacity-50":o.disabled}])},[(a(!0),M(pe,null,Be(o.items.filter(f=>!f.hidden),f=>(a(),N(I,{key:f.value,disabled:!f.tooltip||o.disabled},{title:n(()=>[V(m(f.tooltip),1)]),default:n(()=>[He((a(),M("div",{class:ue(["tab",{"pointer-events-none":o.disabled,active:y.value===f.value}]),onClick:x=>y.value=f.value},[s($,{icon:f.icon,class:"tab-icon"},null,8,["icon"]),f.title?(a(),M("div",Ur,m(g.$t(f.title)),1)):A("",!0)],10,Ar)),[[w,[`c:project:mode:${f.value}`]]])]),_:2},1032,["disabled"]))),128))],2)]),_:1},8,["disabled"])}}}),Lr=Object.assign(xe(Rr,[["__scopeId","data-v-5b285768"]]),{__name:"NcSelectTab"}),Fr={class:"flex-1 flex flex-col max-h-full create-source"},zr={class:"px-4 py-3 w-full flex items-center gap-3 border-b-1 border-gray-200"},Vr={class:"flex items-center"},Gr={class:"flex items-center gap-3"},Wr={class:"h-[calc(100%_-_58px)] flex justify-center p-5"},Kr={class:"flex flex-col gap-10 w-full items-center overflow-y-auto"},qr={class:"w-3xl flex rounded-lg p-6 w-full border-1 border-nc-border-gray-medium relative"},Yr={key:0,class:"absolute inset-0 bg-gray-500/10 z-10 rounded-lg cursor-not-allowed"},Qr={key:1,class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},Hr={key:0,class:"sync-info bg-gray-100 p-4 rounded-lg w-full"},Jr={class:"flex justify-between items-center"},Zr={class:"flex flex-col gap-2"},Xr={class:"text-sm text-gray-500"},ed={key:0,class:"text-sm text-gray-500"},td={class:"w-full flex flex-col mt-3"},sd={class:"flex items-center gap-3"},nd={class:"flex"},ad={class:"nc-form-section"},od={class:"flex flex-col gap-5"},ld={key:3,class:"create-source bg-white relative flex flex-col gap-2 w-full max-w-[768px]"},id={class:"nc-form-section w-full"},cd=ce({__name:"Edit",props:{open:{type:Boolean},baseId:{},syncId:{},isModal:{type:Boolean}},emits:["update:open","syncUpdated"],setup(S,{emit:o}){const y=S,c=Ge(y,"open",o),{integrations:$,loadDynamicIntegrations:I,loadIntegrations:w}=Ut(),f=xt(),{activeWorkspaceId:x}=ve(f),{$poller:P}=Ae(),p=z([{title:"Sync",value:"sync",icon:"ncZap"},{title:"Sync Settings",value:"sync-settings",icon:"ncSettings"},{title:"Integrations",value:"integrations",icon:"ncSettings"}]),{integrationConfigs:i,isLoading:r,loadConfig:_,syncConfigEditForm:l,editMode:T,editModeSync:k,triggerSync:u,readSync:E,editTab:L}=un(x,y.baseId);T.value=!0;const h=z(!1),O=z(!1),U=z(!1),D=z();async function K(){r.value=!0,await I(),await w();const se=await E(y.syncId);k.value=se,l.value=se;const C=[se,...se.children];i.value=C.map(oe=>{const Z=$.value.find(Y=>Y.id===oe.fk_integration_id);return Z?{...Z,syncConfigId:oe.id,parentSyncConfigId:oe.fk_parent_sync_config_id}:null}),r.value=!1}const B=async se=>{se==="integrations"&&await _(0)},b=async()=>{if(k.value)try{O.value=!0;const se=await u(y.syncId,!0);if(!se){O.value=!1;return}P.subscribe({id:se.id},async C=>{var oe,Z,Y,G,v,H,ne;C.status!=="close"&&(C.status===qe.COMPLETED?((Z=D.value)==null||Z.pushProgress(((oe=C.data)==null?void 0:oe.message)??"Done!",C.status),O.value=!1,U.value=!0):C.status===qe.FAILED?((v=D.value)==null||v.pushProgress(((G=(Y=C.data)==null?void 0:Y.error)==null?void 0:G.message)??"Sync failed",C.status),O.value=!1,U.value=!0):(ne=D.value)==null||ne.pushProgress(((H=C.data)==null?void 0:H.message)??"",C.status))})}catch(se){_e.error(await Fs(se)),O.value=!1}};Je(()=>{K()});const q=ee(()=>!h.value&&!O.value);return(se,C)=>{const oe=ke,Z=We,Y=Lr,G=ps,v=mn,H=mt,ne=pn,j=_n,d=At;return a(),N(d,{visible:e(c),"onUpdate:visible":C[3]||(C[3]=R=>le(c)?c.value=R:null),"mask-closable":e(q),keyboard:e(q),centered:"",size:"large","wrap-class-name":"nc-modal-create-source",onKeydown:C[4]||(C[4]=jt(R=>c.value=!1,["esc"]))},{default:n(()=>[t("div",Fr,[t("div",zr,[t("div",Vr,[s(oe,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"})]),C[5]||(C[5]=t("div",{class:"flex-1 text-base font-weight-700"},"Edit Sync Configuration",-1)),t("div",Gr,[s(Z,{disabled:e(h)||e(O),size:"small",type:"text",onClick:C[0]||(C[0]=R=>c.value=!1)},{default:n(()=>[s(oe,{icon:"close",class:"text-gray-600"})]),_:1},8,["disabled"])])]),t("div",Wr,[t("div",Kr,[t("div",null,[s(Y,{modelValue:e(L),"onUpdate:modelValue":[C[1]||(C[1]=R=>le(L)?L.value=R:null),B],items:e(p)},null,8,["modelValue","items"])]),t("div",qr,[e(L)==="integrations"&&e(l).sync_category==="custom"?(a(),M("div",Yr)):A("",!0),e(L)==="sync"?(a(),M("div",Qr,[e(k)?(a(),M("div",Hr,[t("div",Jr,[C[6]||(C[6]=t("div",{class:"text-lg font-semibold"},"Sync Information",-1)),t("div",Zr,[t("div",Xr," Last Sync: "+m(e(k).last_sync_at?e(k).last_sync_at:"Never"),1),e(k).next_sync_at?(a(),M("div",ed," Next Sync: "+m(e(k).next_sync_at),1)):A("",!0)])])])):A("",!0),t("div",td,[t("div",sd,[!e(O)&&!e(U)?(a(),N(Z,{key:0,size:"small",type:"primary",class:"nc-extdb-btn-submit",loading:e(O),disabled:e(r)||e(h),onClick:b},{default:n(()=>C[7]||(C[7]=[V(" Trigger Sync ")])),_:1,__:[7]},8,["loading","disabled"])):A("",!0),e(U)?(a(),N(Z,{key:1,size:"small",type:"primary",class:"nc-extdb-btn-submit",onClick:C[2]||(C[2]=R=>U.value=!1)},{default:n(()=>C[8]||(C[8]=[V(" Minimize ")])),_:1,__:[8]})):A("",!0)])]),t("div",nd,[e(O)||e(U)?(a(),N(G,{key:0,ref_key:"progressRef",ref:D,class:"w-full h-[400px]"},null,512)):A("",!0)])])):A("",!0),e(L)==="sync-settings"?(a(),N(H,{key:2,name:"external-base-create-form",layout:"vertical","no-style":"","hide-required-mark":"",class:"flex flex-col w-full"},{default:n(()=>[t("div",ad,[t("div",od,[s(v,{"edit-mode":!0})])])]),_:1})):A("",!0),e(L)==="integrations"?(a(),M("div",ld,[t("div",id,[s(ne),s(j,{"edit-mode":!0})])])):A("",!0)])])])])]),_:1},8,["visible","mask-closable","keyboard"])}}}),rd=Object.assign(xe(cd,[["__scopeId","data-v-042481d1"]]),{__name:"DashboardSettingsSyncEdit"}),dd={class:"flex flex-col h-full p-6","data-testid":"nc-settings-syncs-tab"},ud={class:"mb-6 flex items-center justify-between gap-3"},pd={class:"flex flex-row items-center w-full gap-x-1"},_d={class:"flex-1 overflow-auto"},md={class:"ds-table overflow-y-auto nc-scrollbar-thin relative max-h-full mb-4"},vd={class:"ds-table-body relative"},fd=["onClick"],bd={class:"ds-table-col ds-table-name font-medium"},yd={class:"flex items-center gap-1"},gd={class:"ds-table-col ds-table-type"},hd={class:"ds-table-col ds-table-frequency"},xd={class:"ds-table-col ds-table-last-sync"},wd={class:"ds-table-col ds-table-actions"},kd={class:"flex justify-end gap-2"},$d={key:0,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Sd={key:1,class:"flex-none integration-table-empty flex items-center justify-center py-8 px-6"},Cd={class:"flex items-center justify-center absolute left-0 top-0 w-full h-[calc(100%_-_45px)] z-10 pb-10 pointer-events-none"},Id={class:"flex flex-col justify-center items-center gap-2"},Td=ce({__name:"Syncs",props:{state:{},baseId:{},reload:{type:Boolean}},emits:["update:state","update:reload"],setup(S,{emit:o}){const y=S,c=Ge(y,"reload",o),{$api:$,$poller:I}=Ae(),{projectPageTab:w}=ve(ss()),f=xt(),{activeWorkspace:x}=ve(f),P=Qe(),{loadTables:p}=P,{isUIAllowed:i}=dt(),r=z(""),_=z([]),l=z(!1),T=z(!1),k=z(!1),u=z(""),E=(B,b)=>B===Gt.Manual?"Manual":B===Gt.Schedule&&b?b.includes("hourly")?"Hourly":b.includes("daily")?"Daily":b.includes("weekly")?"Weekly":b:"Unknown",L=async()=>{l.value=!0;try{const B=await $.internal.getOperation(x.value.id,y.baseId,{operation:"listSync"});_.value=B.map(b=>({...b,frequency:E(b.sync_trigger,b.sync_trigger_cron)}))}catch(B){console.error(B)}finally{l.value=!1}},h=B=>B?new Date(B).toLocaleString():"-",O=()=>{T.value=!0},U=B=>{u.value=B,k.value=!0},D=async B=>{try{await $.internal.postOperation(x.value.id,y.baseId,{operation:"deleteSync"},{syncConfigId:B}),await p(),await L()}catch(b){console.error(b)}},K=()=>r.value?_.value.some(B=>{var b,q;return((b=B.title)==null?void 0:b.toLowerCase().includes(r.value.toLowerCase()))||((q=B.sync_type)==null?void 0:q.toLowerCase().includes(r.value.toLowerCase()))}):!0;return Je(()=>{ht(()=>!!x.value).toBeTruthy().then(()=>{L()})}),Oe(()=>y.reload,B=>{B&&(c.value=!1)}),Oe(w,()=>{w.value==="syncs"&&ht(()=>!!x.value).toBeTruthy().then(()=>{L()})},{immediate:!0}),(B,b)=>{const q=ke,se=ft,C=We,oe=$s,Z=es,Y=Xt,G=ts,v=ks,H=Qt,ne=vn,j=rd;return a(),M("div",dd,[t("div",ud,[s(se,{value:e(r),"onUpdate:value":b[0]||(b[0]=d=>le(r)?r.value=d:null),type:"text",class:"nc-search-syncs-input nc-input-border-on-value !max-w-90 nc-input-sm",placeholder:"Search syncs","allow-clear":""},{prefix:n(()=>[s(q,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value"]),e(i)("sourceCreate")?(a(),N(C,{key:0,size:"small",class:"z-10 !px-2",type:"primary",onClick:O},{default:n(()=>[t("div",pd,[s(q,{icon:"plus"}),b[5]||(b[5]=t("div",{class:"flex"},"Create Sync",-1))])]),_:1})):A("",!0)]),t("div",_d,[t("div",md,[b[11]||(b[11]=_a('<div class="ds-table-head sticky top-0 bg-white z-10" data-v-a37f67e0><div class="ds-table-row !border-0" data-v-a37f67e0><div class="ds-table-col ds-table-name" data-v-a37f67e0>Name</div><div class="ds-table-col ds-table-type" data-v-a37f67e0>Type</div><div class="ds-table-col ds-table-frequency" data-v-a37f67e0>Frequency</div><div class="ds-table-col ds-table-last-sync" data-v-a37f67e0>Last Run</div><div class="ds-table-col ds-table-actions" data-v-a37f67e0>Actions</div></div></div>',1)),t("div",vd,[(a(!0),M(pe,null,Be(e(_),d=>{var R,J;return a(),M("div",{key:d.id,class:ue(["ds-table-row border-gray-200 cursor-pointer",{"!hidden":e(r)&&!((R=d.title)!=null&&R.toLowerCase().includes(e(r).toLowerCase()))&&!((J=d.sync_type)!=null&&J.toLowerCase().includes(e(r).toLowerCase()))}]),onClick:re=>U(d.id)},[t("div",bd,[t("div",yd,[s(q,{icon:"ncZap",class:"!text-green-700 !h-5 !w-5"}),V(" "+m(d.title||"Untitled Sync"),1)])]),t("div",gd,[s(oe,{rounded:"lg",class:"flex items-center gap-2 px-2 py-1 !h-7 truncate !border-transparent"},{default:n(()=>[V(m(d.sync_type===e(qs).Full?"Full":"Incremental"),1)]),_:2},1024)]),t("div",hd,m(d.frequency),1),t("div",xd,m(h(d.last_sync_at)),1),t("div",wd,[t("div",kd,[s(v,{placement:"bottomRight",onClick:b[1]||(b[1]=Ye(()=>{},["stop"]))},{overlay:n(()=>[s(G,{variant:"small"},{default:n(()=>[s(Z,{onClick:re=>U(d.id)},{default:n(()=>[s(q,{icon:"edit"}),b[6]||(b[6]=t("span",null,"Edit",-1))]),_:2,__:[6]},1032,["onClick"]),s(Y),s(Z,{class:"!text-red-500 !hover:bg-red-50",onClick:re=>D(d.id)},{default:n(()=>[s(q,{icon:"delete"}),b[7]||(b[7]=t("span",null,"Delete",-1))]),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(C,{size:"small",type:"text",class:"nc-action-btn !w-8 !px-1 !rounded-lg"},{default:n(()=>[s(q,{icon:"threeDotVertical"})]),_:1})]),_:2},1024)])])],10,fd)}),128)),!e(l)&&e(_).length===0?(a(),M("div",$d,b[8]||(b[8]=[t("div",{class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},[t("img",{src:cs,class:"!w-[164px] flex-none",alt:"No syncs found"}),V(" No syncs found ")],-1)]))):A("",!0),!e(l)&&e(_).length>0&&!K()?(a(),M("div",Sd,b[9]||(b[9]=[t("div",{class:"px-2 py-6 text-gray-500 flex flex-col items-center gap-6 text-center"},[t("img",{src:cs,class:"!w-[164px] flex-none",alt:"No search results found"}),V(" No results matched your search ")],-1)]))):A("",!0)]),He(t("div",Cd,[t("div",Id,[s(H,{size:"xlarge"}),b[10]||(b[10]=t("span",{class:"text-center"},"Loading",-1))])],512),[[Vt,e(l)]])])]),e(T)?(a(),N(ne,{key:0,open:e(T),"onUpdate:open":b[2]||(b[2]=d=>le(T)?T.value=d:null),"base-id":y.baseId,onSyncCreated:L},null,8,["open","base-id"])):A("",!0),e(k)&&e(u)?(a(),N(j,{key:1,open:e(k),"onUpdate:open":[b[3]||(b[3]=d=>le(k)?k.value=d:null),b[4]||(b[4]=d=>k.value=d)],"base-id":y.baseId,"sync-id":e(u),onSyncUpdated:L},null,8,["open","base-id","sync-id"])):A("",!0)])}}}),Dd=Object.assign(xe(Td,[["__scopeId","data-v-a37f67e0"]]),{__name:"DashboardSettingsSyncs"}),Md={};function Od(S,o){const y=kt;return a(),N(y)}const Pd=Object.assign(xe(Md,[["render",Od]]),{__name:"DashboardSettingsBaseAccess"}),Nd={};function jd(S,o){return a(),M("div")}const Ed=Object.assign(xe(Nd,[["render",jd]]),{__name:"DashboardSettingsBaseSnapshots"}),Bd={"data-testid":"nc-settings-subtab-visibility",class:"item-card flex flex-col w-full"},Ad={class:"text-nc-content-gray-emphasis font-semibold text-lg"},Ud={class:"text-nc-content-gray-subtle2 mt-2 leading-5"},Rd={class:"flex flex-col border-1 rounded-lg mt-6 border-nc-border-gray-medium"},Ld={class:"flex w-full px-3 py-2 gap-2 flex-col"},Fd={class:"flex w-full gap-1 items-center"},zd={class:"text-nc-content-gray font-semibold flex-1"},Vd={class:"text-gray-500 pl-10"},Gd={class:"flex w-full px-3 border-t-1 border-nc-border-gray-medium py-2 gap-2 flex-col"},Wd={class:"flex w-full gap-1 items-center"},Kd={class:"text-nc-content-gray font-semibold flex-1"},qd={class:"text-gray-500 pl-10"},Yd={class:"flex w-full px-3 py-2 border-t-1 border-nc-border-gray-medium gap-2 flex-col"},Qd={class:"flex w-full gap-1 items-center"},Hd={class:"text-nc-content-gray font-semibold flex-1"},Jd={class:"text-gray-500 pl-10"},Zd=ce({__name:"Visibility",setup(S){const{t:o}=rt(),y=Qe(),g=tt(),{base:c}=ve(y),$=Bt(hs,void 0),{loadTables:I,hasEmptyOrNullFilters:w}=y,f=ee(()=>{var r;return($==null?void 0:$.value)??((r=c.value)==null?void 0:r.id)}),x=z(),{includeM2M:P,showNull:p}=wt();Oe(P,async()=>await I()),Je(async()=>{var r;await g.loadProject(f.value,!0),x.value=(r=g.getProjectMeta(f.value))==null?void 0:r.showNullAndEmptyInFilter});async function i(r){const _=g.bases.get(f.value);if(!_)throw new Error(`Base ${f.value} not found`);const l=g.getProjectMeta(f.value)??{};r||await w()&&(x.value=!0,_e.warning(o("msg.error.nullFilterExists")));const T={...l,showNullAndEmptyInFilter:x.value};_.meta=T,await g.updateProject(f.value,{meta:JSON.stringify(T)})}return(r,_)=>{const l=ma,T=Yt("e");return a(),M("div",Bd,[t("div",Ad,m(r.$t("labels.visibilityAndDataHandling")),1),t("div",Ud,m(r.$t("labels.visibilityConfigLabel")),1),t("div",Rd,[t("div",Ld,[t("div",Fd,[He((a(),N(l,{checked:e(P),"onUpdate:checked":_[0]||(_[0]=k=>le(P)?P.value=k:null),class:"nc-settings-meta-misc-m2m"},{default:n(()=>[t("span",zd,m(r.$t("msg.info.showM2mTables")),1)]),_:1},8,["checked"])),[[T,["c:themes:show-m2m-tables"]]])]),t("span",Vd,m(r.$t("msg.info.showM2mTablesDesc")),1)]),t("div",Gd,[t("div",Wd,[He((a(),N(l,{checked:e(p),"onUpdate:checked":_[1]||(_[1]=k=>le(p)?p.value=k:null),class:"nc-settings-show-null"},{default:n(()=>[t("span",Kd,m(r.$t("msg.info.showNullInCells")),1)]),_:1},8,["checked"])),[[T,["c:settings:show-null"]]])]),t("span",qd,m(r.$t("msg.info.showNullInCellsDesc")),1)]),t("div",Yd,[t("div",Qd,[He((a(),N(l,{checked:e(x),"onUpdate:checked":_[2]||(_[2]=k=>le(x)?x.value=k:null),class:"nc-settings-show-null-and-empty-in-filter",onChange:i},{default:n(()=>[t("span",Hd,m(r.$t("msg.info.showNullAndEmptyInFilter")),1)]),_:1},8,["checked"])),[[T,["c:settings:show-null-and-empty-in-filter"]]])]),t("span",Jd,m(r.$t("msg.info.showNullAndEmptyInFilterDesc")),1)])])])}}}),Xd=Object.assign(Zd,{__name:"DashboardSettingsBaseVisibility"}),eu={"data-testid":"nc-settings-subtab-visibility",class:"item-card flex flex-col w-full"},tu={class:"flex flex-col border-1 rounded-lg mt-6 border-nc-border-gray-medium"},su={class:"flex w-full px-3 py-2 gap-2 flex-col"},nu={class:"flex flex-col w-full gap-1"},au=ce({__name:"Migrate",setup(S){const{$state:o,$api:y}=Ae(),g=y.instance.defaults.baseURL,c=Qe(),$=tt(),{base:I}=ve(c),w=Bt(hs,void 0),f=ee(()=>{var i;return(w==null?void 0:w.value)??((i=I.value)==null?void 0:i.id)}),x=z({migrationUrl:void 0}),P=z(!1);async function p(){P.value=!0;try{const i=await $fetch(`/api/v2/meta/migrate/${f.value}`,{baseURL:g,method:"POST",headers:{"xc-auth":o.token.value},body:x.value});i!=null&&i.msg&&_e.info(i.msg)}catch(i){_e.error(i.message)}finally{P.value=!1}}return Je(async()=>{await $.loadProject(f.value,!0)}),(i,r)=>{const _=ft,l=vt,T=mt,k=We;return a(),M("div",eu,[r[3]||(r[3]=t("div",{class:"text-nc-content-gray-emphasis font-semibold text-lg"},"Migrate Data To NocoDB",-1)),r[4]||(r[4]=t("div",{class:"text-nc-content-gray-subtle2 mt-2 leading-5"},"Easily migrate your data to NocoDB Cloud",-1)),t("div",tu,[t("div",su,[t("div",nu,[s(T,{ref:"form",name:"quick-migrate-form",layout:"horizontal",class:"m-0"},{default:n(()=>[s(l,{class:"!m-0"},{default:n(()=>[r[1]||(r[1]=t("div",{class:"flex items-end"},[t("label",null," Migration URL ")],-1)),s(_,{value:e(x).migrationUrl,"onUpdate:value":r[0]||(r[0]=u=>e(x).migrationUrl=u),placeholder:"Enter migration URL for destination",class:"!rounded-lg !my-2 nc-input-api-key"},null,8,["value"])]),_:1,__:[1]})]),_:1},512),s(k,{type:"primary",loading:e(P),disabled:!e(x).migrationUrl,onClick:p},{default:n(()=>r[2]||(r[2]=[V(" Migrate ")])),_:1,__:[2]},8,["loading","disabled"])])])])])}}}),ou=Object.assign(au,{__name:"DashboardSettingsBaseMigrate"}),Cs=va(()=>{const{$api:S}=Ae(),{user:o}=wt(),{t:y}=rt(),g=tt(),{activeWorkspaceId:c}=ve(xt()),{activeProjectId:$}=ve(g),{basesUser:I}=ve(g),w=ee(()=>$.value?I.value.get($.value)||[]:[]),f=z([]),x=z(""),P=z(!1),p=ee(()=>f.value.some(u=>u.isNew));return{mcpTokens:f,createMcpToken:async u=>{if($.value)try{P.value=!0;const E=await S.internal.postOperation(c.value,$.value,{operation:"mcpCreate"},{...u,title:x.value});if(E){const L=f.value.findIndex(h=>h.isNew);if(L!==-1){const h=E,O=w.value.find(U=>U.id===h.fk_user_id);f.value[L]={...h,isNew:!1,created_display_name:(O==null?void 0:O.display_name)??(O==null?void 0:O.email)??""}}}return _e.success(y("msg.success.mcpTokenCreated")),P.value=!1,E}catch(E){P.value=!1,_e.error(await Re(E)),console.error(E)}},listMcpTokens:async()=>{try{const u=await S.internal.getOperation(c.value,$.value,{operation:"mcpList"});u&&Array.isArray(u)&&(f.value=u.map(E=>{const L=w.value.find(h=>h.id===E.fk_user_id);return{...E,isNew:!1,created_display_name:(L==null?void 0:L.display_name)??(L==null?void 0:L.email)??""}}))}catch(u){_e.error(await Re(u)),console.error(u)}},updateMcpToken:async u=>{try{u.loading=!0;const E=await S.internal.postOperation(c.value,$.value,{operation:"mcpUpdate"},{tokenId:u.id});return u.loading=!1,_e.success(y("msg.success.mcpTokenUpdated")),E}catch(E){_e.error(await Re(E)),u.loading=!1,console.error(E)}},deleteMcpToken:async u=>{if(!(!$.value||!c.value))try{const E=f.value.find(h=>h.id===u.id);E&&(E.loading=!0),await S.internal.postOperation(c.value,$.value,{operation:"mcpDelete"},{tokenId:u.id})?(f.value=f.value.filter(h=>h.id!==u.id),_e.success(y("msg.success.mcpTokenDeleted"))):(E&&(E.loading=!1),_e.error(y("msg.error.failedToDeleteMcpToken")))}catch(E){const L=f.value.find(h=>h.id===u.id);L&&(L.loading=!1),_e.error(await Re(E)),console.error("Error deleting MCP token:",E)}},isUnsavedMCPTokenPending:p,cancelNewMcpToken:()=>{f.value=f.value.filter(u=>!u.isNew)},addNewMcpToken:()=>{var u,E,L,h;x.value=`MCP - ${((u=o.value)==null?void 0:u.display_name)??((h=(L=(E=o.value)==null?void 0:E.email)==null?void 0:L.split("@"))==null?void 0:h[0])} - ${ds().format("D MMMM YYYY, h:mm A")}`,f.value=[{title:x.value,isNew:!0},...f.value]},isCreatingMcpToken:P,newMcpTokenTitle:x}}),lu={class:"flex flex-row items-center py-2 px-3 bg-gray-50 rounded-lg text-gray-700"},iu={class:"capitalize text-ellipsis overflow-hidden font-bold select-none w-full pl-3",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},cu=ce({__name:"Delete",props:{modelValue:{type:Boolean},mcpToken:{}},emits:["update:modelValue","deleted"],setup(S,{emit:o}){const y=S,g=o,{mcpToken:c}=y,$=Ge(y,"modelValue",g),{deleteMcpToken:I}=Cs();async function w(){if(c.id)try{await I(c),$.value=!1,g("deleted")}catch(f){_e.error(await Re(f))}}return(f,x)=>{const P=ln;return a(),N(P,{visible:e($),"onUpdate:visible":x[0]||(x[0]=p=>le($)?$.value=p:null),"entity-name":f.$t("labels.mcpToken"),"on-delete":w},{"entity-preview":n(()=>[t("div",lu,[t("div",iu,[t("span",null,m(e(c).title),1)])])]),_:1},8,["visible","entity-name"])}}}),ru=Object.assign(cu,{__name:"DlgMCPDelete"}),du={class:"nc-mcp-code-tab-wrapper h-80 flex flex-col mt-2"},uu={class:"flex h-9 bg-gray-50 border-b-1 border-nc-border-gray-medium rounded-t-lg items-center px-3"},pu={class:"flex items-center gap-2 text-small leading-[18px] min-w-80px justify-center"},_u={class:"h-full w-full flex flex-col justify-center items-center mt-28"},mu=ce({__name:"Code",props:{code:{}},setup(S){const y=pt(S,"code"),g=fa(ba,{style:{fontSize:"2rem"},spin:!0}),{t:c}=rt(),{copy:$}=As(),I=z(!1),w=async()=>{try{await $(y.value),_e.info(c("msg.info.copiedToClipboard")),I.value=!0,setTimeout(()=>{I.value=!1},5e3)}catch(f){_e.error(f.message)}};return(f,x)=>{const P=ke,p=We,i=Ka,r=Ws;return a(),M("div",du,[t("div",uu,[x[0]||(x[0]=t("div",{class:"flex-1 text-nc-content-gray leading-5"},"JSON",-1)),s(p,{type:"text",size:"small",class:"!hover:bg-gray-200",onClick:w},{default:n(()=>[t("div",pu,[s(P,{icon:e(I)?"circleCheck":"copy",class:ue(["h-4 w-4",{"text-gray-700":!e(I),"text-green-700":e(I)}])},null,8,["icon","class"]),V(" "+m(e(I)?f.$t("general.copied"):f.$t("general.copy")),1)])]),_:1})]),(a(),N(ya,null,{fallback:n(()=>[t("div",_u,[s(r,{size:"large",indicator:e(g)},null,8,["indicator"])])]),default:n(()=>[s(i,{class:"h-72 !rounded-b-lg overflow-hidden !bg-gray-50","model-value":e(y),"read-only":!0,lang:"json",validate:!1,"disable-deep-compare":!0,"monaco-config":{minimap:{enabled:!1},fontSize:13,lineHeight:18,padding:{top:12,bottom:12},overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,lineDecorationsWidth:12,lineNumbersMinChars:0,roundedSelection:!1,selectOnLineNumbers:!1,scrollBeyondLastLine:!1,contextmenu:!1,glyphMargin:!1,folding:!1,bracketPairColorization:{enabled:!1},wordWrap:"on",scrollbar:{horizontal:"hidden",verticalScrollbarSize:6},renderIndentGuides:!1,wrappingStrategy:"advanced",renderLineHighlight:"none",tabSize:2,detectIndentation:!1,insertSpaces:!0,lineNumbers:"off"},"hide-minimap":""},null,8,["model-value"])]),_:1}))])}}}),vu=Object.assign(mu,{__name:"DashboardSettingsBaseMCPCode"}),fu={class:"flex w-full items-center p-2 justify-between"},bu={class:"flex items-center gap-3 pl-1 flex-1"},yu={class:"text-gray-900 truncate font-semibold text-xl"},gu={class:"flex justify-end items-center gap-3 pr-0.5 flex-1"},hu={class:"flex bg-white rounded-b-2xl h-[calc(100%_-_66px)]"},xu={ref:"containerElem",class:"h-full flex-1 flex flex-col overflow-y-auto scroll-smooth nc-scrollbar-thin px-24 py-6 mx-auto"},wu={class:"flex flex-col max-w-[640px] w-full mx-auto gap-3"},ku={class:"text-nc-content-gray font-bold leading-6"},$u={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Su={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Cu={class:"relative flex flex-col leading-6 text-nc-content-gray-subtle2 gap-3 my-3"},Iu={class:"h-full bg-gray-50 border-l-1 w-80 p-5 rounded-br-2xl border-gray-200"},Tu={class:"w-full flex flex-col gap-3"},Du={class:"text-sm text-gray-700 font-semibold !my-0"},Mu={class:"h-7 w-7 flex items-center justify-center"},Ou=ce({__name:"Modal",props:{value:{type:Boolean},token:{}},emits:["close","update:value","update:token"],setup(S,{emit:o}){const y=S,g=o,c=Ge(y,"value"),{appInfo:$}=wt(),{openedProject:I}=ve(tt()),w=Ge(y,"token"),f=[{title:"Getting with MCP Server",href:"https://docs.nocodb.com/automation/webhook/create-webhook/"},{title:"Setting up MCP Server with Claude",href:"https://docs.nocodb.com/automation/webhook/webhook-overview"},{title:"Setting up MCP Server with Cursor",href:"https://docs.nocodb.com/automation/webhook/create-webhook#webhook-with-custom-payload-"},{title:"Setting up MCP Server with Windsurf",href:"https://docs.nocodb.com/automation/webhook/create-webhook#webhook-with-conditions"}],{updateMcpToken:x}=Cs(),P=async()=>{const _=await x(w.value);_&&(w.value=_)},p=()=>{g("close"),c.value=!1},i=z("claude"),r=ee(()=>{var _,l;return`
{
  "mcpServers": {
    "NocoDB Base - ${(_=I.value)==null?void 0:_.title}": {
      "command": "npx",
      "args": [
        "mcp-remote",
        "${$.value.ncSiteUrl}/mcp/${w.value.id}",
        "--header",
        "xc-mcp-token: ${((l=w.value)==null?void 0:l.token)??"xxxxxxxxxxxxxxxxxxxxxxxxxxx"}"
      ]
    }
  }
}
`});return(_,l)=>{const T=ke,k=We,u=vu,E=ws,L=Ks,h=bs,O=tn,U=At;return a(),N(U,{visible:e(c),"onUpdate:visible":l[4]||(l[4]=D=>le(c)?c.value=D:null),"show-separator":!0,size:"large","wrap-class-name":"nc-modal-mcp-token-create-edit"},{header:n(()=>[t("div",fu,[t("div",bu,[s(T,{class:"text-gray-900 h-5 w-5",icon:"mcp"}),t("span",yu,m(e(w).title),1)]),t("div",gu,[s(k,{type:"text",size:"small","data-testid":"nc-close-webhook-modal",onClick:Ye(p,["stop"])},{default:n(()=>[s(T,{icon:"close"})]),_:1})])])]),default:n(()=>[t("div",hu,[t("div",xu,[t("div",wu,[t("div",ku,m(_.$t("labels.mcpSetup")),1),s(L,{"active-key":e(i),"onUpdate:activeKey":l[3]||(l[3]=D=>le(i)?i.value=D:null)},{default:n(()=>[s(E,{key:"claude",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="claude","text-gray-700":e(i)!=="claude"},"text-sm"])}," Claude ",2)]),default:n(()=>[t("div",$u,[l[5]||(l[5]=V(" Get started with the NocoDB MCP with Claude Desktop in 3 simple steps ")),l[6]||(l[6]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Navigate to Claude Desktop settings from the navigation bar."),t("li",null,"Go to the Develop Tab, and click on “Edit Config”."),t("li",null,"Add the JSON configuration that’s provided after creating a token in claude_desktop_config.json")],-1)),s(k,{type:"secondary",class:"w-39",size:"small",loading:e(w).loading,onClick:l[0]||(l[0]=D=>P(e(w)))},{default:n(()=>[V(m(_.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),(a(),N(u,{key:e(r),code:e(r)},null,8,["code"]))])]),_:1}),s(E,{key:"cursor",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="cursor","text-gray-700":e(i)!=="cursor"},"text-sm"])}," Cursor ",2)]),default:n(()=>[t("div",Su,[l[7]||(l[7]=V(" Get started with the NocoDB MCP with Cursor in 3 simple steps ")),l[8]||(l[8]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Open Cursor Settings (press Shift+Cmd+J)"),t("li",null,'Select the "MCP" tab and click "Add MCP Server" .'),t("li",null,"Add the JSON configuration that’s provided after creating a token.")],-1)),s(k,{type:"secondary",class:"w-44",size:"small",loading:e(w).loading,onClick:l[1]||(l[1]=D=>P(e(w)))},{default:n(()=>[V(m(_.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),(a(),N(u,{key:e(r),code:e(r)},null,8,["code"]))])]),_:1}),s(E,{key:"windsurf",class:"!h-full"},{tab:n(()=>[t("span",{class:ue([{"text-brand-500 font-medium":e(i)==="windsurf","text-gray-700":e(i)!=="windsurf"},"text-sm"])}," Windsurf ",2)]),default:n(()=>[t("div",Cu,[l[9]||(l[9]=V(" Get started with the NocoDB MCP with Windsurf in 4 simple steps ")),l[10]||(l[10]=t("ol",{class:"list-decimal pl-5"},[t("li",null,"Access Windsurf settings and Select Cascade Tab in the left sidebar"),t("li",null,"Click on Add Server."),t("li",null,"Now click on Add Custom Server in the modal."),t("li",null,"Paste the JSON configuration that’s provided after creating a token in the opened file")],-1)),s(k,{type:"secondary",class:"w-44",size:"small",loading:e(w).loading,onClick:l[2]||(l[2]=D=>P(e(w)))},{default:n(()=>[V(m(_.$t("labels.regenerateToken")),1)]),_:1},8,["loading"]),s(u,{code:e(r)},null,8,["code"])])]),_:1})]),_:1},8,["active-key"])]),s(h,{type:"info",class:"mt-3 max-w-[640px] w-full mx-auto"},{message:n(()=>[V(m(_.$t("labels.mcpTokenVisibilityInfo")),1)]),description:n(()=>[V(m(_.$t("labels.mcpTokenVisibilityInfoDescription"))+" ",1),l[11]||(l[11]=t("br",null,null,-1)),V(" "+m(_.$t("labels.mcpTokenVisibilityInfoDescription2")),1)]),_:1})],512),t("div",Iu,[t("div",Tu,[t("h2",Du,m(_.$t("labels.supportDocs")),1),t("div",null,[(a(),M(pe,null,Be(f,(D,K)=>t("div",{key:K,class:"flex items-center gap-1"},[t("div",Mu,[s(T,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),s(O,{href:D.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-500 text-sm !no-underline !hover:underline"},{default:n(()=>[V(m(D.title),1)]),_:2},1032,["href"])])),64))])])])])]),_:1},8,["visible"])}}}),Pu=Object.assign(Ou,{__name:"DashboardSettingsBaseMCPModal"}),Nu={key:0,class:"absolute w-full h-full inset-0 flex items-center justify-center z-90 bg-black/12"},ju={key:0,style:{"box-shadow":"0px 8px 8px -4px rgba(0, 0, 0, 0.04), 0px 20px 24px -4px rgba(0, 0, 0, 0.1)"},class:"bg-white p-6 flex flex-col w-[488px] rounded-2xl"},Eu={class:"text-nc-content-gray-emphasis text-lg font-bold"},Bu={class:"text-nc-gray-subtle2 mt-2"},Au={class:"w-full flex justify-between items-center gap-3 mt-5"},Uu={class:"flex flex-col w-full"},Ru={class:"text-nc-content-gray-emphasis font-semibold text-lg"},Lu={class:"text-nc-content-gray-subtle2 mt-2 leading-5"},Fu={class:"flex items-center mt-6 gap-5"},zu={class:"text-[10px] leading-[14px] uppercase font-semibold pt-1 text-gray-300"},Vu={class:"mt-1 text-[13px]"},Gu={class:"text-[10px] leading-[14px] uppercase font-semibold mt-2 text-gray-300"},Wu={class:"mt-1 pb-1 text-[13px]"},Ku={key:0,class:"text-nc-content-gray-subtle"},qu={key:1},Yu={class:"flex gap-2"},Qu=ce({__name:"index",setup(S){const{t:o}=rt(),{sorts:y,sortDirection:g,loadSorts:c,handleGetSortedData:$,saveOrUpdate:I}=an("Webhook"),w=ee({get:()=>g.value,set:b=>{if(Object.keys(b).length===0){I({});return}const q=Object.entries(b);if(q.length>0){const[se,C]=q[0];I({field:se,direction:C})}}}),{mcpTokens:f,createMcpToken:x,listMcpTokens:P,cancelNewMcpToken:p,isUnsavedMCPTokenPending:i,addNewMcpToken:r,isCreatingMcpToken:_,newMcpTokenTitle:l,updateMcpToken:T}=Cs(),k=ee(()=>$(f.value,y.value)),u=[{key:"name",title:o("general.name"),name:"Token",minWidth:397,padding:"12px 24px",showOrderBy:!0,dataIndex:"title"},{key:"created_at",title:o("labels.createdOn"),width:150,minWidth:180,showOrderBy:!0,dataIndex:"created_at"},{key:"action",title:o("general.action"),width:162,minWidth:162,justify:"justify-end",align:"center"}];Je(async()=>{c(),await P()});const E=z(!1),L=z(null),h=b=>{b.isNew||(L.value=b,E.value=!0)},O=async b=>{const q=await x(b);q&&h(q)},U=async b=>{const q=await T(b);q&&h(q)},D=async()=>{L.value=null,E.value=!1,await P()},K=b=>{const q=z(!0),{close:se}=bt(ru,{modelValue:q,mcpToken:b,"onUpdate:modelValue":C,onDeleted:async()=>{C(),await P()}});function C(){q.value=!1,se(1e3)}},B=(b,q)=>ds(b).format(q);return(b,q)=>{const se=Qt,C=We,oe=Xe,Z=ft,Y=ke,G=es,v=Xt,H=ts,ne=ks,j=nn,d=Pu;return a(),M(pe,null,[e(_)?(a(),M("div",Nu,[e(_)?(a(),M("div",ju,[t("div",Eu,m(b.$t("labels.creatingMCPToken")),1),t("div",Bu,m(b.$t("labels.creatingTokenDescription")),1),t("div",Au,[s(se,{size:"xlarge"})])])):A("",!0)])):A("",!0),t("div",Uu,[t("div",Ru,m(b.$t("labels.modelContextProtocol")),1),t("div",Lu,m(b.$t("labels.mcpSubText")),1),t("div",Fu,[s(C,{disabled:e(i),type:"secondary","data-testid":"add-new-mcp-token",size:"small",onClick:e(r)},{default:n(()=>[V(m(b.$t("labels.newMCPEndpoint")),1)]),_:1},8,["disabled","onClick"])]),s(j,{"order-by":e(w),"onUpdate:orderBy":q[3]||(q[3]=R=>le(w)?w.value=R:null),columns:u,"header-row-height":"44px","row-height":"44px",data:e(k),class:"h-full mt-5","body-row-class-name":"nc-base-settings-mcp-token-item group no-border-last",onRowClick:h},{bodyCell:n(({column:R,record:J})=>[R.key==="name"?(a(),M(pe,{key:0},[J.isNew?(a(),N(Z,{key:1,value:e(l),"onUpdate:value":q[0]||(q[0]=re=>le(l)?l.value=re:null),class:"new-token-title",placeholder:"Token name"},null,8,["value"])):(a(),N(oe,{key:0,class:"truncate text-gray-800 font-semibold text-sm"},{title:n(()=>[t("div",zu,m(b.$t("labels.createdOn")),1),t("div",Vu,m(e(ds)(J.created_at).format("D MMMM YYYY, hh:mm A")),1),t("div",Gu,m(b.$t("labels.createdBy")),1),t("div",Wu,m(J.created_display_name),1)]),default:n(()=>[V(m(J.title)+" ",1)]),_:2},1024))],64)):A("",!0),R.key==="created_at"?(a(),M(pe,{key:1},[!J.isNew&&J.created_at?(a(),M("div",Ku,m(B(J.created_at,"D MMM YYYY")),1)):A("",!0)],64)):A("",!0),R.key==="action"?(a(),M(pe,{key:2},[J.isNew?(a(),M("div",qu,[t("div",Yu,[s(C,{"data-testid":"cancel-token-btn",type:"secondary",size:"small",onClick:q[2]||(q[2]=Ye(re=>e(p)(),["stop"]))},{default:n(()=>[V(m(b.$t("general.cancel")),1)]),_:1}),s(C,{"data-testid":"create-token-btn",type:"primary",size:"small",onClick:Ye(re=>O(J),["stop"])},{default:n(()=>[V(m(b.$t("general.save")),1)]),_:2},1032,["onClick"])])])):(a(),N(ne,{key:0},{overlay:n(()=>[s(H,{variant:"small"},{default:n(()=>[s(G,{onClick:re=>U(J)},{default:n(()=>[s(Y,{icon:"refresh"}),V(" "+m(b.$t("labels.regenerateToken")),1)]),_:2},1032,["onClick"]),s(v),s(G,{class:"!text-nc-content-red-dark !hover:bg-nc-bg-red-light",onClick:re=>K(J)},{default:n(()=>[s(Y,{icon:"ncTrash2"}),V(" "+m(b.$t("labels.deleteToken")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[s(C,{type:"secondary",class:"!hidden !group-hover:block",size:"small",onClick:q[1]||(q[1]=Ye(()=>{},["stop"]))},{default:n(()=>[s(Y,{icon:"threeDotVertical"})]),_:1})]),_:2},1024))],64)):A("",!0)]),_:1},8,["order-by","data"]),e(E)?(a(),N(d,{key:0,visible:e(E),"onUpdate:visible":q[4]||(q[4]=R=>le(E)?E.value=R:null),token:e(L),"onUpdate:token":q[5]||(q[5]=R=>le(L)?L.value=R:null),onClose:D},null,8,["visible","token"])):A("",!0)])],64)}}}),Hu=Object.assign(xe(Qu,[["__scopeId","data-v-53247eeb"]]),{__name:"DashboardSettingsBaseMCP"}),Ju={class:"w-full flex p-6 nc-base-settings overflow-auto nc-scrollbar-thin gap-8"},Zu={class:"flex flex-col"},Xu={class:"h-full flex flex-col gap-1 w-60"},ep={class:"flex flex-col flex-1 max-w-[760px]"},tp=ce({__name:"index",setup(S){const{isUIAllowed:o}=dt(),y=ee(()=>at),g=ee(()=>at),c=ee(()=>o("baseMiscSettings")&&o("migrateBase")),$=Ht(),I=["baseType","snapshots","visibility","mcp","migrate"],w=z(y.value?"baseType":g.value?"snapshots":"visibility"),{isFeatureEnabled:f}=qt(),x=ee(()=>o("baseMiscSettings")&&f(Ot.MODEL_CONTEXT_PROTOCOL)),P=(p,i=!0)=>{!g.value&&p==="snapshots"||!y.value&&p==="baseType"||!c.value&&p==="migrate"||(i&&$.push({query:{...$.currentRoute.value.query,tab:p}}),w.value=p)};return Je(()=>{const p=$.currentRoute.value.query;p&&p.tab&&I.includes(p.tab)&&P(p.tab)}),Oe(()=>$.currentRoute.value.query.tab,p=>{p&&I.includes(p)&&p!==w.value&&P(p,!1)}),(p,i)=>{const r=ke,_=Pd,l=Ed,T=Xd,k=ou,u=Hu;return a(),M("div",Ju,[t("div",Zu,[t("div",Xu,[e(y)?(a(),M("div",{key:0,"data-testid":"base-access-tab",class:ue([{"active-menu":e(w)==="baseType"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),onClick:i[0]||(i[0]=E=>P("baseType"))},[s(r,{icon:"ncUsers"}),t("span",null,m(p.$t("general.baseType")),1)],2)):A("",!0),e(g)?(a(),M("div",{key:1,"data-testid":"snapshots-tab",class:ue([{"active-menu":e(w)==="snapshots"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),onClick:i[1]||(i[1]=E=>P("snapshots"))},[s(r,{icon:"camera"}),t("span",null,m(p.$t("general.snapshots")),1)],2)):A("",!0),e(o)("baseMiscSettings")?(a(),M("div",{key:2,class:ue([{"active-menu":e(w)==="visibility"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"visibility-tab",onClick:i[2]||(i[2]=E=>P("visibility"))},[s(r,{icon:"ncEye"}),t("span",null,m(p.$t("labels.visibilityAndDataHandling")),1)],2)):A("",!0),e(x)?(a(),M("div",{key:3,class:ue([{"active-menu":e(w)==="mcp"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"mcp-tab",onClick:i[3]||(i[3]=E=>P("mcp"))},[s(r,{icon:"mcp"}),t("span",null,m(p.$t("labels.modelContextProtocol")),1)],2)):A("",!0),e(c)?(a(),M("div",{key:4,class:ue([{"active-menu":e(w)==="migrate"},"gap-3 hover:bg-gray-100 transition-all text-nc-content-gray flex rounded-lg items-center cursor-pointer py-1.5 px-3"]),"data-testid":"migrate-tab",onClick:i[4]||(i[4]=E=>P("migrate"))},[s(r,{icon:"move"}),i[5]||(i[5]=t("span",null," Migrate ",-1))],2)):A("",!0)])]),t("div",ep,[e(w)==="baseType"?(a(),N(_,{key:0})):A("",!0),e(w)==="snapshots"?(a(),N(l,{key:1})):A("",!0),e(w)==="visibility"?(a(),N(T,{key:2})):A("",!0),e(w)==="migrate"?(a(),N(k,{key:3})):A("",!0),e(w)==="mcp"?(a(),N(u,{key:4})):A("",!0)])])}}}),sp=Object.assign(xe(tp,[["__scopeId","data-v-2e3317ee"]]),{__name:"DashboardSettingsBase"}),np=ot(()=>lt(()=>import("./yDDL5Hsj.js"),__vite__mapDeps([71,1,2,72]),import.meta.url).then(S=>S.default||S)),ap={class:"h-full nc-base-view"},op={class:"flex-1 flex flex-row items-center gap-x-3"},lp={key:0,class:"flex flex-row items-center h-full gap-x-2 px-2"},ip={class:"truncate"},cp={key:1,class:"flex nc-base-view-tab",style:{height:"calc(100% - var(--topbar-height))"}},rp={class:"tab-title","data-testid":"proj-view-tab__overview"},dp={class:"tab-title","data-testid":"proj-view-tab__access-settings"},up={class:"tab-title","data-testid":"proj-view-tab__permissions"},pp={class:"tab-title","data-testid":"proj-view-tab__data-sources"},_p={class:"tab-title","data-testid":"proj-view-tab__syncs"},mp={class:"tab-title","data-testid":"proj-view-tab__base-settings"},vp=ce({__name:"View",props:{baseId:{},tab:{},showEmptySkeleton:{type:Boolean}},setup(S){const o=S,{hideSidebar:y,isNewSidebarEnabled:g}=ve(cn()),{integrations:c}=Oa(),$=tt(),{openedProject:I,activeProjectId:w,basesUser:f,bases:x}=ve($),{activeTable:P}=ve(gs()),{activeWorkspace:p}=ve(xt()),{isSharedBase:i,isPrivateBase:r}=ve(Qe()),{$e:_,$api:l}=Ae(),{blockTableAndFieldPermissions:T,showUpgradeToUseTableAndFieldPermissions:k}=Et(),u=Ls(async()=>{let v;return o.baseId?(v=x.value.get(o.baseId),v||(v=await l.base.read(o.baseId))):v=I.value,v}),E=Bt(Rs,z(!1)),h=Ht().currentRoute,{isUIAllowed:O,baseRoles:U,isBaseRolesLoaded:D}=dt(),{base:K}=ve(Qe()),{projectPageTab:B}=ve(ss()),{isMobileMode:b}=wt(),q=z(""),se=ee(()=>{var v,H,ne;if(!((v=K.value)!=null&&v.default_role&&!U.value[et.OWNER]))return w.value?(ne=(H=f.value.get(w.value))==null?void 0:H.filter(j=>!(j!=null&&j.deleted)))==null?void 0:ne.length:0}),{isTableAndFieldPermissionsEnabled:C}=qa(),{isFeatureEnabled:oe}=qt(),Z=ee(()=>O("projectOverviewTab")),Y=ee({get(){return B.value},set(v){v==="permissions"&&k()||(B.value=v)}});Oe(()=>{var v;return(v=h.value.query)==null?void 0:v.page},async(v,H)=>{if("baseId"in h.value.params&&(await ht(()=>D.value).toBeTruthy(),!h.value.params.viewId)){if(v&&v!==H){v==="syncs"?Y.value="syncs":v==="data-source"?Y.value="data-source":v==="overview"&&Z.value?Y.value="overview":v==="permissions"&&!T.value&&at||(v==="base-settings"?Y.value="base-settings":Y.value="collaborator");return}E.value||!Z.value?Y.value="collaborator":Y.value="overview"}},{immediate:!0});const{navigateToProjectPage:G}=Qe();return Oe(Y,()=>{_(`a:project:view:tab-change:${Y.value}`),G({page:Y.value})}),Oe(()=>{var v,H;return[(v=u.value)==null?void 0:v.id,(H=u.value)==null?void 0:H.title]},()=>{var v,H,ne;(v=P.value)!=null&&v.title||ga(`${((H=u.value)==null?void 0:H.title)??((ne=p.value)==null?void 0:ne.title)??"NocoDB"}`)},{immediate:!0}),Oe(()=>{var v;return(v=u.value)==null?void 0:v.id},()=>{c.value=[]}),Je(async()=>{await ht(()=>{var v;return!!((v=u.value)!=null&&v.id)}).toBeTruthy(),o.tab&&(Y.value=o.tab)}),Je(()=>{y.value=!1}),(v,H)=>{var st,nt;const ne=$a,j=xa,d=Xe,R=ke,J=$s,re=Sa,Ie=np,$e=tl,ye=ws,Le=Dl,Ee=Ol,Pe=oc,Fe=Dd,ge=sp,ze=wa;return a(),M("div",ap,[e(E)?A("",!0):(a(),M("div",{key:0,class:ue(["flex flex-row px-2 py-2 gap-3 justify-between w-full border-b-1 border-gray-200",{"nc-table-toolbar-mobile":e(b),"h-[var(--topbar-height)]":!e(b)}])},[t("div",op,[s(ne),v.showEmptySkeleton?A("",!0):(a(),M("div",lp,[s(j,{color:("parseProp"in v?v.parseProp:e(ha))((st=e(u))==null?void 0:st.meta).iconColor,type:(nt=e(u))==null?void 0:nt.type},null,8,["color","type"]),s(d,{class:"flex font-bold text-sm capitalize truncate max-w-150 text-gray-800","show-on-truncate-only":""},{title:n(()=>{var W;return[V(m((W=e(u))==null?void 0:W.title),1)]}),default:n(()=>{var W;return[t("span",ip,m((W=e(u))==null?void 0:W.title),1)]}),_:1}),e(r)?(a(),N(J,{key:0,size:"xs",class:"!text-bodySm !bg-nc-bg-gray-medium !text-nc-content-gray-subtle2",color:"grey",border:!1},{default:n(()=>[s(R,{icon:"ncLock",class:"w-3.5 h-3.5 mr-1"}),V(" "+m(v.$t("general.private")),1)]),_:1})):A("",!0)]))]),v.showEmptySkeleton?A("",!0):(a(),M(pe,{key:0},[!e(i)&&!e(g)?(a(),N(re,{key:0})):A("",!0),s(Ie)],64))],2)),v.showEmptySkeleton?A("",!0):(a(),M("div",cp,[s(ze,{"active-key":e(Y),"onUpdate:activeKey":H[3]||(H[3]=W=>le(Y)?Y.value=W:null),class:"w-full"},{leftExtra:n(()=>H[4]||(H[4]=[t("div",{class:"w-3"},null,-1)])),default:n(()=>[!e(E)&&e(Z)?(a(),N(ye,{key:"overview",class:"nc-project-overview-tab-content"},{tab:n(()=>[t("div",rp,[s(R,{icon:"ncMultiCircle"}),t("div",null,m(v.$t("general.overview")),1)])]),default:n(()=>[s($e)]),_:1})):A("",!0),e(O)("newUser",{roles:e(U)})&&!e(i)?(a(),N(ye,{key:"collaborator"},{tab:n(()=>[t("div",dp,[s(R,{icon:"users"}),t("div",null,m(v.$t("labels.members")),1),e(se)?(a(),M("div",{key:0,class:ue(["tab-info",{"bg-primary-selected":e(Y)==="collaborator","bg-gray-50":e(Y)!=="collaborator"}])},m(e(se)),3)):A("",!0)])]),default:n(()=>{var W;return[s(Le,{"base-id":(W=e(u))==null?void 0:W.id},null,8,["base-id"])]}),_:1})):A("",!0),("isEeUI"in v?v.isEeUI:e(at))&&e(O)("sourceCreate")&&e(K).id&&e(C)?(a(),N(ye,{key:"permissions"},{tab:n(()=>[t("div",up,[s(R,{icon:"ncLock"}),t("div",null,m(v.$t("general.permissions")),1)])]),default:n(()=>[s(Ee,{state:e(q),"onUpdate:state":H[0]||(H[0]=W=>le(q)?q.value=W:null),"base-id":e(K).id},null,8,["state","base-id"])]),_:1})):A("",!0),e(O)("sourceCreate")&&e(K).id?(a(),N(ye,{key:"data-source"},{tab:n(()=>{var W;return[t("div",pp,[s(R,{icon:"ncDatabase"}),t("div",null,m(v.$t("labels.dataSources")),1),(W=e(K).sources)!=null&&W.length?(a(),M("div",{key:0,class:ue(["tab-info",{"bg-primary-selected":e(Y)==="data-source","bg-gray-50":e(Y)!=="data-source"}])},m(e(K).sources.length),3)):A("",!0)])]}),default:n(()=>[s(Pe,{state:e(q),"onUpdate:state":H[1]||(H[1]=W=>le(q)?q.value=W:null),"base-id":e(K).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):A("",!0),e(oe)(("FEATURE_FLAG"in v?v.FEATURE_FLAG:e(Ot)).SYNC)&&e(O)("sourceCreate")&&e(K).id?(a(),N(ye,{key:"syncs"},{tab:n(()=>[t("div",_p,[s(R,{icon:"ncZap"}),H[5]||(H[5]=t("div",null,"Syncs",-1))])]),default:n(()=>[s(Fe,{state:e(q),"onUpdate:state":H[2]||(H[2]=W=>le(q)?q.value=W:null),"base-id":e(K).id,class:"max-h-full"},null,8,["state","base-id"])]),_:1})):A("",!0),!e(i)&&(e(O)("baseMiscSettings")||e(oe)(("FEATURE_FLAG"in v?v.FEATURE_FLAG:e(Ot)).MODEL_CONTEXT_PROTOCOL))?(a(),N(ye,{key:"base-settings"},{tab:n(()=>[t("div",mp,[s(R,{icon:"ncSettings"}),t("div",null,m(v.$t("activity.settings")),1)])]),default:n(()=>[s(ge,{"base-id":e(K).id,class:"max-h-full"},null,8,["base-id"])]),_:1})):A("",!0)]),_:1},8,["active-key"])]))])}}}),fp=Object.assign(xe(vp,[["__scopeId","data-v-773fcb3d"]]),{__name:"ProjectView"}),bp=ce({__name:"index",setup(S){const y=Ht().currentRoute,g=Qe(),{base:c,sources:$,isSharedBase:I}=ve(g),w=gs(),{openTable:f}=w,{activeTables:x}=ve(w),{isNewSidebarEnabled:P}=ve(cn()),{isMobileMode:p}=wt(),{files:i,reset:r}=ka(),{$e:_}=Ae(),{isUIAllowed:l}=dt(),T=["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel.sheet.macroenabled.12","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.spreadsheet-template","text/csv","application/json","text/json"];Oe(i,D=>D&&k(D),{flush:"post"});function k(D){if(!D)return;const K=Array.from(D).map(B=>B);u(K)}function u(D){if(!D)return;if(D.length>1)return _e.error({content:"Only one file can be imported at a time.",duration:2});let K=null;const B=T.some(b=>{const q=D[0].type===b;if(q){const se=D[0].name.split(".").pop();K=se==="csv"||se==="json"?se:"excel"}return q});if(!B)return _e.error({content:"Invalid file type",duration:2});K&&B&&E(K,D[0])}function E(D,K){var C,oe,Z,Y,G;if(!((C=c.value)!=null&&C.id))return;_(`a:actions:import-${D}`);const B=z(!0),{close:b,vNode:q}=bt(js,{modelValue:B,importType:D,"onUpdate:modelValue":se,baseId:c.value.id,sourceId:(oe=$.value)==null?void 0:oe.filter(v=>v.enabled)[0].id});(G=(Y=(Z=q.value)==null?void 0:Z.component)==null?void 0:Y.exposed)==null||G.handleChange({file:{uid:`${D}-${K.name}-${Math.random().toString(36).substring(2)}`,name:K.name,type:K.type,status:"done",fileName:K.name,lastModified:K.lastModified,size:K.size,originFileObj:K},event:{percent:100}});function se(){B.value=!1,b(1e3),r()}}const L=ee(()=>I.value||p.value),h=z(!0),O=ee(()=>x.value.length===0||!!y.value.query.page||l("projectOverviewTab")||!P.value),U=()=>{h.value&&ct(()=>{h.value=!1})};return Oe([()=>I.value,()=>x.value.length,()=>l("projectOverviewTab"),()=>y.value.query.page],([D,K,B,b])=>{var q;if(!K||!((q=x.value[0])!=null&&q.base_id)||!P.value){U();return}if(!D&&(b||B)){U();return}f(x.value[0],!0)},{immediate:!0,flush:"pre"}),(D,K)=>{const B=fp;return e(L)?A("",!0):(a(),N(B,{key:0,"show-empty-skeleton":!e(O)||e(h)},null,8,["show-empty-skeleton"]))}}}),Jp=Object.freeze(Object.defineProperty({__proto__:null,default:bp},Symbol.toStringTag,{value:"Module"}));export{dl as _,Ul as a,Vl as b,Jp as i,ul as u};
