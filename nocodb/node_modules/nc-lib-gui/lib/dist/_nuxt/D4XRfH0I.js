import{e as q,R as z,av as D,G as K,r as S,mH as Q,S as J,n as C,aC as d,jn as I,aj as _,aD as W,fU as w,j as X,f$ as Z,g0 as ee,f_ as te,ha as ae,hb as le,I as O,o as h,w as m,c as se,an as oe,aq as ne,L as y,eO as ie,b as A,ap as re,a as F,K as ue,aT as E,ag as de,d as V,t as N,b9 as me,P as ce,bB as pe}from"./DOFFjK0_.js";import{u as fe}from"./B3Wp9c04.js";import"./SJHyi9T4.js";const ve={class:"flex items-center w-full justify-between gap-2"},_e={class:"flex gap-1.5 flex-1 items-center truncate h-full"},we=q({__name:"FieldListAutoCompleteDropdown",props:{modelValue:{},isSort:{type:Boolean},columns:{},allowEmpty:{type:Boolean},meta:{},disableSmartsheet:{type:Boolean}},emits:["update:modelValue"],setup(c,{emit:R}){var k,M;const T=z(c,["modelValue","isSort","allowEmpty","disableSmartsheet"]),j=R,P=D(T,"columns"),p=D(T,"meta"),G=K(Q,S({})),{metas:H}=J(),i=C({get:()=>c.modelValue,set:a=>j("update:modelValue",a)}),{showSystemFields:x,fieldsMap:n,isLocalMode:B}=c.disableSmartsheet?{showSystemFields:S(!1),fieldsMap:S({}),isLocalMode:S(!1)}:fe(),L=C(()=>{var a,s,l,o,r;return(r=(o=((a=P.value)==null?void 0:a.filter(e=>{var t;return!(B.value&&(e!=null&&e.id)&&n.value[e.id]&&(!((t=n.value[e.id])!=null&&t.initialShow)||!x.value&&d(e))||d(e)&&I(e,p.value))}))||((l=(s=p.value)==null?void 0:s.columns)==null?void 0:l.filter(e=>{var t;return B.value&&(e!=null&&e.id)&&n.value[e.id]&&(!((t=n.value[e.id])!=null&&t.initialShow)||!x.value&&d(e))?!1:e.uidt===_.Links?!0:d(e)?I(e,p.value)?!1:i.value===e.id||x.value:e.uidt===_.QrCode||e.uidt===_.Barcode||e.uidt===_.ID||e.uidt===_.Button?!1:c.isSort?!(W(e)&&e.colOptions.type!==w.BELONGS_TO):!(e.colOptions&&e.system)})))==null?void 0:o.sort((e,t)=>{var v,g;let u=0,f=0,b=0;return d(e)&&(u=1),d(t)&&(f=1),e!=null&&e.id&&(t!=null&&t.id)&&((v=n.value[e.id])==null?void 0:v.order)!==void 0&&((g=n.value[t.id])==null?void 0:g.order)!==void 0&&(b=n.value[e.id].order-n.value[t.id].order),u-f||b}))==null?void 0:r.map(e=>({value:e.id,label:G.value[e.id]||e.title,icon:X(te(e)?Z:ee,{columnMeta:e}),ncItemDisabled:e.ncItemDisabled,ncItemTooltip:e.ncItemTooltip,c:e}))}),U=(a,s)=>{var l;return(l=s.label.toLowerCase())==null?void 0:l.includes(a.toLowerCase())};!i.value&&c.allowEmpty!==!0&&(i.value=((M=(k=L.value)==null?void 0:k[0])==null?void 0:M.value)||"");const Y={[w.BELONGS_TO]:"text-blue-500",[w.ONE_TO_ONE]:"text-purple-500",[w.HAS_MANY]:"text-orange-500",[w.MANY_TO_MANY]:"text-pink-500"},$=C(()=>{var a,s;return((s=(a=p.value)==null?void 0:a.columns)==null?void 0:s.reduce((l,o)=>{var r,e,t,u;if(o&&ae(o)||le(o)){const f=(t=(e=(r=H.value)==null?void 0:r[p.value.id])==null?void 0:e.columns)==null?void 0:t.find(b=>{var v;return b.id===((v=o.colOptions)==null?void 0:v.fk_relation_column_id)});f&&(l[o.id]=Y[(u=f.colOptions)==null?void 0:u.type])}return l},{}))||{}});return(a,s)=>{const l=re,o=ie,r=pe;return h(),O(r,{value:y(i),"onUpdate:value":s[0]||(s[0]=e=>ce(i)?i.value=e:null),"dropdown-match-select-width":!1,"show-search":"",placeholder:a.$t("placeholder.selectField"),"filter-option":U,"dropdown-class-name":"nc-dropdown-toolbar-field-list"},{default:m(()=>[(h(!0),se(oe,null,ne(y(L),e=>(h(),O(o,{key:e.value,label:e.label,value:e.value,disabled:e.ncItemDisabled},{default:m(()=>[A(l,{disabled:!e.ncItemDisabled,placement:"right",class:"w-full max-w-50"},{title:m(()=>[V(N(e.ncItemTooltip),1)]),default:m(()=>[F("div",ve,[F("div",_e,[(h(),O(E(e.icon),{class:de(["!w-3.5 !h-3.5 !mx-0",y($)[e.value]||"!text-gray-500"])},null,8,["class"])),A(l,{style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},class:"field-selection-tooltip-wrapper truncate select-none","show-on-truncate-only":""},{title:m(()=>[V(N(e.label),1)]),default:m(()=>[V(" "+N(e.label),1)]),_:2},1024)]),y(i)===e.value?(h(),O(E(("iconMap"in a?a.iconMap:y(me)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4"})):ue("",!0)])]),_:2},1032,["disabled"])]),_:2},1032,["label","value","disabled"]))),128))]),_:1},8,["value","placeholder"])}}}),Se=Object.assign(we,{__name:"SmartsheetToolbarFieldListAutoCompleteDropdown"});export{Se as default};
