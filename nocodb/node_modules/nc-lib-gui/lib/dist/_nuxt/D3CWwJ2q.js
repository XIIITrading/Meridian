const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DOFFjK0_.js","./entry.DDfSYhWa.css","./DRQrXP7Q.js","./D2QgEzTv.js","./PlainCell.CJha1QXQ.css","./CKBjCvZA.js","./CQugZrqw.js","./index._6B72PDH.css","./DBe8bXbT.js","./BmeEgVC9.js","./RecordCard.pwDI-3DF.css","./0c4tmWST.js","./DG2ZEhLK.js","./SJHyi9T4.js","./4PLl4EP6.js","./DcFNOSET.js","./boyBAVNN.js","./D1gZ4Fpg.js","./Bo7kLdUR.js","./BYGCxle3.js","./B3Wp9c04.js","./C1uRXLg7.js","./DGuB8RA-.js","./D_wq2ltS.js","./Item.C85DUSg3.css","./9aYOtC5C.js","./index.CotXCNy2.css","./DunK-51v.js","./DivDataCell.D_9SDUsb.css","./ps5He39s.js","./CHgOe2F-.js","./MSgi_m6o.js","./JKos0pQW.js","./BdLxRlCP.js","./YaKnxhzO.js","./Markdown.CUPXKfeQ.css","./CNJqPN7Y.js","./AxsiR11P.js","./C9H3ht2d.js","./Comments.BKDN6dt-.css","./CkXo2doe.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./Czlq_f4Y.js","./Cgx2iu1G.js","./C6nWwNvX.js","./Cell.Dgtcn0F2.css","./DiUleKVo.js","./JUJEmhCv.js","./Modal.CB1oWLel.css","./BrfakvRE.js","./CJtI8BMq.js","./Bgc5K1P7.js","./D4c215jk.js","./lL-0_K96.js","./BClTqpVB.js","./CYkscC4Z.js","./DEAKw9Pl.js","./Cl-qOJW6.js","./BNo10Mdm.js","./index.C8L8AhJa.css","./CtJu2gHc.js","./MNXVOE4I.js","./LockView.BWC8JyQk.css","./CMyFGii6.js","./qgYlKlk5.js","./Cb5B9eG-.js","./C_qz9woQ.js","./DA4KItu_.js","./D8wgK-Ih.js","./HdsRe6lq.js","./index.N-A1gxk9.css","./DzBSAsxR.js","./FilterInput.7KjqjE1F.css","./4fFkR2QG.js","./Pagination.XVPzwtel.css","./CAfhvBOi.js","./BcKPINb2.js","./VirtualCell.6f0pX0MN.css","./D0vnHTOx.js","./BRTCxTHu.js","./DDEVLD8O.js","./-rIuSlCu.js","./SpSJ8E4d.js","./Dh5zKH8k.js","./ColumnMenu.DQG9Y5_N.css","./CiBV2ZED.js","./ZNRZafJ9.js","./BhfICdUA.js","./NRjd0XWG.js","./RfUK_fd6.js","./SelectOptions.DqNkMQ-A.css","./hehmy6V1.js","./BvG7Iv4q.js","./CyXz1Zkk.js","./CPChVVVr.js","./CFXGfO_A.js","./VKUQM8lk.js","./BqWeTF94.js","./sgaWLnOz.js","./BpgQOThx.js","./DmoodaOn.js","./B3tDgntu.js","./Db9kSA7A.js","./EditOrAddProvider.C2farLzy.css","./B4YnCsMc.js","./6zXueAcs.js","./Byuk3M83.js","./D-8_fbld.js","./DminWhpq.js","./index.Bp-YHGEB.css"])))=>i.map(i=>d[i]);
import{e as ut,f as ct,r as Y,as as mt,G as Ae,aZ as ft,n as fe,fv as vt,gl as wt,o6 as Ne,ac as pt,c as b,K as J,L as t,o as f,a as F,an as W,aq as ae,t as re,ag as Z,I as U,aj as G,w as E,b as oe,O as _t,aT as He,b9 as Fe,d as yt,aS as we,aG as gt,cf as ht,cg as kt,ad as Mt,N as Dt,cn as zt,aw as xt,aV as bt,aW as pe,_ as St}from"./DOFFjK0_.js";import{_ as Rt}from"./D_wq2ltS.js";import{_ as Yt}from"./9aYOtC5C.js";import{_ as Et}from"./DGuB8RA-.js";import{i as We,e as ve}from"./D2QgEzTv.js";import{a as Tt}from"./6Zptevrc.js";import{u as Ct}from"./DG2ZEhLK.js";import{u as It}from"./B3Wp9c04.js";import"./SJHyi9T4.js";import"./C1uRXLg7.js";import"./boyBAVNN.js";const Ot=we(()=>pe(()=>import("./DOFFjK0_.js").then(D=>D.oS),__vite__mapDeps([0,1]),import.meta.url).then(D=>D.default||D)),Lt=we(()=>pe(()=>import("./DRQrXP7Q.js"),__vite__mapDeps([2,0,1,3,4]),import.meta.url).then(D=>D.default||D)),Vt=we(()=>pe(()=>import("./CKBjCvZA.js"),__vite__mapDeps([5,0,1,6,7,8]),import.meta.url).then(D=>D.default||D)),Pt=we(()=>pe(()=>import("./BmeEgVC9.js"),__vite__mapDeps([9,0,1,8,10]),import.meta.url).then(D=>D.default||D)),jt=we(()=>pe(()=>import("./0c4tmWST.js").then(D=>D.R),__vite__mapDeps([11,0,1,12,13,14,3,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,6,7,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110]),import.meta.url).then(D=>D.default||D)),Bt={key:0,class:"h-full prevent-select relative","data-testid":"nc-calendar-month-view"},$t=["onClick","onDblclick"],At={key:0,class:"flex justify-between p-1"},Nt={class:"flex items-center gap-1"},Ht={class:"ml-1"},Ft={key:1,class:"leading-3 text-[13px] p-3"},Wt={class:"text-xs px-1"},Ut={class:"bg-nc-background-default px-4 gap-3 flex flex-col py-4 max-h-70 overflow-y-auto"},Xt={key:1,class:"text-gray-500"},Zt={class:"absolute inset-0 z-2 pointer-events-none mt-8 pb-7.5","data-testid":"nc-calendar-month-record-container"},Gt=["data-testid","data-unique-id","onMouseover","onMousedown"],qt={class:"text-xs font-medium text-gray-400"},Jt=ut({__name:"MonthView",emits:["newRecord","expandRecord"],setup(D,{emit:Ue}){const ie=Ue,{selectedDate:_e,selectedMonth:Te,formattedData:K,formattedSideBarData:Ce,calDataType:ye,sideBarFilterOption:Xe,displayField:de,calendarRange:A,viewMetaProperties:Ze,showSideMenu:Ge,updateRowProperty:De,updateFormat:ue,timezoneDayjs:s,isSyncedFromColumn:ze}=Tt(),{isSyncedTable:qe}=Ct(),{$e:Ie}=ct(),xe=Y(!0),{isUIAllowed:N}=mt(),ne=Ae(ft,Y()),P=fe(()=>{var a;return(a=Ze.value)!=null&&a.hide_weekend?5:7}),Je=fe(()=>{let a=[];return xe.value?a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]:a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P.value===5&&(a=a.filter(l=>l!=="Sat"&&l!=="Sun")),a}),ge=Y(),{width:Ke,height:Qe}=vt(ge),q=Y(null),T=Y(null),ce=Y(!1),le=Y(!1),z=Y(null),be=Y(),Se=Y(),he=Y(null),ke=Y(),k=Y(null),et=Ae(wt,Y()),{fields:tt}=It(),Re=fe(()=>(tt.value??[]).reduce((a,l)=>(a[l.fk_column_id]={bold:!!l.bold,italic:!!l.italic,underline:!!l.underline},a),{})),p=fe(()=>{const a=s.timezonize(Te.value.startOf("month")),l=xe.value?0:-1,d=s.timezonize(a.startOf("week")).add(l,"day"),y=s.timezonize(),R=a.daysInMonth(),u=a.day(),O=xe.value?u===0?6:u-1:u,C=Math.ceil((R+O)/7);return{weeks:Array.from({length:C},(j,g)=>({weekIndex:g,days:Array.from({length:7},(h,i)=>{const v=d.add(g*7+i,"day");return{date:v,key:`${g}-${i}`,isWeekend:v.get("day")===0||v.get("day")===6,isToday:v.isSame(y,"date"),isInPagedMonth:v.isSame(Te.value,"month"),isVisible:P.value===5?v.get("day")!==0&&v.get("day")!==6:!0,dayNumber:v.format("DD")}})})),gridClass:{"grid-cols-7":P.value===7,"grid-cols-5":P.value===5,grid:!0,grow:!0}}}),me=fe(()=>{if(!p.value||!A.value)return{records:[],count:{}};const a=Ke.value/P.value,l=Qe.value/p.value.weeks.length,d=28,y=27,R=Math.floor((l-y)/(d+8)),u={},O=(g,h=1)=>{var v;u[g]||(u[g]={overflow:!1,count:0,overflowCount:0,lanes:[],overflowRecords:[]});const{lanes:i}=u[g];for(let e=0;e<R;e++)if(!i[e]){let o=!0;for(let m=0;m<h;m++){const _=s.dayjsTz(g).add(m,"day").format("YYYY-MM-DD");if((v=u[_])!=null&&v.lanes[e]){o=!1;break}}if(o)return e}return-1},C=(g,h,i=1)=>{for(let v=0;v<i;v++){const e=s.dayjsTz(g).add(v,"day").format("YYYY-MM-DD");u[e]||(u[e]={overflow:!1,count:0,overflowCount:0,lanes:[],overflowRecords:[]}),u[e].lanes[h]=!0,u[e].count++}},j=[];return A.value.forEach(g=>{const h=g.fk_from_col,i=g.fk_to_col;[...K.value].filter(e=>{if(h&&i){const o=e.row[h.title]?s.timezonize(e.row[h.title]):null,m=e.row[i.title]?s.timezonize(e.row[i.title]):null;return o&&m&&!m.isBefore(o)}else if(h&&!i)return!!(e.row[h.title]?s.timezonize(e.row[h.title]):null);return!1}).sort((e,o)=>{const m=s.timezonize(e.row[h.title]),_=i?s.timezonize(e.row[i.title]):m,M=s.timezonize(o.row[h.title]);return(i?s.timezonize(o.row[i.title]):M).diff(M)-_.diff(m)}).forEach(e=>{var o,m,_,M,c;if(!i&&h){const n=s.timezonize(e.row[h.title]),r=n.format("YYYY-MM-DD"),w=e.rowMeta.id??Ne(),I=O(r);if(I===-1){u[r].overflow=!0,u[r].overflowCount++,e.rowMeta.id=w,e.rowMeta.range=g,u[r].overflowRecords.push(e);return}C(r,I);const B=p.value.weeks.findIndex(H=>H.days.some(ee=>ee.date.isSame(n,"day"))),x=(o=p.value.weeks[B])==null?void 0:o.days.findIndex(H=>H.date.isSame(n,"day")),S=w===T.value||w===((m=k.value)==null?void 0:m.rowMeta.id),$={left:`${x*a}px`,width:`${a}px`,top:S?`${B*l}px`:`${B*l+(y+I*(d+4))}px`};S&&($.zIndex="100",$.display="block"),P.value===5&&(x===5||x===6)&&!S&&($.display="none"),j.push({...e,rowMeta:{...e.rowMeta,style:$,maxSpanning:1,position:"rounded",range:g,id:w}})}else if(h&&i){let n=s.timezonize(e.row[h.title]);const r=s.timezonize(e.row[i.title]);let w=n.startOf("week");n.isBefore(w)&&(n=p.value.weeks[0].days[0].date);const I=e.rowMeta.id??Ne();let B=0;for(;w.isSameOrBefore(r,"day")&&w.isBefore(p.value.weeks[p.value.weeks.length-1].days[6].date);){let x=w.endOf("week");P.value===5&&(x=x.subtract(2,"day"));const S=w.isBefore(n)?n:w,$=x.isAfter(r)?r:x;if(P.value===5&&[0,6].includes(n.day())){w=s.timezonize(w.add(1,"week"));continue}if($.isBefore(p.value.weeks[0].days[0].date)){w=s.timezonize(w.add(1,"week"));continue}const H=$.diff(S,"day")+1,ee=S.format("YYYY-MM-DD"),L=O(ee,H);if(L===-1){e.rowMeta.id=I,e.rowMeta.range=g;for(let X=0;X<H;X++){const se=S.add(X,"day").format("YYYY-MM-DD");u[se]&&(u[se].overflow=!0,u[se].overflowCount++,u[se].overflowRecords.push(e))}w=w.add(1,"week");continue}C(ee,L,H);const V=p.value.weeks.findIndex(X=>X.days.some(se=>se.date.isSame(S,"day"))),Ee=(_=p.value.weeks[V])==null?void 0:_.days.findIndex(X=>X.date.isSame(S,"day")),je=(M=p.value.weeks[V])==null?void 0:M.days.findIndex(X=>X.date.isSame($,"day")),Be=I===T.value||I===((c=k.value)==null?void 0:c.rowMeta.id),$e={left:`${Ee*a-.5}px`,width:`${(je-Ee+1)*a}px`,top:Be?`${V*l+d}px`:`${V*l+(y+L*(d+4))}px`};Be&&($e.zIndex="100");let te="rounded";const dt=p.value.weeks[V-1]?p.value.weeks[V-1].days[0].date.isBefore(S,"month"):!1;n.isSame(w,"week")&&r.isSame(x,"week")&&r.isSameOrBefore(x)?te="rounded":n.isSame(S,"week")?dt&&r.isSame(x,"week")?te="rounded":te="leftRounded":r.isSame(x,"week")?te="rightRounded":te="none",j.push({...e,rowMeta:{...e.rowMeta,position:te,style:$e,range:g,maxSpanning:je-Ee+1,id:I,recordIndex:B}}),B++,w=s.timezonize(w.add(1,"week"))}}})}),{records:j,count:u}}),Me=Y({x:null,y:null}),Ye=(a,l,d)=>{var w,I,B,x,S,$,H,ee;const{top:y,height:R,width:u,left:O}=ge.value.getBoundingClientRect();let C=a.clientX-O;Me.value.x&&(C-=Me.value.x);const j=a.clientY-y,g=Math.max(0,Math.min(1,C/u)),h=Math.max(0,Math.min(1,j/R)),i=(I=(w=z.value)==null?void 0:w.rowMeta.range)==null?void 0:I.fk_from_col,v=(x=(B=z.value)==null?void 0:B.rowMeta.range)==null?void 0:x.fk_to_col;if(!i)return{newRow:null,updateProperty:[]};const e=Math.floor(h*p.value.weeks.length),o=Math.floor(g*P.value);let m=p.value.weeks[e]?p.value.weeks[e].days[o].date:null;if(!m)return{newRow:null,updateProperty:[]};let _=s.timezonize(z.value.row[i.title]);_.isValid()||(_=s.dayjsTz()),m=m.add(_.hour(),"hour").add(_.minute(),"minute").add(_.second(),"second");let M;const c={...z.value,row:{...(S=z.value)==null?void 0:S.row,[i.title]:s.dayjsTz(m).format(ue.value)}},n=[i.title];if(v){const L=($=z.value)!=null&&$.row[i.title]?s.timezonize(z.value.row[i.title]):null,V=(H=z.value)!=null&&H.row[v.title]?s.timezonize((ee=z.value)==null?void 0:ee.row[v.title]):null;L&&V?M=s.dayjsTz(m).add(V.diff(L,"day"),"day"):L&&!V||!L&&V?M=s.dayjsTz(m).endOf("day"):M=m.clone(),c.row[v.title]=s.dayjsTz(M).format(ue.value),n.push(v.title)}if(z.value.row[i.title]===c.row[i.title]&&!d)return{newRow:null,updatedProperty:[]};if(!c)return{newRow:null,updateProperty:[]};const r=ve(c.row,ne.value.columns);return c.rowMeta.id=T==null?void 0:T.value,l?(K.value=[...K.value,c],Ce.value=Ce.value.filter(L=>ve(L.row,ne.value.columns)!==r)):K.value=K.value.map(L=>ve(L.row,ne.value.columns)===r?c:L),{newRow:c,updateProperty:n}},Oe=a=>{!N("dataEdit")||!z.value||Ye(a,!1)},at=bt((a,l,d)=>{De(a,l,d)},500),Le=a=>{var _,M;if(!N("dataEdit")||!k.value)return;const{top:l,height:d,width:y,left:R}=ge.value.getBoundingClientRect(),u=(a.clientY-l-window.scrollY)/d,O=(a.clientX-R-window.scrollX)/y,C=k.value.row[k.value.rowMeta.range.fk_to_col.title],j=k.value.row[k.value.rowMeta.range.fk_from_col.title],g=(_=k.value.rowMeta.range)==null?void 0:_.fk_from_col,h=(M=k.value.rowMeta.range)==null?void 0:M.fk_to_col,i=Math.floor(u*p.value.weeks.length),v=Math.floor(O*P.value);let e=[],o;if(ke.value==="right"){let c=p.value.weeks[i]?p.value.weeks[i].days[v].date.endOf("day"):null;if(e=[h.title],s.dayjsTz(c).isBefore(j)&&(c=s.dayjsTz(j).clone().endOf("day")),!c)return;o={...k.value,row:{...k.value.row,[h.title]:s.dayjsTz(c).format(ue.value)}}}else{let c=p.value.weeks[i]?p.value.weeks[i].days[v].date:null;if(e=[g.title],s.dayjsTz(c).isAfter(C)&&(c=s.dayjsTz(C).clone()),!c)return;o={...k.value,row:{...k.value.row,[g.title]:s.dayjsTz(c).format(ue.value)}}}o.rowMeta.id=k.value.rowMeta.id;const m=ve(o.row,ne.value.columns);K.value=K.value.map(c=>ve(c.row,ne.value.columns)===m?o:c),o&&at(o,e,!1)},Ve=()=>{ce.value=!1,ke.value=void 0,k.value=null,document.removeEventListener("mousemove",Le),document.removeEventListener("mouseup",Ve)},ot=(a,l,d)=>{var y;!N("dataEdit")||T.value||(y=d.rowMeta.range)!=null&&y.is_readonly||(ce.value=!0,ke.value=a,k.value=d,document.addEventListener("mousemove",Le),document.addEventListener("mouseup",Ve))},Pe=a=>{var y;if(clearTimeout(Se.value),!N("dataEdit")||!z.value||!le.value||(y=z.value.rowMeta.range)!=null&&y.is_readonly)return;a.preventDefault(),q.value.style.boxShadow="none";const{newRow:l,updateProperty:d}=Ye(a,!1,!0);q.value&&(q.value.style.boxShadow="none",le.value=!1,T.value=null,q.value=null),z.value=null,De(l,d,!1),he.value=null,Me.value={x:null,y:null},Ie("c:calendar:month:drag-record"),document.removeEventListener("mousemove",Oe),document.removeEventListener("mouseup",Pe)},nt=(a,l)=>{if(ce.value||!l.rowMeta.id||ze.value)return;let d=a.target;le.value=!1,Se.value=setTimeout(()=>{var R,u;if(N("dataEdit")&&!((R=l.rowMeta.range)!=null&&R.is_readonly)){for(le.value=!0;!d.classList.contains("draggable-record");)d=d.parentElement;le.value=!0,q.value=d,T.value=l.rowMeta.id,z.value=l,Me.value={x:((u=z.value)==null?void 0:u.rowMeta.maxSpanning)>1?a.clientX-d.getBoundingClientRect().left:0,y:a.clientY},document.addEventListener("mousemove",Oe),document.addEventListener("mouseup",Pe)}},500);const y=()=>{clearTimeout(Se.value),document.removeEventListener("mouseup",y),le.value||ie("expandRecord",l)};document.addEventListener("mouseup",y)},lt=a=>{var d,y;if(!N("dataEdit"))return;a.preventDefault();const l=(d=a.dataTransfer)==null?void 0:d.getData("text/plain");if(l){const{record:R,isWithoutDates:u}=JSON.parse(l);if((y=R.rowMeta.range)!=null&&y.is_readonly)return;z.value=R;const{newRow:O,updateProperty:C}=Ye(a,u);q.value&&(q.value.style.boxShadow="none",q.value=null),De(O,C,!1),Ie("c:calendar:day:drag-record")}},st=a=>{z.value=null,T.value=null,k.value=null,ce.value=!1,ke.value=void 0,he.value=null,_e.value=a},rt=a=>{Xe.value="selectedDate",_e.value=a,Ge.value=!0},Q=a=>_e.value?s.dayjsTz(a).isSame(_e.value,"day"):!1,it=a=>{if(!N("dataEdit")||!A.value||qe.value)return;const l=A.value[0].fk_from_col;if(!l)return;const d={row:{[l.title]:a.format(ue.value)}};ie("newRecord",d)};return(a,l)=>{const d=_t,y=Rt,R=Ot,u=Yt,O=gt,C=Et,j=Lt,g=Vt,h=Pt,i=jt,v=pt("e");return t(A)?(f(),b("div",Bt,[F("div",{class:Z(["grid",{"grid-cols-7":t(P)===7,"grid-cols-5":t(P)===5}])},[(f(!0),b(W,null,ae(t(Je),(e,o)=>(f(),b("div",{key:o,class:"text-center bg-gray-50 py-1 border-r-1 last:border-r-0 border-gray-100 font-semibold leading-4 uppercase text-[10px] text-gray-500"},re(e),1))),128))],2),F("div",{ref_key:"calendarGridContainer",ref:ge,class:Z([{"grid-rows-5":t(p).weeks.length===5,"grid-rows-6":t(p).weeks.length===6,"grid-rows-7":t(p).weeks.length===7},"grid"]),style:{height:"calc(100% - 1.59rem)"},onDrop:lt},[(f(!0),b(W,null,ae(t(p).weeks,e=>(f(),b("div",{key:e.weekIndex,class:Z(t(p).gridClass),"data-testid":"nc-calendar-month-week"},[(f(!0),b(W,null,ae(e.days,(o,m)=>{var _,M,c;return f(),b(W,null,[o.isVisible?(f(),b("div",{key:o.key,class:Z([{"selected-date":Q(o.date)||t(he)&&o.date.isSame(t(he),"day"),"!text-gray-400":!o.isInPagedMonth,"!bg-gray-50 !hover:bg-gray-100 !border-gray-200":o.isWeekend,"!border-r-gray-200":(_=e.days[m+1])==null?void 0:_.isWeekend,"border-t-1":e.weekIndex===0},"text-right relative group last:border-r-0 transition text-sm h-full border-r-1 border-b-1 border-gray-100 font-medium hover:bg-gray-50 text-gray-800 bg-white"]),"data-testid":"nc-calendar-month-day",onClick:n=>st(o.date),onDblclick:n=>it(o.date)},[t(N)("dataEdit")?(f(),b("div",At,[F("span",{class:Z({"block group-hover:hidden":!Q(o.date)&&[t(G).DateTime,t(G).Date].includes(t(ye)),hidden:Q(o.date)&&[t(G).DateTime,t(G).Date].includes(t(ye))})},null,2),t(A).length>1&&!t(ze)?(f(),U(O,{key:0,"auto-close":""},{overlay:E(()=>[oe(u,{class:"w-64"},{default:E(()=>[oe(y,null,{default:E(()=>l[1]||(l[1]=[yt(" Select date field to add ")])),_:1,__:[1]}),(f(!0),b(W,null,ae(t(A),(n,r)=>(f(),U(y,{key:r,class:"text-gray-800 font-semibold text-sm",onClick:()=>{const w={row:{[n.fk_from_col.title]:o.date.format("YYYY-MM-DD HH:mm:ssZ"),...n.fk_to_col?{[n.fk_to_col.title]:o.date.endOf("day").format("YYYY-MM-DD HH:mm:ssZ")}:{}}};ie("newRecord",w)}},{default:E(()=>[F("div",Nt,[oe(R,{"column-meta":n.fk_from_col},null,8,["column-meta"]),F("span",Ht,re(n.fk_from_col.title),1)])]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),default:E(()=>[oe(d,{class:Z([{"!block":Q(o.date),"!hidden":!Q(o.date)},"!group-hover:block rounded"]),size:"small",type:"secondary"},{default:E(()=>[(f(),U(He(("iconMap"in a?a.iconMap:t(Fe)).plus),{class:"h-4 w-4"}))]),_:2},1032,["class"])]),_:2},1024)):[t(G).DateTime,t(G).Date].includes(t(ye))&&!t(ze)?(f(),U(C,{key:1,entity:t(kt).TABLE,"entity-id":(M=t(ne))==null?void 0:M.id,permission:t(ht).TABLE_RECORD_ADD},{default:E(({isAllowed:n})=>[oe(d,{class:Z([{"!block":Q(o.date),"!hidden":!Q(o.date)},"!group-hover:block !w-6 !h-6 !rounded"]),size:"xsmall",type:"secondary",disabled:!n,onClick:()=>{const r={row:{[t(A)[0].fk_from_col.title]:o.date.format("YYYY-MM-DD HH:mm:ssZ"),...t(A)[0].fk_to_col?{[t(A)[0].fk_to_col.title]:o.date.endOf("day").format("YYYY-MM-DD HH:mm:ssZ")}:{}}};ie("newRecord",r)}},{default:E(()=>[(f(),U(He(("iconMap"in a?a.iconMap:t(Fe)).plus)))]),_:2},1032,["class","disabled","onClick"])]),_:2},1032,["entity","entity-id","permission"])):J("",!0),F("span",{class:Z([{"bg-brand-50 text-brand-500 !font-bold":o.isToday},"px-1.3 py-1 text-[13px] text-sm leading-3 font-medium rounded-lg"])},re(o.dayNumber),3)])):J("",!0),t(N)("dataEdit")?J("",!0):(f(),b("div",Ft,re(o.dayNumber),1)),t(me).count[o.date.format("YYYY-MM-DD")]&&((c=t(me).count[o.date.format("YYYY-MM-DD")])!=null&&c.overflow)&&!t(T)?(f(),U(O,{key:2},{overlay:E(()=>{var n;return[F("div",Ut,[(f(!0),b(W,null,ae((n=t(me).count[o.date.format("YYYY-MM-DD")])==null?void 0:n.overflowRecords,(r,w)=>{var I,B,x;return f(),U(g,{key:w,draggable:!1,class:"w-64","from-date":t(s).timezonize(r.row[r.rowMeta.range.fk_from_col.title]).format("D MMM • h:mm A"),invalid:!1,row:r,"to-date":(x=(B=(I=r==null?void 0:r.rowMeta)==null?void 0:I.range)==null?void 0:B.fk_to_col)!=null&&x.title&&r.row[r.rowMeta.range.fk_to_col.title]?t(s).timezonize(r.row[r.rowMeta.range.fk_to_col.title]).format("DD MMM • HH:mm A"):null,"data-testid":"nc-sidebar-record-card",onClick:S=>ie("expandRecord",r)},{default:E(()=>[("isRowEmpty"in a?a.isRowEmpty:t(We))(r,t(de))?(f(),b("span",Xt," - ")):(f(),U(j,{key:0,modelValue:r.row[t(de).title],"onUpdate:modelValue":S=>r.row[t(de).title]=S,column:t(de)},null,8,["modelValue","onUpdate:modelValue","column"]))]),_:2},1032,["from-date","row","to-date","onClick"])}),128))])]}),default:E(()=>[Mt((f(),U(d,{class:"!absolute bottom-1 right-1 text-center min-w-4.5 mx-auto z-3 text-gray-500",size:"xxsmall",type:"secondary",onClick:n=>rt(o.date)},{default:E(()=>{var n;return[F("span",Wt," + "+re((n=t(me).count[o.date.format("YYYY-MM-DD")])==null?void 0:n.overflowCount),1)]}),_:2},1032,["onClick"])),[[v,"['c:calendar:month-view-more']"]])]),_:2},1024)):J("",!0)],42,$t)):J("",!0)],64)}),256))],2))),128))],34),F("div",Zt,[(f(!0),b(W,null,ae(t(me).records,e=>{var o,m;return f(),b(W,null,[((o=e.rowMeta.style)==null?void 0:o.display)!=="none"?(f(),b("div",{key:e.rowMeta.id,"data-testid":`nc-calendar-month-record-${e.row[t(de).title]}`,"data-unique-id":`${e.rowMeta.id}`,style:zt({...e.rowMeta.style,zIndex:e.rowMeta.id===t(T)?100:0,lineHeight:"18px",opacity:(t(T)===null||e.rowMeta.id===t(T))&&(t(k)===null||e.rowMeta.id===((m=t(k))==null?void 0:m.rowMeta.id))?1:.3}),class:Z([{"cursor-pointer":!t(ce)},"absolute group draggable-record transition pointer-events-auto"]),onMouseleave:l[0]||(l[0]=_=>be.value=null),onMouseover:_=>be.value=e.rowMeta.id,onMousedown:Dt(_=>nt(_,e),["stop"])},[oe(i,{row:e},{default:E(()=>{var _,M,c;return[oe(h,{hover:t(be)===e.rowMeta.id,position:e.rowMeta.position,record:e,dragging:t(T)===e.rowMeta.id||((M=(_=t(k))==null?void 0:_.rowMeta)==null?void 0:M.id)===e.rowMeta.id,resize:!!((c=e.rowMeta.range)!=null&&c.fk_to_col)&&t(N)("dataEdit"),onResizeStart:ot},xt({default:E(()=>[(f(!0),b(W,null,ae(t(et),n=>(f(),b(W,{key:n.id},[("isRowEmpty"in a?a.isRowEmpty:t(We))(e,n)?J("",!0):(f(),U(j,{key:0,modelValue:e.row[n.title],"onUpdate:modelValue":r=>e.row[n.title]=r,class:"text-xs",bold:t(Re)[n.id].bold,column:n,italic:t(Re)[n.id].italic,underline:t(Re)[n.id].underline},null,8,["modelValue","onUpdate:modelValue","bold","column","italic","underline"]))],64))),128))]),_:2},[[t(G).DateTime,t(G).LastModifiedTime,t(G).CreatedTime].includes(t(ye))?{name:"time",fn:E(()=>{var n;return[F("span",qt,re(t(s).timezonize(e.row[(n=e.rowMeta.range)==null?void 0:n.fk_from_col.title]).format("h:mma").slice(0,-1)),1)]}),key:"0"}:void 0]),1032,["hover","position","record","dragging","resize"])]}),_:2},1032,["row"])],46,Gt)):J("",!0)],64)}),256))])])):J("",!0)}}}),da=Object.assign(St(Jt,[["__scopeId","data-v-bc13abed"]]),{__name:"SmartsheetCalendarMonthView"});export{da as default};
