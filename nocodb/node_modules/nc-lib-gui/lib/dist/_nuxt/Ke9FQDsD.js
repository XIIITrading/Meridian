const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DRQrXP7Q.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./D2QgEzTv.js","./PlainCell.CJha1QXQ.css","./CKBjCvZA.js","./CQugZrqw.js","./index._6B72PDH.css","./DBe8bXbT.js","./Bt7C7TGv.js","./VRecordCard.CsyjeVpL.css","./0c4tmWST.js","./DG2ZEhLK.js","./SJHyi9T4.js","./4PLl4EP6.js","./DcFNOSET.js","./boyBAVNN.js","./D1gZ4Fpg.js","./Bo7kLdUR.js","./BYGCxle3.js","./B3Wp9c04.js","./C1uRXLg7.js","./DGuB8RA-.js","./D_wq2ltS.js","./Item.C85DUSg3.css","./9aYOtC5C.js","./index.CotXCNy2.css","./DunK-51v.js","./DivDataCell.D_9SDUsb.css","./ps5He39s.js","./CHgOe2F-.js","./MSgi_m6o.js","./JKos0pQW.js","./BdLxRlCP.js","./YaKnxhzO.js","./Markdown.CUPXKfeQ.css","./CNJqPN7Y.js","./AxsiR11P.js","./C9H3ht2d.js","./Comments.BKDN6dt-.css","./CkXo2doe.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./Czlq_f4Y.js","./Cgx2iu1G.js","./C6nWwNvX.js","./Cell.Dgtcn0F2.css","./DiUleKVo.js","./JUJEmhCv.js","./Modal.CB1oWLel.css","./BrfakvRE.js","./CJtI8BMq.js","./Bgc5K1P7.js","./D4c215jk.js","./lL-0_K96.js","./BClTqpVB.js","./CYkscC4Z.js","./DEAKw9Pl.js","./Cl-qOJW6.js","./BNo10Mdm.js","./index.C8L8AhJa.css","./CtJu2gHc.js","./MNXVOE4I.js","./LockView.BWC8JyQk.css","./CMyFGii6.js","./qgYlKlk5.js","./Cb5B9eG-.js","./C_qz9woQ.js","./DA4KItu_.js","./D8wgK-Ih.js","./HdsRe6lq.js","./index.N-A1gxk9.css","./DzBSAsxR.js","./FilterInput.7KjqjE1F.css","./4fFkR2QG.js","./Pagination.XVPzwtel.css","./CAfhvBOi.js","./BcKPINb2.js","./VirtualCell.6f0pX0MN.css","./D0vnHTOx.js","./BRTCxTHu.js","./DDEVLD8O.js","./-rIuSlCu.js","./SpSJ8E4d.js","./Dh5zKH8k.js","./ColumnMenu.DQG9Y5_N.css","./CiBV2ZED.js","./ZNRZafJ9.js","./BhfICdUA.js","./NRjd0XWG.js","./RfUK_fd6.js","./SelectOptions.DqNkMQ-A.css","./hehmy6V1.js","./BvG7Iv4q.js","./CyXz1Zkk.js","./CPChVVVr.js","./CFXGfO_A.js","./VKUQM8lk.js","./BqWeTF94.js","./sgaWLnOz.js","./BpgQOThx.js","./DmoodaOn.js","./B3tDgntu.js","./Db9kSA7A.js","./EditOrAddProvider.C2farLzy.css","./B4YnCsMc.js","./6zXueAcs.js","./Byuk3M83.js","./D-8_fbld.js","./DminWhpq.js","./index.Bp-YHGEB.css"])))=>i.map(i=>d[i]);
import{e as yt,f as ht,r as L,fv as Mt,G as Ve,cd as xt,as as zt,aZ as bt,gl as kt,n as te,g as Rt,b_ as Dt,bz as Tt,o7 as It,o6 as Ct,cm as Oe,aQ as Xe,ac as St,c as E,o as b,K as me,a as U,L as n,cn as Ge,ag as Q,t as fe,an as W,aq as Z,b as Le,I as we,w as ee,ad as Et,O as Vt,aS as Me,aG as Ot,N as qe,aV as Lt,aW as xe,_ as jt}from"./DOFFjK0_.js";import{_ as Pt}from"./BRnezCyF.js";import{i as Je,e as ve}from"./D2QgEzTv.js";import{a as At}from"./6Zptevrc.js";import{u as Bt}from"./DG2ZEhLK.js";import{u as $t}from"./B3Wp9c04.js";import"./SJHyi9T4.js";import"./C1uRXLg7.js";import"./boyBAVNN.js";const Ht=Me(()=>xe(()=>import("./DRQrXP7Q.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(j=>j.default||j)),Ft=Me(()=>xe(()=>import("./CKBjCvZA.js"),__vite__mapDeps([5,1,2,6,7,8]),import.meta.url).then(j=>j.default||j)),Nt=Me(()=>xe(()=>import("./Bt7C7TGv.js"),__vite__mapDeps([9,1,2,8,10]),import.meta.url).then(j=>j.default||j)),Ut=Me(()=>xe(()=>import("./0c4tmWST.js").then(j=>j.R),__vite__mapDeps([11,1,2,12,13,14,3,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,6,7,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110]),import.meta.url).then(j=>j.default||j)),Yt={class:"flex w-full items-center"},Wt={class:"flex sticky h-6 z-4 top-0 pl-16 bg-gray-50 w-full"},Xt={key:1,class:"sticky top-6 bg-white z-4 inset-x-0 w-full"},Gt=["onDblclick","onClick"],qt={class:"text-xs"},Jt={class:"bg-nc-background-default px-4 gap-3 flex flex-col py-4 max-h-70 overflow-y-auto"},Kt={key:1,class:"text-gray-500"},Qt={class:"absolute pointer-events-none z-2 inset-0 overflow-hidden !mt-5.95","data-testid":"nc-calendar-week-record-container"},Zt=["data-testid","data-unique-id","onMousedown","onMouseover"],eo={class:"text-xs font-medium text-gray-400"},to=yt({__name:"DateTimeField",emits:["expandRecord","newRecord"],setup(j,{emit:Ke}){const ze=Ke,{selectedDateRange:Y,formattedData:X,formattedSideBarData:je,calendarRange:oe,selectedDate:Qe,displayField:ne,viewMetaProperties:Ze,selectedTime:pe,updateRowProperty:be,sideBarFilterOption:et,showSideMenu:tt,updateFormat:ge,timezoneDayjs:s,isSyncedFromColumn:ot}=At(),{isSyncedTable:nt}=Bt(),{$e:Pe}=ht(),B=L(null),q=L(null),{width:_e}=Mt(B),at=Ve(xt,L(!1)),{isUIAllowed:G}=zt(),ae=Ve(bt,L()),rt=Ve(kt,L()),{fields:st}=$t(),ke=te(()=>(st.value??[]).reduce((e,t)=>(e[t.fk_column_id]={bold:!!t.bold,italic:!!t.italic,underline:!!t.underline},e),{})),re=e=>{let t=e.day()-1;return t===-1&&(t=6),t},P=te(()=>{var e;return(e=Ze.value)!=null&&e.hide_weekend?5:7}),se=L(s.dayjsTz()),lt=te(()=>{if(!_e.value)return{top:0,left:0};const e=_e.value/P.value*re(se.value),t=se.value.hour()*60+se.value.minute(),a=52/60*t-12;return{width:`${_e.value/P.value}px`,top:`${a}px`,left:`${e}px`}});Rt(()=>{const e=Dt(()=>{se.value=s.dayjsTz()},1e4);Tt(()=>{clearInterval(e)})});const le=te(()=>{const e=s.timezonize(Y.value.start);return Array.from({length:P.value},(t,a)=>Array.from({length:24},(d,u)=>e.add(a,"day").hour(u).minute(0).second(0)))}),it=(e,t,a)=>{const d=t.hour(),u=a.hour(),l=Math.max((le.value[e]??[]).findIndex(h=>h.hour()===d),0);let w=(le.value[e]??[]).findIndex(h=>h.hour()===u);return a.minute()>0&&u<23&&w++,w=Math.max(w,0),{startHourIndex:l,endHourIndex:w,startMinutes:t.minute(),endMinutes:a.minute()}},ie=It(({startDate:e,endDate:t,scheduleStart:a,scheduleEnd:d})=>(t!=null&&t.isValid()||(t=e.clone().add(15,"minutes")),t.diff(e,"minute")<=60&&(t=e.clone().add(59,"minutes")),e.isBefore(a,"minutes")&&(e=a.clone()),t.isAfter(d,"minutes")&&(t=d.clone()),{startDate:e,endDate:t})),Ae=(e,t=!1)=>{const a=e.hour()*60+e.minute();return t?Math.ceil(a):Math.floor(a)},Be=(e,t)=>({from:Ae(e),to:Ae(t,!0)-1,dayIndex:re(e)}),dt=(e,t)=>{var u,l,w;const{fromDate:a,toDate:d}=t;if(!a||!d)return!1;for(const h of e){const D=(u=h.rowMeta.range)==null?void 0:u.fk_from_col,i=(l=h.rowMeta.range)==null?void 0:l.fk_to_col;if(!D)return!1;const{startDate:m,endDate:g}=ie({startDate:s.timezonize(h.row[D.title]),endDate:i&&((w=Oe(h.row[i.title]))!=null&&w.isValid())?s.timezonize(h.row[i.title]):s.timezonize(h.row[D.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:s.dayjsTz(Y.value.start).startOf("day"),scheduleEnd:s.dayjsTz(Y.value.end).endOf("day")});if(a.isBetween(m,g,null,"[]")||d.isBetween(m,g,null,"[]"))return!1}return!0},ut=({row:e,columnArray:t,graph:a})=>{const d=e.rowMeta.id,u=new Set,l=e.rowMeta.dayIndex,w=t[l].findIndex(m=>m.findIndex(g=>g.rowMeta.id===d)!==-1)+1,h=m=>{u.add(m);let g=1;const R=a.get(m);if(R)for(const T of R){if(g>=t[l].length)return g;u.has(T)||(g=Math.min(Math.max(g,h(T)+1),t[l].length))}return g};let D=1;a.has(d)&&h(d);const i=[];return t[l].flat().filter(m=>u.has(m.rowMeta.id)).forEach(m=>{i.push(m.rowMeta.overLapIteration)}),D=(i==null?void 0:i.length)>0?Math.max(...i):1,{maxOverlaps:D,dayIndex:l,overlapIndex:w}},Re=L(!1),De=L(),Te=L(),ye=L(),$=L(null),de=L(!1),k=L(null),F=te(()=>{if(!X.value||!oe.value||!B.value||!q.value)return{records:[],gridTimeMap:new Map,spanningRecords:[]};const e=_e.value/P.value,t=52,a=s.dayjsTz(Y.value.start).startOf("day");let d=s.dayjsTz(Y.value.end).endOf("day");P.value===5&&(d=d.subtract(2,"day"));const u=[[[]]],l=new Map,w=[],h=[];return oe.value.forEach(D=>{var T,r,I,v,_,c,A,O,z,C;const i=D.fk_from_col,m=D.fk_to_col,g=[...X.value].filter(o=>{if(i&&m){const f=s.timezonize(o.row[i.title]),y=s.timezonize(o.row[m.title]);if(f.isValid()&&y.isValid())return f.isSame(y,"day")?!0:(h.push(o),!1)}return i&&!!o.row[i.title]}).sort((o,f)=>s.timezonize(o.row[i.title]).isBefore(s.timezonize(f.row[i.title]))?1:-1);for(const o of g){const f=o.rowMeta.id??Ct();if(i&&m){const{startDate:y,endDate:x}=ie({startDate:s.timezonize(o.row[i.title]),endDate:s.timezonize(o.row[m.title]),scheduleStart:a,scheduleEnd:d}),M=re(y),{startHourIndex:V,startMinutes:p}=it(M,y,x);let H={};const S=(V+p/60)*t,N=x.diff(y,"minute")/60*t;H={...H,top:`${S}px`,height:`${N}px`},w.push({...o,rowMeta:{...o.rowMeta,id:f,style:H,range:D,position:"rounded",dayIndex:M}})}else if(i){const{startDate:y}=ie({startDate:s.timezonize(o.row[i.title]),endDate:s.timezonize(o.row[i.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d});let x={};const M=re(y),V=(y.minute()/60+y.hour())*t;x={...x,top:`${V+1}px`,height:`${t-2}px`},w.push({...o,rowMeta:{...o.rowMeta,id:f,position:"rounded",style:x,range:D,dayIndex:M}})}}w.sort((o,f)=>{var M,V;const y=(M=o.rowMeta.range)==null?void 0:M.fk_from_col,x=(V=f.rowMeta.range)==null?void 0:V.fk_from_col;return!y||!x?0:s.timezonize(o.row[y.title]).isBefore(s.timezonize(f.row[x.title]))?-1:1});for(const o of w){const f=(T=o.rowMeta.range)==null?void 0:T.fk_from_col,y=(r=o.rowMeta.range)==null?void 0:r.fk_to_col;if(!f)continue;const{startDate:x,endDate:M}=ie({startDate:s.timezonize(o.row[f.title]),endDate:y&&((I=Oe(o.row[y.title]))!=null&&I.isValid())?s.timezonize(o.row[y.title]):s.timezonize(o.row[f.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d}),V=Be(x,M),p=o.rowMeta.dayIndex??V.dayIndex;for(let S=V.from;S<=V.to;S++){l.has(p)||l.set(p,new Map),(v=l.get(p))!=null&&v.has(S)||l.set(p,(l.get(p)??new Map).set(S,{count:0,id:[],overflowRecords:[]}));const he=l.get(p).get(S).id;he.push(o.rowMeta.id);const N=l.get(p).get(S).count+1;l.set(p,(l.get(p)??new Map).set(S,{count:N,id:he,overflowRecords:l.get(p).get(S).overflowRecords}))}let H=!1;u[p]||(u[p]=[]);for(const S in u[p])if(dt(u[p][S],{fromDate:x,toDate:M})){u[p][S].push(o),H=!0;break}H||u[p].push([o])}const R=new Map;for(const o of l.keys()){R.has(o)||R.set(o,new Map);for(const[f,{id:y}]of l.get(o))for(const x of y){R.get(o).has(x)||R.get(o).set(x,new Set);for(const M of y)x!==M&&(R.get(o).get(x).has(M)||R.get(o).get(x).add(M))}}for(const o in u)for(const f in u[o])for(const y of u[o][f])y.rowMeta.overLapIteration=parseInt(f)+1;for(const o of w){const{maxOverlaps:f,overlapIndex:y,dayIndex:x}=ut({row:o,columnArray:u,graph:R.get(o.rowMeta.dayIndex)??new Map}),M=o.rowMeta.dayIndex??x;let V="block";P.value===5&&(M===5||M===6)&&(V="none"),o.rowMeta.numberOfOverlaps=f;let p=0,H=100;const S=M*e;if(o.rowMeta.id===((_=k.value)==null?void 0:_.rowMeta.id)||o.rowMeta.id===((c=$.value)==null?void 0:c.rowMeta.id))H=S+1.5,p=e-3;else if(o.rowMeta.overLapIteration>3){V="none";const N=(A=o.rowMeta.range)==null?void 0:A.fk_from_col,ue=(O=o.rowMeta.range)==null?void 0:O.fk_to_col;if(N){const{startDate:pt,endDate:gt}=ie({startDate:s.timezonize(o.row[N.title]),endDate:ue&&((z=Oe(o.row[ue.title]))!=null&&z.isValid())?s.timezonize(o.row[ue.title]):s.timezonize(o.row[N.title]).add(1,"hour").subtract(1,"minute"),scheduleStart:a,scheduleEnd:d}),We=Be(pt,gt);for(let ce=We.from;ce<=We.to;ce++)if(l.has(M)&&((C=l.get(M))!=null&&C.has(ce))){const Ee=l.get(M).get(ce);Ee.overflowRecords.some(_t=>_t.rowMeta.id===o.rowMeta.id)||(Ee.overflowRecords.push(o),l.get(M).set(ce,Ee))}}}else{const N=e-3;p=Math.max(N/Math.min(f,3),72);const ue=(N-p*Math.min(f,3))/Math.max(Math.min(f,3)-1,1);H=S+1.5+(y-1)*(p+ue),H+p>S+e&&(p=Math.max(S+e-H-1.5,72))}o.rowMeta.style={...o.rowMeta.style,left:`${H}px`,width:`${p}px`,minWidth:"72px",display:V}}}),{records:w,gridTimeMap:l,spanningRecords:h}}),ct=Lt((e,t,a)=>{be(e,t,a)},500),$e=e=>{var C;if(!G("dataEdit")||!B.value||!$.value||!q.value||(C=$.value.rowMeta.range)!=null&&C.is_readonly)return;const{width:t,left:a,top:d,bottom:u}=B.value.getBoundingClientRect(),{scrollHeight:l,scrollTop:w}=B.value;e.clientY>u-20?B.value.scrollTop+=10:e.clientY<d+20&&(B.value.scrollTop-=10);const h=(e.clientX-a-window.scrollX)/t,D=(e.clientY-d+w)/l,{range:i}=$.value.rowMeta,m=i==null?void 0:i.fk_from_col,g=i==null?void 0:i.fk_to_col;if(!(m!=null&&m.title)||!(g!=null&&g.title))return;const R=s.timezonize($.value.row[m.title]),T=s.timezonize($.value.row[g.title]),r=Math.floor(h*P.value),I=Math.round(D*24*60/15)*15,v=s.timezonize(Y.value.start).add(r,"day").add(I,"minute");let _,c,A=!0;if(ye.value==="right"){const o=R.add(1,"hour");_=v.isBefore(R)?R.add(Math.ceil(R.diff(v,"minute")/15)*15,"minute"):v,_.isBefore(o)&&(_=o),c=g.title}else if(ye.value==="left"){const o=T.subtract(1,"hour");_=v.isAfter(T)?T.subtract(Math.ceil(v.diff(T,"minute")/15)*15,"minute"):v,_.isAfter(o)&&(_=o),c=m.title}else A=!1,_=null;if(!A||!(_!=null&&_.isValid()))return;const O={...$.value,row:{...$.value.row,[c]:_.format(ge.value)}},z=ve(O.row,ae.value.columns);X.value=X.value.map(o=>ve(o.row,ae.value.columns)===z?O:o),ct(O,[c],!1)},He=()=>{Re.value=!1,ye.value=null,$.value=null,document.removeEventListener("mousemove",$e),document.removeEventListener("mouseup",He)},mt=(e,t,a)=>{var d;G("dataEdit")&&((d=a.rowMeta.range)!=null&&d.is_readonly||(Re.value=!0,ye.value=e,$.value=a,document.addEventListener("mousemove",$e),document.addEventListener("mouseup",He)))},Ie=(e,t)=>{var A,O;if(!B.value)return{newRow:null,updatedProperty:[]};const{width:a,left:d,top:u}=B.value.getBoundingClientRect(),{scrollHeight:l,scrollTop:w}=B.value,h=(e.clientX-d-window.scrollX)/a,D=(e.clientY-u+w-36.8)/l,i=(A=k.value.rowMeta.range)==null?void 0:A.fk_from_col,m=(O=k.value.rowMeta.range)==null?void 0:O.fk_to_col;if(!i)return{newRow:null,updatedProperty:[]};const g=Math.max(0,Math.min(6,Math.floor(h*P.value))),R=Math.max(0,Math.min(23,Math.floor(D*24))),T=Math.round(D*24*60%60/15)*15,r=s.timezonize(Y.value.start).add(g,"day").add(R,"hour").add(T,"minute");if(!r)return{newRow:null,updatedProperty:[]};let I;const v=[i.title],_={...k.value,row:{...k.value.row,[i.title]:s.dayjsTz(r).format(ge.value)}};if(m){const z=k.value.row[i.title]?s.timezonize(k.value.row[i.title]):null,C=k.value.row[m.title]?s.timezonize(k.value.row[m.title]):z==null?void 0:z.clone();if(z&&C){const o=Math.round(C.diff(z,"minute")/15)*15;I=r.add(o,"minute")}else z&&!C||!z&&C?I=s.dayjsTz(r).endOf("day"):I=r.clone();I.isBefore(r)&&(I=r.clone().add(15,"minutes")),_.row[m.title]=s.dayjsTz(I).format(ge.value),v.push(m.title)}if(!_)return{newRow:null,updatedProperty:[]};const c=ve(_.row,ae.value.columns);return t?(X.value=[...X.value,_],je.value=je.value.filter(z=>ve(z.row,ae.value.columns)!==c)):(X.value=X.value.map(z=>ve(z.row,ae.value.columns)===c?_:z),k.value={...k.value,row:_.row}),{newRow:_,updatedProperty:v}},Fe=e=>{if(!G("dataEdit")||!q.value||!k.value)return;const t=q.value.getBoundingClientRect(),a=20;e.clientY>t.bottom-a?q.value.scrollTop+=20:e.clientY<t.top+a&&(q.value.scrollTop-=20),Ie(e)},Ne=e=>{if(!G("dataEdit")||!de.value||!B.value||!k.value)return;e.preventDefault(),clearTimeout(De.value);const{newRow:t,updatedProperty:a}=Ie(e,!1);t&&be(t,a,!1),k.value=null,Pe("c:calendar:week:drag-record"),document.removeEventListener("mousemove",Fe),document.removeEventListener("mouseup",Ne)},ft=(e,t)=>{if(Re.value||ot.value)return;let a=e.target;de.value=!1,De.value=setTimeout(()=>{var u;if(G("dataEdit")&&!((u=t.rowMeta.range)!=null&&u.is_readonly)){for(de.value=!0;!a.classList.contains("draggable-record");)a=a.parentElement;de.value=!0,k.value=t,document.addEventListener("mousemove",Fe),document.addEventListener("mouseup",Ne)}},200);const d=()=>{clearTimeout(De.value),document.removeEventListener("mouseup",d),de.value||ze("expandRecord",t)};document.addEventListener("mouseup",d)},wt=e=>{var a,d;if(!G("dataEdit")||!B.value)return;e.preventDefault();const t=(a=e.dataTransfer)==null?void 0:a.getData("text/plain");if(t){const{record:u}=JSON.parse(t);if((d=u.rowMeta.range)!=null&&d.is_readonly)return;k.value=u;const{newRow:l,updatedProperty:w}=Ie(e,!0);l&&(be(l,w,!1),Pe("c:calendar:day:drag-record"))}},vt=e=>{et.value="selectedHours",pe.value=e,tt.value=!0},Ce=e=>{var D,i,m;if(!F.value||!F.value.gridTimeMap)return{isOverflow:!1,overflowCount:0,overflowRecords:[]};const{gridTimeMap:t}=F.value,a=re(e),d=e.hour()*60+e.minute(),u=e.hour()*60+e.minute()+59,l=t.get(a),w=[],h=new Set;for(let g=d;g<=u;g++){const R=((D=l==null?void 0:l.get(g))==null?void 0:D.overflowRecords)??[];for(const T of R)h.has((i=T.rowMeta)==null?void 0:i.id)||(w.push(T),h.add((m=T.rowMeta)==null?void 0:m.id))}return{isOverflow:w==null?void 0:w.length,overflowCount:w==null?void 0:w.length,overflowRecords:w}},Ue=e=>{if(!G("dataEdit")||!oe.value||nt.value)return;const t=oe.value[0].fk_from_col;if(!t)return;const a={row:{[t.title]:e.format(ge.value)}};ze("newRecord",a)};Xe(()=>F.value,()=>{var t,a;if(k.value)return;const e=document.querySelectorAll(".draggable-record");e.length?(t=e.item(0))==null||t.scrollIntoView({behavior:"smooth",block:"center"}):(a=document.querySelectorAll(".nc-calendar-day-hour").item(9))==null||a.scrollIntoView({behavior:"smooth",block:"center"})},{immediate:!0});const Ye=e=>{ze("expandRecord",e)},Se=L(null),J=L(!1),K=te(()=>oe.value.some(e=>e.fk_to_col!==null&&e.fk_to_col!==void 0));return Xe(()=>{var e;return(e=Se.value)==null?void 0:e.isSpanningRecordExpanded()},()=>{var e;J.value=(e=Se.value)==null?void 0:e.isSpanningRecordExpanded()}),(e,t)=>{var m,g,R,T;const a=Pt,d=Vt,u=Ht,l=Ft,w=Ot,h=Nt,D=Ut,i=St("e");return b(),E("div",{ref_key:"scrollContainer",ref:q,class:"prevent-select h-[calc(100vh-5.4rem)] overflow-y-auto nc-scrollbar-md relative flex flex-col w-full","data-testid":"nc-calendar-week-view",onDrop:wt},[!n(at)&&n(s).dayjsTz().isBetween(n(Y).start,n(Y).end)?(b(),E("div",{key:0,class:Q(["absolute top-16 ml-16 pointer-events-none z-4",{"!mt-38.5":n(J)&&n(K),"mt-27":!n(J)&&n(K),"!mt-6":!((m=n(F).spanningRecords)!=null&&m.length)}]),style:Ge(n(lt))},[U("div",Yt,[U("span",{class:"text-nc-content-inverted-primary bg-nc-content-brand rounded-md leading-3.5 font-bold text-xs pointer-events-auto p-0.5 cursor-pointer",onClick:t[0]||(t[0]=r=>Ue(n(s).dayjsTz()))},fe(n(se).format("hh:mm A")),1),t[3]||(t[3]=U("div",{class:"flex-1 relative ml-1 nc-calendar-border-line border-b-2 border-brand-500"},null,-1))])],6)):me("",!0),U("div",Wt,[(b(!0),E(W,null,Z(n(le),r=>(b(),E("div",{key:r[0].toISOString(),class:Q([{"text-brand-500":r[0].isSame(n(s).dayjsTz(),"date"),"w-1/5":n(P)===5,"w-1/7":n(P)===7},"text-center text-[10px] font-semibold leading-4 flex items-center justify-center uppercase text-gray-500 w-full py-1 border-gray-200 last:border-r-0 border-b-1 border-l-1 border-r-0 bg-gray-50"])},fe(n(s).dayjsTz(r[0]).format("DD ddd")),3))),128))]),U("div",{class:Q([{"top-20.5":!n(J)&&n(K),"top-32":n(J)&&n(K),"!top-0":!((g=n(F).spanningRecords)!=null&&g.length)},"absolute bg-white w-16 z-1"])},[(b(!0),E(W,null,Z(n(le)[0],(r,I)=>(b(),E("div",{key:I,class:"h-13 first:mt-0 pt-7.1 nc-calendar-day-hour text-right pr-2 font-semibold text-xs text-gray-500 py-1"},fe(r.format("hh a")),1))),128))],2),n(K)&&((R=n(F).spanningRecords)!=null&&R.length)?(b(),E("div",Xt,[Le(a,{ref_key:"spanningRecordsContainer",ref:Se,records:n(F).spanningRecords,onExpandRecord:Ye},null,8,["records"])])):me("",!0),U("div",{ref_key:"container",ref:B,class:Q([{"mt-20.5 ":!n(J)&&n(K),"mt-32":n(J)&&n(K),"!mt-0":!((T=n(F).spanningRecords)!=null&&T.length)},"absolute ml-16 flex w-[calc(100%-64px)]"])},[(b(!0),E(W,null,Z(n(le),(r,I)=>(b(),E("div",{key:I,class:Q([{"w-1/5":n(P)===5,"w-1/7":n(P)===7},"h-full mt-5.95"]),"data-testid":"nc-calendar-week-day"},[(b(!0),E(W,null,Z(r,(v,_)=>(b(),E("div",{key:_,class:Q([{"border-1 !border-brand-500 !bg-gray-100":v.isSame(n(pe),"hour")&&(v.get("day")===6||v.get("day")===0),"selected-hour":v.isSame(n(pe),"hour"),"bg-gray-50 hover:bg-gray-100":v.get("day")===0||v.get("day")===6,"hover:bg-gray-50":v.get("day")!==0&&v.get("day")!==6},"text-center relative transition h-13 text-sm text-gray-500 w-full py-1 border-transparent border-1 border-x-gray-100 border-t-gray-100 border-l-gray-200"]),"data-testid":"nc-calendar-week-hour",onDblclick:c=>Ue(v),onClick:()=>{Qe.value=v,pe.value=v,k.value=null}},[Ce(v).isOverflow?(b(),we(w,{key:0,trigger:["click"]},{overlay:ee(()=>[U("div",Jt,[(b(!0),E(W,null,Z(Ce(v).overflowRecords,c=>{var A,O,z,C;return b(),we(l,{key:(A=c==null?void 0:c.rowMeta)==null?void 0:A.id,draggable:!1,class:"w-64","from-date":n(s).timezonize(c.row[c.rowMeta.range.fk_from_col.title]).format("D MMM • h:mm A"),invalid:!1,row:c,"to-date":(C=(z=(O=c==null?void 0:c.rowMeta)==null?void 0:O.range)==null?void 0:z.fk_to_col)!=null&&C.title&&c.row[c.rowMeta.range.fk_to_col.title]?n(s).timezonize(c.row[c.rowMeta.range.fk_to_col.title]).format("DD MMM • HH:mm A"):null,"data-testid":"nc-sidebar-record-card",onClick:o=>Ye(c)},{default:ee(()=>[("isRowEmpty"in e?e.isRowEmpty:n(Je))(c,n(ne))?(b(),E("span",Kt," - ")):(b(),we(u,{key:0,modelValue:c.row[n(ne).title],"onUpdate:modelValue":o=>c.row[n(ne).title]=o,column:n(ne)},null,8,["modelValue","onUpdate:modelValue","column"]))]),_:2},1032,["from-date","row","to-date","onClick"])}),128))])]),default:ee(()=>[Et((b(),we(d,{class:"!absolute bottom-1 text-center w-15 ml-auto inset-x-0 z-3 text-gray-500",size:"xxsmall",type:"secondary",onClick:c=>vt(v)},{default:ee(()=>[U("span",qt," + "+fe(Ce(v).overflowCount)+" more ",1)]),_:2},1032,["onClick"])),[[i,"['c:calendar:week-view-more']"]])]),_:2},1024)):me("",!0)],42,Gt))),128))],2))),128)),U("div",Qt,[(b(!0),E(W,null,Z(n(F).records,r=>{var I,v,_;return b(),E(W,{key:r.rowMeta.id},[((I=r.rowMeta.style)==null?void 0:I.display)!=="none"?(b(),E("div",{key:0,"data-testid":`nc-calendar-week-record-${r.row[n(ne).title]}`,"data-unique-id":r.rowMeta.id,style:Ge({...r.rowMeta.style,lineHeight:"18px",opacity:(n(k)===null||r.rowMeta.id===((v=n(k))==null?void 0:v.rowMeta.id))&&(n($)===null||r.rowMeta.id===((_=n($))==null?void 0:_.rowMeta.id))?1:.3}),class:Q([{"w-1/5":n(P)===5,"w-1/7":n(P)===7},"absolute transition draggable-record group cursor-pointer pointer-events-auto"]),onMousedown:qe(c=>ft(c,r),["stop"]),onMouseleave:t[1]||(t[1]=c=>Te.value=null),onMouseover:c=>Te.value=r.rowMeta.id,onDragover:t[2]||(t[2]=qe(()=>{},["prevent"]))},[Le(D,{row:r},{default:ee(()=>{var c,A,O,z,C,o;return[Le(h,{hover:n(Te)===r.rowMeta.id,position:r.rowMeta.position,dragging:r.rowMeta.id===((A=(c=n(k))==null?void 0:c.rowMeta)==null?void 0:A.id)||((O=n($))==null?void 0:O.rowMeta.id)===r.rowMeta.id,resize:!!((z=r.rowMeta.range)!=null&&z.fk_to_col)&&n(G)("dataEdit"),record:r,selected:r.rowMeta.id===((o=(C=n(k))==null?void 0:C.rowMeta)==null?void 0:o.id),onResizeStart:mt},{time:ee(()=>{var f;return[U("div",eo,fe(n(s).timezonize(r.row[(f=r.rowMeta.range)==null?void 0:f.fk_from_col.title]).format("h:mm a")),1)]}),default:ee(()=>[(b(!0),E(W,null,Z(n(rt),(f,y)=>{var x,M,V;return b(),E(W,{key:y},[("isRowEmpty"in e?e.isRowEmpty:n(Je))(r,f)?me("",!0):(b(),we(u,{key:0,modelValue:r.row[f.title],"onUpdate:modelValue":p=>r.row[f.title]=p,class:"text-xs",column:f,bold:!!((x=n(ke)[f.id])!=null&&x.bold),italic:!!((M=n(ke)[f.id])!=null&&M.italic),underline:!!((V=n(ke)[f.id])!=null&&V.underline)},null,8,["modelValue","onUpdate:modelValue","column","bold","italic","underline"]))],64)}),128))]),_:2},1032,["hover","position","dragging","resize","record","selected"])]}),_:2},1032,["row"])],46,Zt)):me("",!0)],64)}),128))])],2)],544)}}}),mo=Object.assign(jt(to,[["__scopeId","data-v-8cd44f9a"]]),{__name:"SmartsheetCalendarWeekViewDateTimeField"});export{mo as default};
