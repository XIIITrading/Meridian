import{e as K,G as w,r as a,aM as W,aY as X,n as M,gi as Y,dJ as Z,fQ as tt,J as et,aQ as ot,fS as rt,ac as it,I as _,o as i,w as p,b as m,ap as st,L as t,ad as nt,O as lt,ag as v,a as n,K as u,c as F,aT as at,b9 as pt,t as f,d as C,M as mt,P as x,an as dt,bC as ct,d3 as ut,aG as ft,aX as _t,o0 as vt,_ as bt}from"./DOFFjK0_.js";import{u as Ft,_ as ht}from"./BcG6Ieku.js";import{u as gt}from"./DG2ZEhLK.js";import{u as yt}from"./0c4tmWST.js";import{u as wt}from"./BfzMHcOa.js";import"./D_wq2ltS.js";import"./9aYOtC5C.js";import"./D4XRfH0I.js";import"./B3Wp9c04.js";import"./SJHyi9T4.js";import"./qgYlKlk5.js";import"./Cb5B9eG-.js";import"./C_qz9woQ.js";import"./DA4KItu_.js";import"./CV-2bRRD.js";import"./D8wgK-Ih.js";import"./HdsRe6lq.js";import"./DzBSAsxR.js";import"./0vrXc9P0.js";import"./MNXVOE4I.js";import"./D-8_fbld.js";import"./4PLl4EP6.js";import"./D2QgEzTv.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./D1gZ4Fpg.js";import"./Bo7kLdUR.js";import"./BYGCxle3.js";import"./C1uRXLg7.js";import"./DGuB8RA-.js";import"./DunK-51v.js";import"./ps5He39s.js";import"./CHgOe2F-.js";import"./MSgi_m6o.js";import"./JKos0pQW.js";import"./CQugZrqw.js";import"./BdLxRlCP.js";import"./YaKnxhzO.js";import"./CNJqPN7Y.js";import"./AxsiR11P.js";import"./C9H3ht2d.js";import"./CkXo2doe.js";import"./Czlq_f4Y.js";import"./Cgx2iu1G.js";import"./C6nWwNvX.js";import"./DiUleKVo.js";import"./JUJEmhCv.js";import"./BrfakvRE.js";import"./CJtI8BMq.js";import"./Bgc5K1P7.js";import"./D4c215jk.js";import"./lL-0_K96.js";import"./BClTqpVB.js";import"./CYkscC4Z.js";import"./DEAKw9Pl.js";import"./Cl-qOJW6.js";import"./BNo10Mdm.js";import"./CtJu2gHc.js";import"./CMyFGii6.js";import"./4fFkR2QG.js";import"./CAfhvBOi.js";import"./BcKPINb2.js";import"./D0vnHTOx.js";import"./BRTCxTHu.js";import"./DDEVLD8O.js";import"./-rIuSlCu.js";import"./SpSJ8E4d.js";import"./Dh5zKH8k.js";import"./CiBV2ZED.js";import"./ZNRZafJ9.js";import"./BhfICdUA.js";import"./NRjd0XWG.js";import"./RfUK_fd6.js";import"./hehmy6V1.js";import"./BvG7Iv4q.js";import"./CyXz1Zkk.js";import"./CPChVVVr.js";import"./CFXGfO_A.js";import"./VKUQM8lk.js";import"./BqWeTF94.js";import"./sgaWLnOz.js";import"./BpgQOThx.js";import"./DmoodaOn.js";import"./B3tDgntu.js";import"./Db9kSA7A.js";import"./B4YnCsMc.js";import"./6zXueAcs.js";import"./Byuk3M83.js";import"./DminWhpq.js";const Ct={class:"flex items-center gap-1 min-h-5"},xt={class:"flex items-center gap-2"},kt={key:0,class:"text-capitalize !text-[13px] font-medium"},It={key:0,class:"ml-1 pb-0.6"},Et={class:"px-2 pb-2"},Dt={class:"flex-grow gap-2 flex"},Mt={key:0,class:"bg-[#F0F3FF] px-1 rounded rounded-6px font-medium text-brand-500 h-5"},Tt={class:"p-2"},$t=K({__name:"ColumnFilterMenu",setup(Lt){const V=w(W,a(!1)),h=w(X,a()),T=w(Y,M(()=>!1));w(tt,Z());const{isMobileMode:$}=et(),L=a(),{allFilters:St,nestedFilters:A,eventBus:N,filtersFromUrlParams:l,whereQueryFromUrl:j}=gt(),{appearanceConfig:k}=yt(),{nonDeletedFilters:R,loadFilters:G}=Ft(h,void 0,M(()=>!0),()=>!1,A.value,!0),I=a(0);ot(()=>{var o;return(o=h==null?void 0:h.value)==null?void 0:o.id},async o=>{o&&(await G({hookId:void 0,isWebhook:!1,loadAllFilters:!0}),I.value=R.value.length||0)},{immediate:!0});const r=a(!1),q=a({});_t(vt,q),wt(r);const g=a({}),d=a(!1);N.on(async(o,e)=>{e&&o===rt.FILTER_ADD&&(g.value={fk_column_id:e.id},r.value=!0)});const E=M(()=>{var o,e;return I.value+(((e=(o=l.value)==null?void 0:o.filters)==null?void 0:e.length)||0)}),S=a(!1);return(o,e)=>{const y=st,D=mt,z=lt,U=ht,P=ct,Q=ut,H=ft,J=it("e");return i(),_(H,{visible:t(r),"onUpdate:visible":e[6]||(e[6]=c=>x(r)?r.value=c:null),"overlay-class-name":"nc-dropdown-filter-menu nc-toolbar-dropdown overflow-hidden",class:"!xs:hidden"},{overlay:p(()=>{var c,b,B,O;return[n("div",null,[m(U,{ref_key:"filterComp",ref:L,"draft-filter":t(g),"onUpdate:draftFilter":e[0]||(e[0]=s=>x(g)?g.value=s:null),"is-open":t(r),"onUpdate:isOpen":e[1]||(e[1]=s=>x(r)?r.value=s:null),class:"nc-table-toolbar-menu","auto-save":!0,"data-testid":"nc-filter-menu","is-view-filter":!0,"onUpdate:filtersLength":e[2]||(e[2]=s=>I.value=s)},null,8,["draft-filter","is-open"]),t(l)?(i(),F(dt,{key:0},[m(P,{class:"!my-1"}),n("div",Et,[n("div",{class:v(["leading-5 font-semibold inline-flex w-full items-center cursor-pointer px-2",{"pb-0":!t(d)}]),onClick:e[3]||(e[3]=s=>d.value=!t(d))},[n("div",Dt,[C(f(o.$t("title.urlFilters"))+" ",1),(b=(c=t(l))==null?void 0:c.filters)!=null&&b.length?(i(),F("div",Mt,f(t(l).filters.length),1)):u("",!0),n("div",null,[m(y,{title:o.$t("msg.urlFilter"),placement:"top"},{default:p(()=>[m(D,{icon:"ncInfo",class:"nc-info-icon !w-3.5 !h-3.5"})]),_:1},8,["title"])])]),n("div",Tt,[m(D,{icon:"ncChevronDown",class:v(["nc-chevron-icon transition-all cursor-pointer w-4 h-4",{"transform rotate-180":t(d)}])},null,8,["class"])])],2),n("div",{class:v(["overflow-hidden transition-all duration-300 mt-1",{"max-h-0":!t(d),"max-h-[1000px] overflow-auto":t(d)}])},[t(l).filters?(i(),_(U,{key:t(j),ref_key:"filterComp",ref:L,modelValue:t(l).filters,"onUpdate:modelValue":e[4]||(e[4]=s=>t(l).filters=s),"is-open":t(r),"onUpdate:isOpen":e[5]||(e[5]=s=>x(r)?r.value=s:null),class:"nc-query-filter readonly px-2 pb-2","auto-save":!1,"is-view-filter":!1,"read-only":"","query-filter":""},null,8,["modelValue","is-open"])):(O=(B=t(l))==null?void 0:B.errors)!=null&&O.length?(i(),F("div",{key:1,class:v(["px-2 transition-margin duration-500",{"mb-2":t(d)}])},[m(Q,{type:"error",message:"Error",description:o.$t("msg.urlFilterError")},null,8,["description"])],2)):u("",!0)],2)])],64)):u("",!0)])]}),default:p(()=>[m(y,{disabled:!t($)&&!t(T)},{title:p(()=>[C(f(o.$t("activity.filter")),1)]),default:p(()=>[nt((i(),_(z,{class:v(["nc-filter-menu-btn nc-toolbar-btn !border-0 !h-7 group",{[t(k).FILTERED.toolbarBgClass]:t(E)}]),size:"small",type:"secondary","show-as-disabled":t(V)},{default:p(()=>{var c,b;return[n("div",Ct,[n("div",xt,[(i(),_(at(("iconMap"in o?o.iconMap:t(pt)).filter),{class:"h-4 w-4"})),!t($)&&!t(T)?(i(),F("span",kt,f(o.$t("activity.filter")),1)):u("",!0)]),t(E)?(i(),_(y,{key:0,disabled:!t(S),class:"flex"},{title:p(()=>[C(f(o.$t("tooltip.filteredByCurrentUser")),1)]),default:p(()=>[n("span",{class:v(["nc-toolbar-btn-chip inline-flex items-center",{[t(k).FILTERED.toolbarChipBgClass]:!0,[t(k).FILTERED.toolbarTextClass]:!0}])},[C(f(t(E))+" ",1),t(S)?(i(),F("span",It,f("@"))):u("",!0)],2)]),_:1},8,["disabled"])):u("",!0),(b=(c=t(l))==null?void 0:c.errors)!=null&&b.length?(i(),_(y,{key:1,title:o.$t("msg.urlFilterError"),placement:"top"},{default:p(()=>[m(D,{icon:"ncAlertCircle",class:"nc-error-icon w-3.5"})]),_:1},8,["title"])):u("",!0)])]}),_:1},8,["show-as-disabled","class"])),[[J,["c:filter"]]])]),_:1},8,["disabled"])]),_:1},8,["visible"])}}}),vo=Object.assign(bt($t,[["__scopeId","data-v-6a15d9ed"]]),{__name:"SmartsheetToolbarColumnFilterMenu"});export{vo as default};
