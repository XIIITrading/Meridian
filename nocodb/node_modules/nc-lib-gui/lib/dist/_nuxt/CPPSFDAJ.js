import{e as U,a6 as M,a9 as q,J as N,r as V,Y as k,c as v,o as g,b as s,a as t,w as o,t as f,M as B,by as F,K as I,L as r,d as x,a0 as j,d1 as T,O as E,I as G,aT as O,b9 as S,X as A,a4 as D,_ as L}from"./DOFFjK0_.js";import{_ as z}from"./EgJz-9W8.js";import{_ as H}from"./BPCu6jTH.js";const J={class:"flex flex-col"},K={"data-rec":"true"},W={class:"nc-content-max-w p-6 h-[calc(100vh_-_100px)] flex flex-col gap-6 overflow-auto nc-scrollbar-thin"},X={class:"flex flex-col gap-6 w-150 mx-auto"},Y={class:"mt-5 flex flex-col border-1 rounded-2xl border-gray-200 p-6 gap-y-2"},Q={class:"relative flex flex-col justify-start gap-2 w-full"},Z={key:0,class:"mx-auto mb-4 bg-red-500 text-white rounded-lg w-3/4 p-1"},ee={"data-testid":"nc-user-settings-form__error",class:"flex items-center gap-2 justify-center","data-rec":"true"},se={class:"text-right mt-5"},ae={class:"flex justify-center items-center gap-2","data-rec":"true"},re=U({__name:"ResetPassword",setup(te){const{api:b,error:d}=M({useGlobalInstance:!0}),{t:n}=q(),{signOut:y}=N(),h=V(),a=k({currentPassword:"",password:"",passwordRepeat:""}),p={currentPassword:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")}],password:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")},{min:8,message:n("msg.error.signUpRules.passwdLength")}],passwordRepeat:[{required:!0,message:n("msg.error.signUpRules.passwdRequired")},{validator:(e,l)=>new Promise((i,_)=>{if(a.password===a.passwordRepeat)return i(!0);_(new Error(n("msg.error.signUpRules.passwdMismatch")))}),message:n("msg.error.signUpRules.passwdMismatch")}]},R=async()=>{try{if(!h.value.validate())return;d.value=null,await b.auth.passwordChange({currentPassword:a.currentPassword,newPassword:a.password}),D.success(n("msg.success.passwordChanged")),await y({redirectToSignin:!0})}catch{}},u=()=>{d.value&&(d.value=null)};return(e,l)=>{const i=B,_=z,P=H,m=T,w=j,$=E,C=A;return g(),v("div",J,[s(_,null,{icon:o(()=>[s(i,{icon:"passwordChange",class:"flex-none text-gray-700 text-[20px] h-5 w-5"})]),title:o(()=>[t("span",K,f(e.$t("activity.changePwd")),1)]),_:1}),t("div",W,[t("div",X,[t("div",Y,[t("div",Q,[s(C,{ref_key:"formValidator",ref:h,"data-testid":"nc-user-settings-form",layout:"vertical",class:"change-password","no-style":"",model:r(a),onFinish:R},{default:o(()=>[s(F,{name:"layout"},{default:o(()=>[r(d)?(g(),v("div",Z,[t("div",ee,[s(P),x(" "+f(r(d)),1)])])):I("",!0)]),_:1}),s(w,{label:e.$t("placeholder.password.current"),"data-rec":"true",name:"currentPassword",rules:p.currentPassword},{default:o(()=>[s(m,{value:r(a).currentPassword,"onUpdate:value":l[0]||(l[0]=c=>r(a).currentPassword=c),"data-testid":"nc-user-settings-form__current-password",class:"password",placeholder:e.$t("placeholder.password.current"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(w,{label:e.$t("placeholder.password.new"),"data-rec":"true",name:"password",rules:p.password},{default:o(()=>[s(m,{value:r(a).password,"onUpdate:value":l[1]||(l[1]=c=>r(a).password=c),"data-testid":"nc-user-settings-form__new-password",class:"password",placeholder:e.$t("placeholder.password.new"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),s(w,{label:e.$t("placeholder.password.confirm"),"data-rec":"true",name:"passwordRepeat",rules:p.passwordRepeat},{default:o(()=>[s(m,{value:r(a).passwordRepeat,"onUpdate:value":l[2]||(l[2]=c=>r(a).passwordRepeat=c),"data-testid":"nc-user-settings-form__new-password-repeat",class:"password",placeholder:e.$t("placeholder.password.confirm"),onFocus:u},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),t("div",se,[s($,{size:"small","data-testid":"nc-user-settings-form__submit","html-type":"submit"},{default:o(()=>[t("div",ae,[(g(),G(O(("iconMap"in e?e.iconMap:r(S)).passwordChange))),x(" "+f(e.$t("activity.changePwd")),1)])]),_:1})])]),_:1},8,["model"])])])])])])}}}),de=Object.assign(L(re,[["__scopeId","data-v-44e39263"]]),{__name:"AccountResetPassword"});export{de as default};
