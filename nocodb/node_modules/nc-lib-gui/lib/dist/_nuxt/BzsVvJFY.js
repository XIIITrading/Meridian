const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./HRIII2IE.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./CbIZaIOA.js","./EmojiPicker.BKv0qZ9h.css","./2EkCyFsn.js","./SpSJ8E4d.js","./D2vSp_o0.js","./DZVK5DjD.js","./CFDwQBzt.js","./Overlay.CpKx7Pnx.css","./BlIUVhTI.js","./View.ChgPETCw.css","./BrciY6D-.js"])))=>i.map(i=>d[i]);
import{_ as rt,I as u,o as t,e as Se,J as Qe,f as Xe,r as T,n as ne,c as _,K as y,L as e,a as l,b as s,M as Ge,w as i,N as $e,O as pt,d as Z,P as xe,Q as pa,t as b,R as Wa,S as Ht,T as wt,U as Je,V as Ze,W as Bs,X as Os,Y as Ns,Z as ma,$ as Ct,a0 as Fa,a1 as Ga,a2 as Ha,a3 as Dt,a4 as Le,a5 as qe,a6 as es,a7 as nt,a8 as se,a9 as ws,aa as xt,ab as ts,ac as _t,ad as ye,ae as va,af as Ka,ag as G,ah as Ke,ai as Bt,aj as Ws,ak as xs,al as kt,am as lt,an as Ce,ao as Tt,ap as Kt,aq as ks,ar as ss,as as it,g as hs,at as ba,au as qa,av as Ft,aw as Gs,ax as at,G as ot,ay as Lt,az as na,aA as as,aB as Ja,aC as Qa,j as et,y as Zt,aD as Ya,aE as Za,aF as Hs,aG as os,aH as Fe,aI as fa,aJ as Ks,aK as _a,aL as $s,aM as Xa,aN as ns,aO as _s,aP as ft,aQ as Ye,aR as eo,aS as Is,aT as ys,aU as Nt,aV as to,aW as Ds,aX as Gt,aY as so,aZ as ao,a_ as gs,a$ as oo,b0 as Xt,b1 as no,b2 as Ls,b3 as lo,b4 as la,b5 as io,b6 as ya,b7 as ro,b8 as co,b9 as ia,ba as uo,bb as zs,bc as po,bd as ga,be as mo,bf as vo,bg as ra,bh as bo,bi as fo,u as Cs,bj as _o,bk as ca,bl as wa,bm as yo,bn as go,bo as wo,bp as Wt,bq as xo,br as ko,bs as xa,bt as qs,bu as da,bv as Es,bw as ka,bx as ha,by as ho,bz as $o,bA as ua,bB as Io,bC as Do,bD as Co,bE as To,bF as jo,bG as So,bH as Vo,bI as Po}from"./DOFFjK0_.js";import{_ as Js}from"./SpSJ8E4d.js";import{_ as Us,i as $a,a as Mo,b as Oo,c as Eo,d as Bo}from"./oqUeZVz8.js";import{_ as No,a as Lo,b as Ia}from"./CsgdvnsK.js";import{_ as ls}from"./JUJEmhCv.js";import{u as Pt}from"./C9H3ht2d.js";import{S as Rs}from"./ps5He39s.js";import"./CYkscC4Z.js";import{S as Uo}from"./Cl-qOJW6.js";import{r as Ro,a as Ao}from"./CJtI8BMq.js";import zo from"./DZVK5DjD.js";import{_ as qt}from"./D_wq2ltS.js";import{_ as Wo,a as Fo}from"./C44sDnaa.js";import{_ as Go}from"./BNo10Mdm.js";import{_ as is}from"./9aYOtC5C.js";import{S as Da}from"./C83syoBY.js";import{_ as Ca}from"./BRTCxTHu.js";import{_ as Ho}from"./-rIuSlCu.js";import{_ as Ko}from"./sgaWLnOz.js";import Ta from"./DiUleKVo.js";import{u as qo}from"./BYGCxle3.js";import{_ as ja}from"./VKUQM8lk.js";import{u as Jo}from"./D0s_72GC.js";import{c as Qo}from"./Ck0WYZ6p.js";import{C as Sa,_ as Va}from"./Db9kSA7A.js";import{_ as Yo}from"./Bvj7PEZG.js";import{_ as Zo}from"./BHf1eO7s.js";import{D as Pa}from"./BhfICdUA.js";import{I as Xo}from"./BcKPINb2.js";import{u as Ma}from"./DjcS-2EH.js";import"./BlIUVhTI.js";import"./BNY-DJUS.js";import"./C6nWwNvX.js";import"./hayhBYSD.js";import"./DoZsC7ga.js";import"./MNXVOE4I.js";import"./SJHyi9T4.js";import"./CNPqpuqR.js";import"./DGuB8RA-.js";import"./CHgOe2F-.js";import"./DEAKw9Pl.js";import"./CFDwQBzt.js";import"./KFthsW2H.js";import"./Bo7kLdUR.js";import"./lL-0_K96.js";import"./JVTgKN82.js";import"./HdsRe6lq.js";import"./BrfakvRE.js";import"./NRjd0XWG.js";const en={};function tn(R,A){const p=Js;return t(),u(p)}const sn=Object.assign(rt(en,[["render",tn]]),{__name:"PaymentUpgradeSidebarBanner"}),an=""+new URL("giftCard.2B6TXtv7.svg",import.meta.url).href,on={class:"wrapper"},nn={class:"header"},ln={key:0,class:"img-wrapper"},rn={class:"flex justify-end mt-7 gap-x-2"},cn=Se({__name:"Gift",setup(R){const{appInfo:A,giftBannerDismissedCount:p,user:n}=Qe(),{$e:o}=Xe(),f=T(!0),N=T(!1),h=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)<780,V=ne(()=>{var a,D;return((a=n.value)==null?void 0:a.email)&&!/^[a-zA-Z0-9._%+-]+@(gmail|yahoo|hotmail|outlook|aol|icloud|qq|163|126|sina|nocodb)(\.com)?$/i.test((D=n.value)==null?void 0:D.email)&&(!p.value||p.value<5)});p.value?setTimeout(()=>{f.value=!1},p.value*6e4):f.value=!1;const $=()=>{var a;p.value++,o("a:claim:gift:coupon"),window.open((a=A.value)==null?void 0:a.giftUrl,"_blank","noopener,noreferrer")},r=()=>{!p.value||p.value<4?N.value=!0:(f.value=!0,p.value++)},c=()=>{f.value=!0,p.value=5,N.value=!1},x=()=>{f.value=!0,p.value++,N.value=!1};return(a,D)=>{const q=Ge,g=pt,w=pa;return e(V)&&!e(f)&&e(A).giftUrl?(t(),_("div",{key:0,class:"container",onClick:$},[l("div",on,[l("div",nn,[s(q,{class:"icon",icon:"gift",size:"xlarge"}),D[1]||(D[1]=l("h4",null,"Gifts Unlocked!",-1))]),D[2]||(D[2]=l("div",{class:"body"},"We are giving away $25 worth of amazon coupons to our pro open source users!",-1))]),!h&&!e(p)?(t(),_("div",ln,D[3]||(D[3]=[l("img",{src:an},null,-1)]))):y("",!0),s(g,{type:"text",size:"small",class:"close-icon",onClick:$e(r,["stop"])},{default:i(()=>[s(q,{icon:"close",size:"xlarge"})]),_:1}),s(w,{visible:e(N),"onUpdate:visible":D[0]||(D[0]=k=>xe(N)?N.value=k:null),size:"small"},{default:i(()=>[l("div",null,[D[6]||(D[6]=l("div",{class:"mt-1 text-sm"},"Do you want to remind later on your next visit?",-1)),l("div",rn,[s(g,{type:"secondary",size:"small",onClick:c},{default:i(()=>D[4]||(D[4]=[Z(" Donâ€™t show again ")])),_:1,__:[4]}),s(g,{type:"primary",size:"small",onClick:x},{default:i(()=>D[5]||(D[5]=[Z(" Yes ")])),_:1,__:[5]})])])]),_:1},8,["visible"])])):y("",!0)}}}),dn=Object.assign(rt(cn,[["__scopeId","data-v-7343edb1"]]),{__name:"GeneralGift"}),un={};function pn(R,A){const p=Js;return t(),u(p)}const mn=Object.assign(rt(un,[["render",pn]]),{__name:"DashboardSidebarBeforeUserInfo"}),vn={class:"flex items-center text-xs text-gray-400 px-3 py-1"},bn=Se({__name:"Version",setup(R){const{appInfo:A}=Qe();return(p,n)=>(t(),_("div",null,[l("div",vn,[l("span",null,"Version "+b(e(A).version),1)])]))}}),fn=Object.assign(bn,{__name:"DashboardSidebarVersion"}),_n={class:"flex flex-row items-center gap-x-2 text-base"},yn={class:"text-base font-semibold text-gray-800"},gn={class:"mt-1"},wn={class:"flex flex-row justify-end gap-x-2 mt-5"},xn=Se({__name:"DescriptionUpdate",props:{modelValue:{type:Boolean},tableMeta:{},sourceId:{}},emits:["update:modelValue","updated"],setup(R,{emit:A}){const p=Wa(R,["tableMeta"]),n=A,{$e:o,$api:f}=Xe(),{setMeta:N}=Ht(),h=wt(p,"modelValue",n),{loadProjectTables:V}=Je(),$=Ze(),{loadTables:r}=$,{addUndo:c,defineProjectScope:x}=Bs(),a=T(),D=T(!1),q=Os.useForm,g=Ns({description:""}),w=ne(()=>({description:[{validator:(E,j)=>new Promise((J,U)=>{J()})}]})),{validateInfos:k}=q(g,w);ma(()=>{var E;(E=R.tableMeta)!=null&&E.description&&(g.description=`${R.tableMeta.description}`),Ct(()=>{var J;const j=(J=a.value)==null?void 0:J.$el;j&&(j.setSelectionRange(0,g.description.length),j.focus())})},{flush:"post"});const M=async(E=!1)=>{if(R.tableMeta){g.description&&(g.description=g.description.trim()),D.value=!0;try{await f.dbTable.update(R.tableMeta.id,{base_id:R.tableMeta.base_id,description:g.description}),h.value=!1,await V(R.tableMeta.base_id,!0),E||c({redo:{fn:J=>{g.description=J,M(!0,!0)},args:[g.description]},undo:{fn:J=>{g.description=J,M(!0,!0)},args:[R.tableMeta.description]},scope:x({model:R.tableMeta})}),await r();const j=await f.dbTable.read(R.tableMeta.id);await N(j),o("a:table:description:update"),h.value=!1}catch(j){Le.error(await qe(j))}D.value=!1}};return(E,j)=>{const J=Ge,U=Ha,B=Fa,ae=Os,Q=pt,X=pa;return t(),u(X,{visible:e(h),"onUpdate:visible":j[4]||(j[4]=ce=>xe(h)?h.value=ce:null),size:"small","show-separator":!1},{header:i(()=>{var ce,P;return[l("div",_n,[s(J,{icon:"table",class:"w-5 h-5 text-gray-600"}),l("span",yn,b(((ce=E.tableMeta)==null?void 0:ce.title)??((P=E.tableMeta)==null?void 0:P.table_name)),1)])]}),default:i(()=>{var ce,P,z,ke;return[l("div",gn,[s(ae,{layout:"vertical",model:e(g),name:"create-new-table-form"},{default:i(()=>[s(B,Ga({label:E.$t("labels.description")},e(k).description),{default:i(()=>[s(U,{ref_key:"inputEl",ref:a,value:e(g).description,"onUpdate:value":j[0]||(j[0]=de=>e(g).description=de),class:"nc-input-sm !py-2 nc-text-area nc-input-shadow","hide-details":"",size:"small",placeholder:E.$t("msg.info.enterTableDescription"),onKeydown:j[1]||(j[1]=Dt($e(()=>M(),["exact"]),["enter"]))},null,8,["value","placeholder"])]),_:1},16,["label"])]),_:1},8,["model"]),l("div",wn,[s(Q,{type:"secondary",size:"small",onClick:j[2]||(j[2]=de=>h.value=!1)},{default:i(()=>[Z(b(E.$t("general.cancel")),1)]),_:1}),s(Q,{key:"submit",type:"primary",size:"small",disabled:((P=(ce=e(k))==null?void 0:ce.description)==null?void 0:P.validateStatus)==="error"||((z=e(g).description)==null?void 0:z.trim())===((ke=E.tableMeta)==null?void 0:ke.description),loading:e(D),onClick:j[3]||(j[3]=()=>M())},{default:i(()=>[Z(b(E.$t("general.save")),1)]),_:1},8,["disabled","loading"])])])]}),_:1},8,["visible"])}}}),Oa=Object.assign(rt(xn,[["__scopeId","data-v-16348511"]]),{__name:"DlgTableDescriptionUpdate"}),kn={class:"mt-5 flex gap-3 flex-col"},hn={class:"flex flex-row gap-x-2 mt-5 justify-end"},$n=Se({__name:"Duplicate",props:{modelValue:{type:Boolean},table:{}},emits:["update:modelValue"],setup(R,{emit:A}){const p=R,n=A,{api:o}=es(),f=wt(p,"modelValue",n),{$e:N,$poller:h}=Xe(),V=nt(),{createProject:$}=V,{openTable:r}=Je(),c=Ze(),{loadTables:x}=c,{tables:a}=se(c),{getMeta:D}=Ht(),{t:q}=ws(),{activeTable:g}=se(Je()),{refreshCommandPalette:w}=xt(),k=T({includeData:!0,includeViews:!0,includeHooks:!0}),M=ne(()=>{const{includeData:U,includeViews:B,includeHooks:ae}=k.value;return{excludeData:!U,excludeViews:!B,excludeHooks:!ae}}),E=T(!1),j=async()=>{try{E.value=!0;const U=await o.dbTable.duplicate(p.table.base_id,p.table.id,{options:M.value});h.subscribe({id:U.id},async B=>{var ae;if(B.status!=="close")if(B.status===Bt.COMPLETED){const Q=await D(p.table.id);if(Q){for(const ce of Q.columns||[])if([Ws.Links,Ws.LinkToAnotherRecord].includes(ce.uidt)&&ce&&ce.colOptions){const P=(ae=ce.colOptions)==null?void 0:ae.fk_related_model_id;P&&await D(P,!0)}}await x(),w();const X=a.value.find(ce=>{var P,z;return ce.id===((z=(P=B==null?void 0:B.data)==null?void 0:P.result)==null?void 0:z.id)});r(X),E.value=!1,f.value=!1}else B.status===Bt.FAILED&&(Le.error(q("msg.error.failedToDuplicateTable")),await x(),E.value=!1,f.value=!1)}),N("a:table:duplicate")}catch(U){Le.error(await qe(U)),E.value=!1,f.value=!1}};ts("Enter",()=>{f.value&&j()});const J=T(!1);return(U,B)=>{const ae=va,Q=pt,X=ls,ce=_t("e");return t(),u(X,{visible:e(f),"onUpdate:visible":B[5]||(B[5]=P=>xe(f)?f.value=P:null),class:G([{active:e(f)},"!w-[30rem]"]),"mask-closable":!e(E),keyboard:!e(E),centered:"","wrap-class-name":"nc-modal-table-duplicate","mask-style":{"background-color":"rgba(0, 0, 0, 0.08)"},footer:null,onKeydown:B[6]||(B[6]=Dt(P=>f.value=!1,["esc"]))},{default:i(()=>[l("div",null,[l("div",{class:"text-base text-nc-content-gray-emphasis leading-6 font-bold self-center",onDblclick:B[0]||(B[0]=P=>J.value=!e(J))},b(U.$t("general.duplicate"))+" "+b(U.$t("objects.table"))+' "'+b(U.table.title)+'" ',33),l("div",kn,[l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:B[1]||(B[1]=P=>e(k).includeData=!e(k).includeData)},[s(ae,{checked:e(k).includeData},null,8,["checked"]),Z(" "+b(U.$t("labels.includeRecords")),1)]),l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:B[2]||(B[2]=P=>e(k).includeViews=!e(k).includeViews)},[s(ae,{checked:e(k).includeViews},null,8,["checked"]),Z(" "+b(U.$t("labels.includeView")),1)]),ye(l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:B[3]||(B[3]=P=>e(k).includeHooks=!e(k).includeHooks)},[s(ae,{checked:e(k).includeHooks},null,8,["checked"]),Z(" "+b(U.$t("labels.includeWebhook")),1)],512),[[Ka,e(J)]])]),l("div",{class:G([{"mb-5":"isEeUI"in U?U.isEeUI:e(Ke)},"mt-5 text-nc-content-gray-subtle2 font-medium"])},b(U.$t("labels.tableDuplicateMessage")),3)]),l("div",hn,[e(E)?y("",!0):(t(),u(Q,{key:"back",type:"secondary",size:"small",onClick:B[4]||(B[4]=P=>f.value=!1)},{default:i(()=>[Z(b(U.$t("general.cancel")),1)]),_:1})),ye((t(),u(Q,{key:"submit",type:"primary",size:"small",loading:e(E),onClick:j},{default:i(()=>B[7]||(B[7]=[Z(" Duplicate Table ")])),_:1,__:[7]},8,["loading"])),[[ce,["a:table:duplicate"]]])])]),_:1},8,["visible","class","mask-closable","keyboard"])}}}),Ea=Object.assign($n,{__name:"DlgTableDuplicate"}),In=["data-workspace-title"],Dn={class:"nc-sidebar-header-content text-subHeading2 truncate"},Cn={class:"flex items-center text-inherit"},Tn=Se({__name:"HeaderWrapper",props:{isLoading:{type:Boolean}},setup(R){const A=R,{isLoading:p}=xs(A),n=kt(),{isLeftSidebarOpen:o}=se(Pt()),{activeWorkspace:f,isWorkspacesLoading:N}=se(n),{showProjectList:h}=se(nt()),{activeViewTitleOrId:V}=se(lt()),{activeTableId:$}=se(Je()),{isMobileMode:r}=Qe(),c=ne(()=>!(r.value&&!V.value&&!$.value));return(x,a)=>{var M;const D=Ge,q=pt,g=Kt,w=Rs,k=_t("e");return t(),_("div",{class:G(["nc-sidebar-header",e(h)?"nc-project-list":"nc-active-project"]),"data-workspace-title":(M=e(f))==null?void 0:M.title},[!e(N)&&!e(p)?(t(),_(Ce,{key:0},[l("div",Dn,[Tt(x.$slots,"default",{},()=>[a[1]||(a[1]=Z(" Bases "))],!0)]),s(g,{class:G(["flex",{"!opacity-100":!e(o)}]),placement:"bottom","hide-on-click":""},{title:i(()=>[Z(b(e(o)?`${x.$t("title.hideSidebar")}`:`${x.$t("title.showSidebar")}`),1)]),default:i(()=>[e(c)?ye((t(),u(q,{key:0,type:e(r)?"secondary":"text",size:e(r)?"medium":"small",class:"nc-sidebar-left-toggle-icon !text-gray-700 !hover:text-gray-800 !xs:h-10.5 !xs:max-h-10.5 !xs:max-w-10.5 !md:hover:bg-gray-200 !rounded-md",onClick:a[0]||(a[0]=E=>o.value=!e(o))},{default:i(()=>[l("div",Cn,[e(r)?(t(),u(D,{key:0,icon:"close"})):(t(),u(D,{key:1,icon:"doubleLeftArrow",class:G(["duration-150 transition-all !text-lg -mt-0.5 !text-gray-500/75",{"transform rotate-180":!e(o)}])},null,8,["class"]))])]),_:1},8,["type","size"])),[[k,["c:leftSidebar:hideToggle"]]]):y("",!0)]),_:1},8,["class"])],64)):(t(),_(Ce,{key:1},[s(w,{active:!0,class:"!flex-1 !h-7 !rounded overflow-hidden"}),s(w,{active:!0,class:"!w-7 !h-7 !rounded overflow-hidden"})],64))],10,In)}}}),Qs=Object.assign(rt(Tn,[["__scopeId","data-v-12091e9a"]]),{__name:"DashboardSidebarHeaderWrapper"}),jn={},Sn={class:"nc-treeview-loading absolute w-full h-full top-0 left-0 z-5"},Vn={class:"w-full"},Pn={class:"flex-1 flex"},Mn={class:"nc-project-home-section !px-2"},On={class:"h-11 flex items-center"},En={class:"nc-project-home-section !px-2 mt-1"},Bn={class:"flex w-1/2"},Nn={class:"flex flex-col gap-4 mt-3"};function Ln(R,A){const p=Rs,n=Qs,o=Uo;return t(),_("div",Sn,[l("div",Vn,[s(n,null,{default:i(()=>[l("div",Pn,[s(p,{active:"",class:"flex-1 children:rounded-md h-7"})])]),_:1}),l("div",Mn,[l("div",On,[s(p,{active:"",size:"small",class:"flex-1 children:rounded-md h-7"})])]),l("div",En,[l("div",Bn,[s(p,{active:"",size:"small",class:"children:rounded-md h-5 flex-1"})]),l("div",Nn,[(t(),_(Ce,null,ks(5,f=>l("div",{key:f,class:"flex items-center gap-3"},[s(o,{active:"",shape:"square",class:"!h-5 !w-5 !children:rounded-md !children:w-5 !children:h-5"}),s(p,{active:"",size:"small",class:"flex-1 children:rounded-md h-5"})])),64))])])])])}const Un=Object.assign(rt(jn,[["render",Ln]]),{__name:"DashboardTreeViewProjectListSkeleton"}),Rn=Se({__name:"SearchInput",props:{value:{},isLoading:{type:Boolean}},emits:["update:value"],setup(R,{emit:A}){const p=R,o=wt(p,"value",A),{isLoading:f}=xs(p),{t:N}=ws(),h=T(),V=ne(()=>f.value?`${N("general.search")}...`:`${N("activity.searchProject").charAt(0).toUpperCase()}${N("activity.searchProject").slice(1).toLowerCase()}`),$=r=>{var c;r.altKey&&(r.code==="KeyB"||r.code==="KeyD")?(r.preventDefault(),(c=h.value.input)==null||c.blur()):r.stopPropagation()};return(r,c)=>{const x=Ge,a=ss;return t(),u(a,{ref_key:"inputRef",ref:h,value:e(o),"onUpdate:value":c[0]||(c[0]=D=>xe(o)?o.value=D:null),type:"text",class:"nc-base-search-input nc-input-border-on-value nc-input-shadow !h-8 !px-2.5 !py-1 !rounded-lg",placeholder:e(V),"allow-clear":"",readonly:e(f),onKeydown:$},{prefix:i(()=>[s(x,{icon:"search",class:"mr-1 h-4 w-4 text-gray-500 group-hover:text-black"})]),_:1},8,["value","placeholder","readonly"])}}}),An=Object.assign(Rn,{__name:"DashboardTreeViewProjectSearchInput"}),zn={class:"flex items-center gap-2 w-full"},Wn={class:"flex flex-1"},Fn={class:"px-1 flex-none text-bodySmBold !leading-[18px] text-nc-content-gray-subtle bg-nc-bg-gray-medium rounded"},Gn=Se({__name:"CreateProjectBtn",props:{activeWorkspaceId:{},modal:{type:Boolean},type:{},isOpen:{type:Boolean},size:{},centered:{type:Boolean}},setup(R){const A=R,{isUIAllowed:p}=it(),{orgRoles:n,workspaceRoles:o}=it(),f=Ze(),{isSharedBase:N}=se(f),h=kt(),{activeWorkspaceId:V}=se(h),$=T(!1),r=ne(()=>A.size||"small"),c=ne(()=>A.centered??!0);return(x,a)=>{const D=Us,q=pt,g=_t("e");return e(p)("baseCreate",{roles:e(o)??e(n)})&&!e(N)?ye((t(),u(q,{key:0,type:"text",size:e(r),centered:e(c),"full-width":"",onClick:a[1]||(a[1]=w=>$.value=!0)},{default:i(()=>[Tt(x.$slots,"default",{},()=>[l("div",zn,[a[2]||(a[2]=l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},[l("rect",{width:"16",height:"16",rx:"8",fill:"#D6E0FF"}),l("path",{d:"M8 4V12",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"}),l("path",{d:"M4 8H12",stroke:"currentColor","stroke-width":"1.33333","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),l("div",Wn,b(x.$t("title.createBase")),1),l("div",Fn,b(("renderAltOrOptlKey"in x?x.renderAltOrOptlKey:e(Ro))(!0))+" D ",1)])]),s(D,{modelValue:e($),"onUpdate:modelValue":a[0]||(a[0]=w=>xe($)?$.value=w:null)},null,8,["modelValue"])]),_:3},8,["size","centered"])),[[g,["c:base:create"]]]):y("",!0)}}}),Ba=Object.assign(Gn,{__name:"WorkspaceCreateProjectBtn"}),Hn={class:"flex flex-col h-[80vh]"},Kn={class:"flex flex-row pt-3 pb-2 px-4 justify-between items-center w-full"},qn={class:"select-none text-lg font-bold"},Jn={class:"h-full"},Qn=Se({__name:"Erd",props:{baseId:{},sourceId:{},modelValue:{type:Boolean}},emits:["update:modelValue"],setup(R,{emit:A}){const p=R,o=wt(p,"modelValue",A),f=ne(()=>p.sourceId),{openedProject:N}=se(nt()),{baseTables:h}=se(Je()),{loadProjectTables:V}=Je(),$=T(!0),{getMeta:r}=Ht(),c=ne(()=>{var x;return p.baseId||((x=N.value)==null?void 0:x.id)});return hs(async()=>{if(c.value&&h.value.get(c.value))return $.value=!1;try{await V(c.value),await Promise.all(h.value.get(c.value).map(async x=>{await r(x.id,!1,!1,c.value)}))}catch(x){console.error(x)}finally{$.value=!1}}),(x,a)=>{const D=qa,q=ba,g=zo,w=ls;return t(),u(w,{visible:e(o),"onUpdate:visible":a[1]||(a[1]=k=>xe(o)?o.value=k:null),size:"large"},{default:i(()=>{var k;return[l("div",Hn,[l("div",Kn,[l("span",qn,b(x.$t("title.erdView"))+": "+b((k=e(N))==null?void 0:k.title),1),s(q,{type:"text",class:"!rounded-md mr-1 -mt-1.5",onClick:a[0]||(a[0]=M=>o.value=!1)},{icon:i(()=>[s(D,{"data-testid":"nc-root-user-invite-modal-close",class:"flex mx-auto"})]),_:1})]),l("div",Jn,[e($)?y("",!0):(t(),u(g,{key:0,"source-id":e(f),"base-id":e(c),"show-all-columns":!1},null,8,["source-id","base-id"]))])])]}),_:1},8,["visible"])}}}),Na=Object.assign(Qn,{__name:"DlgBaseErd"}),Yn={class:"ml-0.5"},Zn=Se({__name:"BaseOptions",props:{source:{},base:{},variant:{default:"small"},titleClass:{default:""},submenuClass:{default:""},showLabel:{type:Boolean,default:!1},showNocoDbImport:{type:Boolean,default:!1},popupOffset:{},showSourceSelector:{type:Boolean,default:!0}},setup(R){const A=R,p=Ft(A,"source"),n=Ft(A,"base"),{isUIAllowed:o}=it(),f=ne(()=>n.value.project_role||n.value.workspace_role),{$e:N}=Xe();function h($,r){if(!$||!r)return;N("a:actions:import-airtable");const c=T(!0),{close:x}=at(Wo,{modelValue:c,baseId:$,sourceId:r,showSourceSelector:A.showSourceSelector,"onUpdate:modelValue":a});function a(){c.value=!1,x(1e3)}}function V($){var a;if(!((a=p.value)!=null&&a.id)||!p.value.base_id)return;N(`a:actions:import-${$}`);const r=T(!0),{close:c}=at(Fo,{modelValue:r,importType:$,baseId:p.value.base_id,sourceId:p.value.id,showSourceSelector:A.showSourceSelector,"onUpdate:modelValue":x});function x(){r.value=!1,c(1e3)}}return($,r)=>{const c=Ge,x=qt,a=Go,D=_t("e");return t(),u(a,{class:G(["py-0",$.submenuClass]),"data-testid":"nc-sidebar-base-import",variant:$.variant,"title-class":$.titleClass,"popup-offset":$.popupOffset},Gs({title:i(()=>[Tt($.$slots,"title",{},()=>[s(c,{icon:"download",class:"opacity-80"}),Z(" "+b($.$t("labels.importData")),1)])]),default:i(()=>[Tt($.$slots,"label"),e(o)("airtableImport",{roles:e(f),source:e(p)})?ye((t(),u(x,{key:"quick-import-airtable",onClick:r[0]||(r[0]=q=>h(e(p).base_id,e(p).id))},{default:i(()=>[s(c,{icon:"airtable",class:"max-w-3.75"}),l("div",Yn,b($.$t("labels.airtableBase")),1)]),_:1})),[[D,["c:import:airtable"]]]):y("",!0),e(o)("csvImport",{roles:e(f),source:e(p)})?ye((t(),u(x,{key:"quick-import-csv",onClick:r[1]||(r[1]=q=>V("csv"))},{default:i(()=>[s(c,{icon:"ncFileTypeCsvSmall",class:"w-4 h-4"}),Z(" "+b($.$t("labels.csvFile")),1)]),_:1})),[[D,["c:import:csv"]]]):y("",!0),e(o)("jsonImport",{roles:e(f),source:e(p)})?ye((t(),u(x,{key:"quick-import-json",onClick:r[2]||(r[2]=q=>V("json"))},{default:i(()=>[s(c,{icon:"ncFileTypeJson",class:"h-4"}),Z(" "+b($.$t("labels.jsonFile")),1)]),_:1})),[[D,["c:import:json"]]]):y("",!0),e(o)("excelImport",{roles:e(f),source:e(p)})?ye((t(),u(x,{key:"quick-import-excel",onClick:r[3]||(r[3]=q=>V("excel"))},{default:i(()=>[s(c,{icon:"ncFileTypeExcel",class:"w-4 h-4"}),Z(" "+b($.$t("labels.microsoftExcel")),1)]),_:1})),[[D,["c:import:excel"]]]):y("",!0)]),_:2},[$.$slots.expandIcon?{name:"expandIcon",fn:i(()=>[Tt($.$slots,"expandIcon")]),key:"0"}:void 0]),1032,["class","variant","title-class","popup-offset"])}}}),As=Object.assign(Zn,{__name:"DashboardTreeViewBaseOptions"}),Xn={class:"flex gap-2 items-center"},el={class:"flex gap-2 items-center"},tl={class:"flex gap-2 items-center"},sl={class:"flex gap-2 items-center"},al={class:"flex gap-2 items-center"},ol={class:"flex gap-2 items-center"},nl=Se({__name:"ActionMenu",props:{showBaseOption:{type:Function},dataReflectionState:{},dataReflectionText:{}},emits:["clickMenu","rename","openErdView","duplicateProject","openBaseSettings","copyProjectInfo","delete"],setup(R,{emit:A}){const p=R,n=A,o=ot(Lt),{appInfo:f}=Qe(),{orgRoles:N,isUIAllowed:h}=it(),V=ne(()=>o.value.project_role||o.value.workspace_role),$=ne(()=>{var r,c,x,a;return{rename:h("baseRename"),baseDuplicate:h("baseDuplicate",{roles:[na(N.value),V.value].join()}),baseOptions:(((x=(c=(r=o.value)==null?void 0:r.sources)==null?void 0:c[0])==null?void 0:x.enabled)||(((a=o.value)==null?void 0:a.sources)||[]).length>1)&&p.showBaseOption(o.value.sources[0]),baseDelete:h("baseDelete",{roles:[na(N.value),V.value].join()})}});return(r,c)=>{const x=Ge,a=qt,D=as,q=As,g=is,w=_t("e");return t(),u(g,{class:"nc-scrollbar-md !min-w-50",style:{maxHeight:"70vh",overflow:"overlay"},"data-testid":`nc-sidebar-base-${e(o).title}-options`,variant:"small",onClick:c[8]||(c[8]=k=>n("clickMenu"))},{default:i(()=>{var k,M,E;return[e(h)("baseRename")?(t(),u(a,{key:0,"data-testid":"nc-sidebar-project-rename",onClick:c[0]||(c[0]=j=>n("rename"))},{default:i(()=>[ye((t(),_("div",Xn,[s(x,{icon:"rename"}),Z(" "+b(r.$t("general.rename")),1)])),[[w,["c:base:rename"]]])]),_:1})):y("",!0),e($).baseDuplicate?(t(),u(a,{key:1,"data-testid":"nc-sidebar-base-duplicate",onClick:c[1]||(c[1]=j=>n("duplicateProject",e(o)))},{default:i(()=>[ye((t(),_("div",el,[s(x,{icon:"duplicate"}),Z(" "+b(r.$t("general.duplicate")),1)])),[[w,["c:base:duplicate"]]])]),_:1})):y("",!0),["baseDuplicate","baseRename"].some(j=>e(h)(j))?(t(),u(D,{key:2})):y("",!0),("isEeUI"in r?r.isEeUI:e(Ke))?y("",!0):(t(),u(a,{key:"copy","data-testid":"nc-sidebar-base-copy-base-info",onClick:c[2]||(c[2]=$e(j=>n("copyProjectInfo"),["stop"]))},{default:i(()=>[ye((t(),_("div",tl,[s(x,{icon:"copy"}),Z(" "+b(r.$t("activity.account.projInfo")),1)])),[[w,["c:base:copy-proj-info"]]])]),_:1})),(E=(M=(k=e(o))==null?void 0:k.sources)==null?void 0:M[0])!=null&&E.enabled?(t(),u(a,{key:"erd","data-testid":"nc-sidebar-base-relations",onClick:c[3]||(c[3]=j=>{var J,U;return n("openErdView",(U=(J=e(o))==null?void 0:J.sources)==null?void 0:U[0])})},{default:i(()=>[ye((t(),_("div",sl,[s(x,{icon:"ncErd"}),Z(" "+b(r.$t("title.relations")),1)])),[[w,["c:base:erd"]]])]),_:1})):y("",!0),e(h)("apiDocs")?ye((t(),u(a,{key:"api","data-testid":"nc-sidebar-base-rest-apis",onClick:c[4]||(c[4]=$e(j=>("openLink"in r?r.openLink:e(Ja))(`/api/v2/meta/bases/${e(o).id}/swagger`,e(f).ncSiteUrl),["stop"]))},{default:i(()=>[s(x,{icon:"ncCode",class:"opacity-80 !max-w-3.9"}),Z(" "+b(r.$t("activity.account.swagger")),1)]),_:1})),[[w,["e:api-docs"]]]):y("",!0),e($).baseOptions?(t(),_(Ce,{key:6},[s(D),s(q,{base:e(o),"onUpdate:base":c[5]||(c[5]=j=>xe(o)?o.value=j:null),source:e(o).sources[0]},null,8,["base","source"])],64)):y("",!0),["baseMiscSettings","baseDelete"].some(j=>e(h)(j))?(t(),u(D,{key:7})):y("",!0),e(h)("baseMiscSettings")?(t(),u(a,{key:"teamAndSettings","data-testid":"nc-sidebar-base-settings",class:"nc-sidebar-base-base-settings",onClick:c[6]||(c[6]=j=>n("openBaseSettings",e(o).id))},{default:i(()=>[ye((t(),_("div",al,[s(x,{icon:"settings"}),Z(" "+b(r.$t("activity.settings")),1)])),[[w,["c:base:settings"]]])]),_:1})):y("",!0),e($).baseDelete?(t(),u(a,{key:9,"data-testid":"nc-sidebar-base-delete",class:"!text-red-500 !hover:bg-red-50",onClick:c[7]||(c[7]=j=>n("delete"))},{default:i(()=>[l("div",ol,[s(x,{icon:"delete",class:"w-4"}),Z(" "+b(r.$t("general.delete")),1)])]),_:1})):y("",!0)]}),_:1},8,["data-testid"])}}}),ll=Object.assign(nl,{__name:"DashboardTreeViewProjectActionMenu"}),il={key:0,class:"flex flex-row items-center py-2.25 px-2.5 bg-gray-50 rounded-lg text-gray-700"},rl={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},cl=Se({__name:"Delete",props:{visible:{type:Boolean},tableId:{},baseId:{}},emits:["update:visible"],setup(R,{emit:A}){const p=R,o=wt(p,"visible",A),{$e:f,$api:N}=Xe(),{getMeta:h,removeMeta:V}=Ht(),{loadTables:$,baseUrl:r,isXcdbBase:c}=Ze(),{refreshCommandPalette:x}=xt(),{removeFromRecentViews:a}=lt(),{baseTables:D,activeTable:q}=se(Je()),{openTable:g}=Je(),w=ne(()=>D.value.get(p.baseId)??[]),k=ne(()=>w.value.find(j=>j.id===p.tableId)),M=T(!1),E=async()=>{var U,B,ae,Q,X,ce;if(!k.value)return;const j=JSON.parse(JSON.stringify(k.value)),J=(U=q.value)==null?void 0:U.id;M.value=!0;try{const P=await h(j.id,!0),z=(B=P==null?void 0:P.columns)==null?void 0:B.filter(de=>de.uidt===Ws.LinkToAnotherRecord&&!Qa(de));if(z!=null&&z.length&&!c(j.source_id)){const de=await Promise.all(z.map(async(we,re)=>{var ve;const le=await h((ve=we==null?void 0:we.colOptions)==null?void 0:ve.fk_related_model_id);return`${re+1}. ${we.title} is a LinkToAnotherRecord of ${le&&le.title||we.title}`}));Le.info(et("div",{innerHTML:`<div style="padding:10px 4px">Unable to delete tables because of the following.
              <br><br>${de.join("<br>")}<br><br>
              Delete them & try again</div>`}));return}if(await N.dbTable.delete(j.id),await $(),a({baseId:p.baseId,tableId:j.id}),V(j.id),x(),f("a:table:delete"),J===j.id){const de=w.value.filter(we=>we.source_id===j.source_id);de.length===0?await Zt(r({id:p.baseId,type:"database"})):await g(de[0])}else if((ae=q.value)!=null&&ae.id){const de=await h((Q=q.value)==null?void 0:Q.id);de&&((X=de.columns)!=null&&X.find(we=>Ya(we)))&&await h((ce=q.value)==null?void 0:ce.id,!0)}const ke=w.value.findIndex(de=>de.id===j.id);ke>-1&&w.value.splice(ke,1),o.value=!1}catch(P){Le.error(await qe(P))}finally{M.value=!1}};return(j,J)=>{const U=Ko,B=Ta;return t(),u(B,{visible:e(o),"onUpdate:visible":J[0]||(J[0]=ae=>xe(o)?o.value=ae:null),"entity-name":j.$t("objects.table"),"on-delete":E},{"entity-preview":i(()=>[e(k)?(t(),_("div",il,[s(U,{meta:e(k),class:"nc-view-icon"},null,8,["meta"]),l("div",rl,b(e(k).title),1)])):y("",!0)]),_:1},8,["visible","entity-name"])}}}),La=Object.assign(cl,{__name:"DlgTableDelete"}),dl=Se({__name:"Permissions",props:{visible:{type:Boolean},tableId:{},title:{}},emits:["update:visible"],setup(R){return(A,p)=>{const n=Js;return t(),u(n)}}}),ul=Object.assign(dl,{__name:"DlgTablePermissions"}),pl={class:"item","data-testid":"sidebar-view-create-grid"},ml={class:"item-inner"},vl={class:"item","data-testid":"sidebar-view-create-form"},bl={class:"item-inner"},fl={class:"item","data-testid":"sidebar-view-create-gallery"},_l={class:"item-inner"},yl={class:"item"},gl={class:"item-inner"},wl={class:"item"},xl={class:"item-inner"},kl={class:"item"},hl={class:"item-inner"},$l=Se({__name:"CreateViewBtn",props:{alignLeftLevel:{},source:{}},setup(R){const A=R,{$e:p}=Xe(),n=Ft(A,"alignLeftLevel"),o=lt(),{loadViews:f,onOpenViewCreateModal:N}=o,{isAiFeaturesEnabled:h}=Za(),V=ot(Hs),$=ot(Lt),r=T(!1),c=T(),x=T(!1),a=ne(()=>{var w;return((w=V.value)==null?void 0:w.type)==="view"}),D=ne(()=>{var w;return(w=V.value)==null?void 0:w.synced}),q=ne(()=>n.value===1?"nc-view-create-dropdown nc-view-create-dropdown-left-1":n.value===2?"nc-view-create-dropdown nc-view-create-dropdown-left-2":"nc-view-create-dropdown");async function g({title:w="",type:k,copyViewId:M,groupingFieldColumnId:E,calendarRange:j,coverImageColumnId:J}){var U;r.value||(p("c:view:create:navdraw",{view:k==="AI"?k:_a[k]}),c.value=k,r.value=!0,await f({tableId:V.value.id}),x.value=!1,r.value=!1,N({title:w,type:k,copyViewId:M,groupingFieldColumnId:E,calendarRange:j,coverImageColumnId:J,baseId:$.value.id,tableId:V.value.id,sourceId:(U=V.value)==null?void 0:U.source_id}))}return(w,k)=>{const M=fa,E=Ks,j=Ge,J=qt,U=Kt,B=as,ae=is,Q=os;return t(),u(Q,{visible:e(x),"onUpdate:visible":k[6]||(k[6]=X=>xe(x)?x.value=X:null),"overlay-class-name":e(q),"destroy-popup-on-hide":"",onClick:k[7]||(k[7]=$e(X=>x.value=!0,["stop"]))},{overlay:i(()=>[s(ae,{class:"max-w-48",variant:"medium"},{default:i(()=>{var X;return[s(J,{onClick:k[0]||(k[0]=$e(ce=>g({type:e(Fe).GRID}),["stop"]))},{default:i(()=>[l("div",pl,[l("div",ml,[s(M,{meta:{type:e(Fe).GRID}},null,8,["meta"]),l("div",null,b(w.$t("objects.viewType.grid")),1)]),e(c)===e(Fe).GRID&&e(r)?(t(),u(E,{key:0})):(t(),u(j,{key:1,class:"plus",icon:"plus"}))])]),_:1}),s(U,{title:e(D)?w.$t("tooltip.formViewCreationNotSupportedForSyncedTable"):w.$t("tooltip.sourceDataIsReadonly"),disabled:!w.source.is_data_readonly&&!e(a)&&!e(D)},{default:i(()=>[s(J,{disabled:!!w.source.is_data_readonly||e(a)||e(D),onClick:k[1]||(k[1]=ce=>g({type:e(Fe).FORM}))},{default:i(()=>[l("div",vl,[l("div",bl,[s(M,{meta:{type:e(Fe).FORM},class:G({"!opacity-50":!!w.source.is_data_readonly||e(a)||e(D)})},null,8,["meta","class"]),l("div",null,b(w.$t("objects.viewType.form")),1)]),e(c)===e(Fe).FORM&&e(r)?(t(),u(E,{key:0})):(t(),u(j,{key:1,class:G(["plus",{"!text-current":!!w.source.is_data_readonly||e(a)||e(D)}]),icon:"plus"},null,8,["class"]))])]),_:1},8,["disabled"])]),_:1},8,["title","disabled"]),s(J,{onClick:k[2]||(k[2]=ce=>g({type:e(Fe).GALLERY}))},{default:i(()=>[l("div",fl,[l("div",_l,[s(M,{meta:{type:e(Fe).GALLERY}},null,8,["meta"]),l("div",null,b(w.$t("objects.viewType.gallery")),1)]),e(c)===e(Fe).GALLERY&&e(r)?(t(),u(E,{key:0})):(t(),u(j,{key:1,class:"plus",icon:"plus"}))])]),_:1}),s(J,{"data-testid":"sidebar-view-create-kanban",onClick:k[3]||(k[3]=ce=>g({type:e(Fe).KANBAN}))},{default:i(()=>[l("div",yl,[l("div",gl,[s(M,{meta:{type:e(Fe).KANBAN}},null,8,["meta"]),l("div",null,b(w.$t("objects.viewType.kanban")),1)]),e(c)===e(Fe).KANBAN&&e(r)?(t(),u(E,{key:0})):(t(),u(j,{key:1,class:"plus",icon:"plus"}))])]),_:1}),s(J,{"data-testid":"sidebar-view-create-calendar",onClick:k[4]||(k[4]=ce=>g({type:e(Fe).CALENDAR}))},{default:i(()=>[l("div",wl,[l("div",xl,[s(M,{meta:{type:e(Fe).CALENDAR},class:"!w-4 !h-4"},null,8,["meta"]),l("div",null,b(w.$t("objects.viewType.calendar")),1)]),e(c)===e(Fe).CALENDAR&&e(r)?(t(),u(E,{key:0})):(t(),u(j,{key:1,class:"plus",icon:"plus"}))])]),_:1}),e(h)?(t(),_(Ce,{key:0},[s(B),s(U,{title:`Auto suggest views for ${((X=e(V))==null?void 0:X.title)||"the current table"}`,placement:"right"},{default:i(()=>[s(J,{"data-testid":"sidebar-view-create-ai",onClick:k[5]||(k[5]=ce=>g({type:"AI"}))},{default:i(()=>[l("div",kl,[l("div",hl,[s(j,{icon:"ncAutoAwesome",class:"!w-4 !h-4 text-nc-fill-purple-dark"}),l("div",null,b(w.$t("labels.useNocoAI")),1)])])]),_:1})]),_:1},8,["title"])],64)):y("",!0)]}),_:1})]),default:i(()=>[Tt(w.$slots,"default",{},void 0,!0)]),_:3},8,["visible","overlay-class-name"])}}}),Il=Object.assign(rt($l,[["__scopeId","data-v-a723c1d6"]]),{__name:"DashboardTreeViewCreateViewBtn"}),Dl=Is(()=>Ds(()=>import("./HRIII2IE.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(R=>R.default||R)),Cl={class:"flex flex-col gap-3"},Tl={class:"text-[10px] leading-[14px] text-gray-300 uppercase mb-1"},jl={class:"text-small leading-[18px]"},Sl={key:0},Vl={class:"text-[10px] leading-[14px] text-gray-300 uppercase mb-1"},Pl={class:"text-xs"},Ml={class:"text-[10px] leading-[14px] text-gray-300 uppercase mb-1"},Ol={class:"text-xs flex items-start gap-2"},El={class:"text-sm flex items-center w-full gap-1","data-testid":"view-item"},Bl=["data-testid"],Nl={key:2,class:"flex-1 flex"},Ll=Se({__name:"ViewsNode",props:{view:{},table:{},onValidate:{type:Function}},emits:["update:view","selectIcon","changeView","rename","delete","openModal"],setup(R,{emit:A}){const p=R,n=A,o=wt(p,"view",n),{$e:f}=Xe(),{t:N}=ws(),{isMobileMode:h,user:V}=Qe(),{isUIAllowed:$}=it(),r=ot(Lt,T()),{isNewSidebarEnabled:c}=se(Pt()),{activeView:x}=se(lt()),{getMeta:a}=Ht(),{meta:D,control:q}=$s(),{basesUser:g}=se(nt()),w=ne(()=>p.table),k=T(w.value);Gt(so,o),Gt(ao,k);const M=ot(Xa,T(!1)),E=ne(()=>{var S,H,Y,fe;if(((H=(S=r.value)==null?void 0:S.sources)==null?void 0:H.length)===1)return!0;const m=(fe=(Y=r.value)==null?void 0:Y.sources)==null?void 0:fe.find(ge=>ge.id===o.value.source_id);return m?$a(m):!1}),{openViewDescriptionDialog:j}=ot(ns),J=T(),U=T(!1),B=T(!1),ae=T(!1),Q=T(),X=T(!0),ce=ne(()=>{var m,S;return((m=o.value)==null?void 0:m.owned_by)===((S=V.value)==null?void 0:S.id)}),P=ne(()=>{var m;return(g.value.get((m=r.value)==null?void 0:m.id)||[]).reduce((S,H)=>(S[H.id]=H,S[H.email]=H,S),{})}),z=to(()=>{n("changeView",o.value)},250),ke=()=>{if(B.value||ae.value)return;(Nt()?D.value:q.value)?n("changeView",o.value):z()},de=()=>{setTimeout(()=>{var m,S;(m=J.value)==null||m.focus(),(S=J.value)==null||S.select()})};function we(){var m;h.value||!$("viewCreateOrEdit")||B.value||(B.value=!0,Q.value=o.value.title,f("c:view:rename",{view:(m=o.value)==null?void 0:m.type}),Ct(()=>{de()}))}function re(m){m.key==="Escape"?ve(m):m.key==="Enter"&&le(m)}function le(m){m.stopImmediatePropagation(),m.preventDefault(),W()}function ve(m){m.stopImmediatePropagation(),m.preventDefault(),I()}ts("Enter",m=>{B.value&&le(m)});const Ee=()=>{var m;h.value||!$("viewCreateOrEdit")||B.value||(B.value=!0,Q.value=o.value.title,f("c:view:rename",{view:(m=o.value)==null?void 0:m.type}),Ct(()=>{de()}))};async function W(){if(U.value=!1,!B.value)return;Q.value&&(Q.value=Q.value.trim());const m=p.onValidate({...o.value,title:Q.value});if(m!==!0){Le.error(m),I();return}if(o.value.title===""||o.value.title===Q.value){I();return}const S=o.value.title;o.value.title=Q.value||"",n("rename",o.value,S),ee()}const v=m=>{U.value=!1,j(m)};function I(){B.value&&ee()}function ee(){ae.value=!0,B.value=!1,Q.value="",setTimeout(()=>{ae.value=!1},250)}const pe=()=>{U.value=!1,n("delete",o.value)},me=ne(()=>{var m,S,H,Y,fe,ge,he,O,F,be,oe,Te,De,Ie,Ve,Pe,Be,Ue,ze,He,_e,te;switch((m=o.value)==null?void 0:m.lock_type){case ft.Collaborative:return N((S=_s[ft.Collaborative])==null?void 0:S.title);case ft.Personal:return`${N((H=_s[ft.Personal])==null?void 0:H.title)} ${ce.value?`(${N("general.you")})`:(Y=o.value)!=null&&Y.owned_by&&P.value[o.value.owned_by]?`(${((fe=P.value[o.value.owned_by])==null?void 0:fe.display_name)||((ge=P.value[o.value.owned_by])==null?void 0:ge.email)})`:""}`;case ft.Locked:return!((O=(he=o.value)==null?void 0:he.meta)!=null&&O.lockedByUserId)||!P.value[(be=(F=o.value)==null?void 0:F.meta)==null?void 0:be.lockedByUserId]?N((oe=_s[ft.Locked])==null?void 0:oe.title):N("title.lockedByUser",{user:((Ie=P.value[(De=(Te=o.value)==null?void 0:Te.meta)==null?void 0:De.lockedByUserId])==null?void 0:Ie.id)===((Ve=V.value)==null?void 0:Ve.id)?N("general.you"):((Ue=P.value[(Be=(Pe=o.value)==null?void 0:Pe.meta)==null?void 0:Be.lockedByUserId])==null?void 0:Ue.display_name)||((_e=P.value[(He=(ze=o.value)==null?void 0:ze.meta)==null?void 0:He.lockedByUserId])==null?void 0:_e.email)});default:return N((te=_s[ft.Collaborative])==null?void 0:te.title)}});return Ye(U,async()=>{U.value&&(k.value=await a(w.value.id))}),(m,S)=>{const H=fa,Y=Dl,fe=ss,ge=Kt,he=Ge,O=pt,F=No,be=os,oe=eo,Te=_t("e");return t(),u(oe,{class:G(["nc-sidebar-node !min-h-7 !max-h-7 !my-0.5 select-none group text-gray-700 !flex !items-center !hover:bg-gray-200 !hover:text-gray-700 cursor-pointer",{"!pl-13.5 !xs:pl-12":e(E)&&!e(c),"!pl-19":!e(E)&&!e(c),"!pl-7.5 !xs:pl-7.5":e(E)&&e(c),"!pl-14":!e(E)&&e(c)}]),"data-testid":`view-sidebar-view-${e(o).alias||e(o).title}`,onClick:$e(ke,["prevent"])},{default:i(()=>[s(ge,{"tooltip-style":{width:"240px",zIndex:"1049"},"overlay-inner-style":{width:"240px"},trigger:"hover",placement:"right",disabled:e(B)||e(U)||!e(X)},{title:i(()=>{var De,Ie,Ve,Pe,Be,Ue,ze,He,_e;return[l("div",Cl,[l("div",null,[l("div",Tl,b(m.$t("labels.viewName")),1),l("div",jl,b(e(o).alias||e(o).title),1)]),(De=e(o))!=null&&De.created_by&&e(P)[(Ie=e(o))==null?void 0:Ie.created_by]?(t(),_("div",Sl,[l("div",Vl,b(m.$t("labels.createdBy")),1),l("div",Pl,b(((Pe=e(P)[(Ve=e(o))==null?void 0:Ve.created_by])==null?void 0:Pe.id)===((Be=e(V))==null?void 0:Be.id)?m.$t("general.you"):((ze=e(P)[(Ue=e(o))==null?void 0:Ue.created_by])==null?void 0:ze.display_name)||((_e=e(P)[(He=e(o))==null?void 0:He.created_by])==null?void 0:_e.email)),1)])):y("",!0),l("div",null,[l("div",Ml,b(m.$t("labels.viewMode")),1),l("div",Ol,b(e(me)),1)])])]}),default:i(()=>{var De,Ie,Ve,Pe,Be,Ue,ze,He;return[ye((t(),_("div",El,[ye((t(),_("div",{class:"flex min-w-6","data-testid":`view-sidebar-drag-handle-${e(o).alias||e(o).title}`,onMouseenter:S[1]||(S[1]=_e=>X.value=!1),onMouseleave:S[2]||(S[2]=_e=>X.value=!0)},[s(Y,{class:"nc-table-icon",emoji:(Ie=(De=p.view)==null?void 0:De.meta)==null?void 0:Ie.icon,size:"small",clearable:!0,readonly:e(h)||!e($)("viewCreateOrEdit"),onEmojiSelected:S[0]||(S[0]=_e=>n("selectIcon",_e))},{default:i(()=>[s(H,{meta:p.view,class:"nc-view-icon w-4 !text-[16px]"},null,8,["meta"])]),_:1},8,["emoji","readonly"])],40,Bl)),[[Te,["c:view:emoji-picker"]]]),e(B)?(t(),u(fe,{key:0,ref_key:"input",ref:J,value:e(Q),"onUpdate:value":S[3]||(S[3]=_e=>xe(Q)?Q.value=_e:null),class:G(["!bg-transparent !pr-1.5 !flex-1 mr-4 !rounded-md !h-6 animate-sidebar-node-input-padding",{"!font-semibold !text-brand-600":((Ve=e(x))==null?void 0:Ve.id)===e(o).id}]),style:{fontWeight:"inherit"},onBlur:W,onKeydown:S[4]||(S[4]=$e(_e=>re(_e),["stop"]))},null,8,["value","class"])):(t(),u(ge,{key:1,class:G(["nc-sidebar-node-title text-ellipsis overflow-hidden select-none max-w-full",{"w-full":![e(ft).Locked,e(ft).Personal].includes((Pe=e(o))==null?void 0:Pe.lock_type)}]),"show-on-truncate-only":"",disabled:""},{title:i(()=>[Z(b(e(o).alias||e(o).title),1)]),default:i(()=>{var _e;return[l("div",{"data-testid":"sidebar-view-title",class:G({"font-semibold text-brand-600":((_e=e(x))==null?void 0:_e.id)===e(o).id}),style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},onDblclick:$e(we,["stop"])},b(e(o).alias||e(o).title),35)]}),_:1},8,["class"])),!e(B)&&[e(ft).Locked,e(ft).Personal].includes((Be=e(o))==null?void 0:Be.lock_type)?(t(),_("div",Nl,[(t(),u(ys(("viewLockIcons"in m?m.viewLockIcons:e(_s))[e(o).lock_type].icon),{class:G(["ml-1 flex-none w-3.5 h-3.5",{"text-brand-400":((Ue=e(o))==null?void 0:Ue.lock_type)===e(ft).Personal&&e(ce),"text-gray-400":!(((ze=e(o))==null?void 0:ze.lock_type)===e(ft).Personal&&e(ce))}])},null,8,["class"]))])):y("",!0),!e(B)&&!e(M)?(t(),_(Ce,{key:3},[(He=e(o).description)!=null&&He.length?(t(),u(ge,{key:0,placement:"bottom",onMouseenter:S[5]||(S[5]=_e=>X.value=!1),onMouseleave:S[6]||(S[6]=_e=>X.value=!0)},{title:i(()=>[Z(b(e(o).description),1)]),default:i(()=>[s(O,{type:"text",class:"!hover:bg-transparent",size:"xsmall"},{default:i(()=>[s(he,{icon:"info",class:"!w-3.5 !h-3.5 nc-info-icon group-hover:opacity-100 text-gray-600 opacity-0"})]),_:1})]),_:1})):y("",!0),s(be,{visible:e(U),"onUpdate:visible":S[13]||(S[13]=_e=>xe(U)?U.value=_e:null),"overlay-class-name":"!rounded-lg"},{overlay:i(()=>[s(F,{"data-testid":`view-sidebar-view-actions-${e(o).alias||e(o).title}`,view:e(o),table:e(w),"in-sidebar":"",onCloseModal:S[11]||(S[11]=_e=>U.value=!1),onRename:Ee,onDelete:pe,onDescriptionUpdate:S[12]||(S[12]=_e=>v(e(o)))},null,8,["data-testid","view","table"])]),default:i(()=>[ye((t(),u(O,{type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn invisible !group-hover:visible !group-hover:opacity-100 nc-sidebar-view-node-context-btn",{"!visible !opacity-100":e(U)}]),onClick:S[7]||(S[7]=$e(_e=>U.value=!e(U),["stop"])),onDblclick:S[8]||(S[8]=$e(()=>{},["stop"])),onMouseenter:S[9]||(S[9]=_e=>X.value=!1),onMouseleave:S[10]||(S[10]=_e=>X.value=!0)},{default:i(()=>[s(he,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:1},8,["class"])),[[Te,["c:view:option"]]])]),_:1},8,["visible"])],64)):y("",!0)])),[[Te,["a:view:open",{view:e(o).type}]]])]}),_:1},8,["disabled"])]),_:1},8,["class","data-testid"])}}}),Ul=Object.assign(Ll,{__name:"DashboardTreeViewViewsNode"}),Rl={class:"flex flex-row items-center pl-1.25 !py-1.5 text-inherit"},Al={class:"pl-1.75"},zl=Se({__name:"ViewsList",emits:["openModal","deleted"],setup(R,{emit:A}){const p=A,n=ot(Lt),o=ot(Hs),{isLeftSidebarOpen:f,isNewSidebarEnabled:N}=se(Pt()),{activeTableId:h}=se(Je()),{isUIAllowed:V}=it(),{isMobileMode:$}=Qe(),{baseHomeSearchQuery:r}=se(nt()),{isSharedBase:c}=se(Ze()),{$e:x}=Xe(),{t:a}=ws(),{viewsByTable:D,activeView:q,allRecentViews:g}=se(lt()),{navigateToTable:w}=Je(),k=ne(()=>{var m;return((m=D.value.get(o.value.id))==null?void 0:m.filter(S=>!S.is_default))??[]}),{api:M}=es(),{refreshCommandPalette:E}=xt(),{addUndo:j,defineModelScope:J}=Bs(),{navigateToView:U,loadViews:B,removeFromRecentViews:ae}=lt(),Q=T([]),X=T(!1),ce=T(),P=T(!1);Ye(q,m=>{m&&m.id&&(Q.value=[m.id])});function z(m){P.value=m,setTimeout(()=>{P.value=!1},300)}const ke=ne(()=>{var m,S;return(S=(m=n.value)==null?void 0:m.sources)==null?void 0:S.find(H=>H.id===o.value.source_id)}),de=ne(()=>{var m,S;return((S=(m=n.value)==null?void 0:m.sources)==null?void 0:S.length)===1?!0:ke.value?$a(ke.value):!1});function we(m){return!m.title||m.title.trim().length<0?a("msg.error.viewNameRequired"):k.value.some(S=>S.title===m.title&&S.id!==m.id)?a("msg.error.viewNameDuplicate"):!0}let re;function le(m){m.stopImmediatePropagation(),m.preventDefault(),X.value=!0}async function ve(m,S=!1){if(S||(m.stopImmediatePropagation(),m.preventDefault(),X.value=!1),k.value.length<2)return;let{newIndex:H=0,oldIndex:Y=0}=m;if(H=H-1,Y=Y-1,H===Y)return;S||j({redo:{fn:async()=>{const De=re.toArray(),Ie=De.splice(Y,1);De.splice(H,0,Ie[0]),re.sort(De),await ve(m,!0)},args:[]},undo:{fn:async()=>{const De=re.toArray(),Ie=De.splice(H,1);De.splice(Y,0,Ie[0]),re.sort(De),await ve({...m,oldIndex:H,newIndex:Y},!0)},args:[]},scope:J({view:q.value})});const fe=Array.from(m.to.children);fe.shift();const ge=fe[H-1],he=fe[H+1],O=k.value.find(De=>De.id===m.item.id);if(!O||!O.id)return;const F=ge?k.value.find(De=>De.id===ge.id)??{order:0}:{order:0},be=he?k.value.find(De=>De.id===he.id):{};let oe;k.value.length-1===H?oe=parseFloat(String(F.order))+1:H===0?oe=parseFloat(String(be.order))/2:oe=(parseFloat(String(F.order))+parseFloat(String(be.order)))/2;const Te=isNaN(Number(oe))?Y:oe;O.order=Te,await M.dbView.update(O.id,{order:Te}),z(O.id),x("a:view:reorder")}const Ee=m=>{re&&re.destroy(),!$.value&&(re=new Da(m,{ghostClass:"ghost",onStart:le,onEnd:ve,filter:Ls}))};hs(()=>ce.value&&V("viewCreateOrEdit")&&Ee(ce.value.$el));async function W(m){await U({view:m,tableId:o.value.id,baseId:n.value.id,hardReload:m.type===Fe.FORM&&Q.value[0]===m.id,doNotSwitchTab:!0}),$.value&&(f.value=!1)}async function v(m,S,H=!1){try{await M.dbView.update(m.id,{title:m.title,order:m.order}),U({view:m,tableId:o.value.id,baseId:n.value.id,hardReload:m.type===Fe.FORM&&Q.value[0]===m.id}),E(),H||j({redo:{fn:(Y,fe)=>{const ge=Y.title;Y.title=fe,v(Y,ge,!0)},args:[m,m.title]},undo:{fn:(Y,fe)=>{const ge=Y.title;Y.title=fe,v(Y,ge,!0)},args:[m,S]},scope:J({view:q.value})}),g.value=g.value.map(Y=>(Y.viewId===m.id&&Y.tableID===m.fk_model_id&&(Y.viewName=m.title),Y))}catch(Y){Le.error(await qe(Y))}}function I(m){const S=T(!0),{close:H}=at(Lo,{modelValue:S,view:m,"onUpdate:modelValue":Y,onDeleted:async()=>{var fe;Y(),p("deleted"),ae({viewId:m.id,tableId:m.fk_model_id,baseId:n.value.id}),E(),((fe=q.value)==null?void 0:fe.id)===m.id&&w({tableId:o.value.id,baseId:n.value.id}),await B({tableId:o.value.id,force:!0})}});function Y(){S.value=!1,H(1e3)}}const ee=async(m,S)=>{try{S.meta={...Xt(S.meta),icon:m},M.dbView.update(S.id,{meta:S.meta}),x("a:view:icon:sidebar",{icon:m})}catch(H){Le.error(await qe(H))}};function pe({title:m="",type:S,copyViewId:H,groupingFieldColumnId:Y,calendarRange:fe,coverImageColumnId:ge}){var be;const he=T(!0),{close:O}=at(no,{modelValue:he,title:m,type:S,tableId:o.value.id,selectedViewId:H,groupingFieldColumnId:Y,views:k,calendarRange:fe,coverImageColumnId:ge,baseId:n.value.id,sourceId:(be=ke.value)==null?void 0:be.id,"onUpdate:modelValue":F,onCreated:async oe=>{F(),E(),await B({force:!0,tableId:o.value.id}),oe&&U({view:oe,tableId:o.value.id,baseId:n.value.id,hardReload:oe.type===Fe.FORM&&Q.value[0]===oe.id}),x("a:view:create",{view:(oe==null?void 0:oe.type)||S})}});function F(){he.value=!1,O(1e3)}}const me=ne(()=>k.value.filter(m=>gs(m.title,r.value)));return(m,S)=>{const H=Ge,Y=Il,fe=Ul,ge=oo;return t(),u(ge,{ref_key:"menuRef",ref:ce,class:G([{dragging:e(X)},"nc-views-menu flex flex-col w-full !border-r-0 !bg-inherit"]),"selected-keys":e(Q)},{default:i(()=>[e(c)?y("",!0):(t(),_(Ce,{key:0},[e(V)("viewCreateOrEdit")?(t(),u(Y,{key:0,"align-left-level":e(de)?1:2,class:G({"!pl-13.3 !xs:pl-13.5":e(de)&&!e(N),"!pl-18.6 !xs:pl-20":!e(de)&&!e(N),"!pl-7.5 !xs:pl-7.5":e(de)&&e(N),"!pl-13.6 !xs:pl-15":!e(de)&&e(N)}),source:e(ke)},{default:i(()=>[l("div",{class:G([{"text-brand-500 hover:text-brand-600":e(h)===e(o).id,"text-gray-500 hover:text-brand-500":e(h)!==e(o).id},"nc-create-view-btn flex flex-row items-center cursor-pointer rounded-md w-full"]),role:"button"},[l("div",Rl,[s(H,{icon:"plus",class:"nc-create-view-btn-icon"}),l("div",Al,b(m.$t("general.createEntity",{entity:m.$t("objects.view")})),1)])],2)]),_:1},8,["align-left-level","class","source"])):y("",!0)],64)),e(me).length?(t(!0),_(Ce,{key:1},ks(e(me),he=>{var O;return t(),u(fe,{id:he.id,key:he.id,class:G([{"bg-gray-200":e(P)===he.id,active:((O=e(q))==null?void 0:O.id)===he.id,[`nc-${he.type?e(_a)[he.type]:he.type}-view-item`]:!0},"nc-view-item !rounded-md !px-0.75 !py-0.5 w-full transition-all ease-in duration-100"]),"data-view-id":he.id,"on-validate":we,table:e(o),view:he,onDelete:I,onRename:v,onChangeView:W,onOpenModal:pe,onSelectIcon:F=>ee(F,he)},null,8,["id","class","data-view-id","table","view","onSelectIcon"])}),128)):y("",!0)]),_:1},8,["class","selected-keys"])}}}),Wl=Object.assign(zl,{__name:"DashboardTreeViewViewsList"}),Fl={class:"nc-icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Gl(R,A){return t(),_("svg",Fl,A[0]||(A[0]=[l("path",{fill:"currentColor",d:"M12 9a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5a5 5 0 0 1 5-5a5 5 0 0 1 5 5a5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"},null,-1)]))}const Hl=lo({name:"mdi-eye",render:Gl}),Kl=Is(()=>Ds(()=>import("./HRIII2IE.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(R=>R.default||R)),ql=Is(()=>Ds(()=>import("./2EkCyFsn.js"),__vite__mapDeps([5,6,1,2]),import.meta.url).then(R=>R.default||R)),Jl=["data-order","data-id","data-table-id","data-active"],Ql={class:"flex items-center py-0.5"},Yl=["data-testid"],Zl={class:"flex flex-row h-full items-center"},Xl=["data-testid"],ei=["data-testid"],ti={key:2,class:"flex items-center"},si={class:"flex gap-2 items-center"},ai={class:"flex gap-2 items-center"},oi={class:"flex gap-2 items-center"},ni={class:"flex gap-2 items-center"},li={class:"flex gap-2 items-center w-full"},ii={class:"flex-1"},ri={class:"flex gap-2 items-center"},ci=Se({__name:"TableNode",props:{base:{},table:{},sourceIndex:{default:0}},setup(R){const A=R,{base:p,table:n,sourceIndex:o}=xs(A),{openTable:f}=la({baseId:p.value.id}),{isNewSidebarEnabled:N}=se(Pt()),h=io(),{isUIAllowed:V}=it(),{isMobileMode:$}=Qe(),{$e:r,$api:c}=Xe(),{isMysql:x,isPg:a}=Ze();la({baseId:p.value.id});const{meta:D,control:q}=$s(),g=ot(ya);Gt(Hs,n);const{setMenuContext:w,handleTableRename:k,openTableDescriptionDialog:M,duplicateTable:E,tableRenameId:j}=ot(ns),{loadViews:J,navigateToView:U,duplicateView:B}=lt(),{activeView:ae,activeViewTitleOrId:Q,viewsByTable:X}=se(lt()),{isLeftSidebarOpen:ce}=se(Pt()),{refreshCommandPalette:P}=xt(),{showRecordPlanLimitExceededModal:z}=ro(),{isTableAndFieldPermissionsEnabled:ke}=qo(),{baseTables:de}=se(Je()),we=ne(()=>de.value.get(p.value.id)??[]),re=ne(()=>h.params.viewId),le=ne(()=>{var C,K;return(K=(C=p.value)==null?void 0:C.sources)==null?void 0:K[o.value]}),ve=T(!1),Ee=T(!1),W=T(!1),v=T(),I=T(!1),ee=T(!1),pe=Os.useForm,me=Ns({title:""}),m=ne(()=>({title:[co,{validator:(C,K)=>new Promise((Me,ct)=>{var Ut,dt,ut;let Re=255;if(x((Ut=le.value)==null?void 0:Ut.id)?Re=64:a((dt=le.value)==null?void 0:dt.id)&&(Re=63),((((ut=p==null?void 0:p.value)==null?void 0:ut.prefix)||"")+K).length>Re)return ct(new Error(`Table name exceeds ${Re} characters`));Me()})},{validator:(C,K)=>new Promise((Me,ct)=>{if(!((we==null?void 0:we.value)||[]).every(Re=>Re.id===n.value.id||Re.title.toLowerCase()!==((K==null?void 0:K.trim())||"").toLowerCase()))return ct(new Error("Duplicate table alias"));Me()})}]})),{validate:S}=pe(me,m),H=async(C,K)=>{try{K.meta={...K.meta||{},icon:C},we.value.splice(we.value.indexOf(K),1,{...K}),await c.dbTable.update(K.id,{meta:K.meta}),r("a:table:icon:navdraw",{icon:C})}catch(Me){Le.error(await qe(Me))}},{isSharedBase:Y}=Ze(),fe=ne(()=>V("tableIconEdit",{roles:g==null?void 0:g.value})),ge=T(!1),he=T(!1),O=async()=>{if(ge.value){ge.value=!1;return}he.value=!0;try{await J({tableId:n.value.id,ignoreLoading:!0})}catch(C){Le.error(await qe(C))}finally{he.value=!1,ge.value=!0}},F=async()=>{if(!(I.value||ee.value)){if(Nt()?D.value:q.value){await f(n.value,!0);return}he.value=!0;try{await f(n.value),$.value&&(ce.value=!1)}catch(C){Le.error(await qe(C))}finally{he.value=!1,ge.value=!0}}};Ye(()=>{var C;return(C=ae.value)==null?void 0:C.id},()=>{var C,K;ae.value&&((C=ae.value)==null?void 0:C.fk_model_id)===((K=n.value)==null?void 0:K.id)&&(ge.value=!0)},{immediate:!0});const be=ne(()=>{var C,K;return re.value===((C=n.value)==null?void 0:C.id)&&(((K=ae.value)==null?void 0:K.is_default)||!Q.value)});let oe;Ye(re,()=>{var C;if(oe&&clearTimeout(oe),n.value.id!==re.value&&ge.value){if((((C=X.value.get(n.value.id))==null?void 0:C.filter(Me=>!Me.is_default))??[]).length)return;oe=setTimeout(()=>{ge.value&&(ge.value=!1),clearTimeout(oe)},1e4)}});const Te=C=>{W.value=!1,!z()&&E(C)},De=()=>{setTimeout(()=>{var C,K;(C=v.value)==null||C.focus(),(K=v.value)==null||K.select()})},Ie=C=>{$.value||!V("tableRename",{roles:g==null?void 0:g.value,source:le.value})||(W.value=!1,I.value||(I.value=!0,me.title=C.title,Ct(()=>{De()})))};Ye(j,(C,K)=>{var Me;C!==K&&(C&&`${n.value.id}:${(Me=le.value)==null?void 0:Me.id}`===j.value?Ie(n.value):(I.value=!1,_e()))},{immediate:!0});const Ve=C=>{W.value=!1,M(C)},Pe=()=>{W.value=!1,ve.value=!0},Be=T(!1);async function Ue(){Be.value=!0,X.value.get(n.value.id)||await f(n.value,void 0,!1);const C=X.value.get(n.value.id),K=(C==null?void 0:C.find(Me=>Me.is_default))||(C==null?void 0:C[0]);if(K){const Me=await B(K);P(),await J({force:!0,tableId:n.value.id}),Me&&(U({view:Me,tableId:n.value.id,baseId:p.value.id,hardReload:Me.type===Fe.FORM}),r("a:view:create",{view:Me.type,sidebar:!0}))}Be.value=!1,W.value=!1}async function ze(C){W.value=!1,Ee.value=!0}const He=async()=>{ge.value=!1,await Ct(),ge.value=!0};function _e(){I.value&&te()}function te(){ee.value=!0,I.value=!1,me.title="",j.value="",setTimeout(()=>{ee.value=!1},250)}function jt(C){C.key==="Escape"?tt(C):C.key==="Enter"&&mt(C)}function mt(C){C.stopImmediatePropagation(),C.preventDefault(),vt()}function tt(C){C.stopImmediatePropagation(),C.preventDefault(),_e()}ts("Enter",C=>{I.value&&mt(C)});const ht=async()=>{var C,K,Me;try{return await S(),!0}catch(ct){console.log("e",ct);const Re=(Me=(K=(C=ct.errorFields)==null?void 0:C[0])==null?void 0:K.errors)==null?void 0:Me[0];Re&&Le.error(Re)}};async function vt(){var ct;if(!I.value)return;if(!((ct=me.title)!=null&&ct.trim())||n.value.title===me.title){_e();return}if(!await ht()){_e();return}const K=n.value.title;n.value.title=me.title.trim()||"";const Me=Re=>{n.value.title=Re};k(n.value,me.title,K,Me),te(),_e()}return(C,K)=>{var Ot,Yt,Ss,cs,Vs;const Me=Ks,ct=Hl,Re=Kt,Jt=Kl,Ut=ss,dt=Os,ut=Ge,Qt=pt,L=uo,d=Ca,ie=qt,je=as,$t=ql,St=Ho,Rt=is,Mt=os,Ts=La,rs=ul,js=Wl,bt=_t("e");return t(),_("div",{class:G(["nc-tree-item nc-table-node-wrapper text-sm select-none w-full",[`nc-base-tree-tbl nc-base-tree-tbl-${(Ot=e(n).title)==null?void 0:Ot.replaceAll(" ","")}`]]),"data-order":e(n).order,"data-id":e(n).id,"data-table-id":e(n).id,"data-active":e(re)===e(n).id},[l("div",Ql,[ye((t(),_("div",{class:G(["flex-none flex-1 table-context flex items-center gap-1 h-full nc-tree-item-inner nc-sidebar-node pr-0.75 mb-0.25 rounded-md h-7 w-full group cursor-pointer hover:bg-gray-200",{"hover:bg-gray-200":e(re)!==e(n).id,"pl-13.5 !xs:pl-12":e(o)!==0&&!e(N),"pl-7.5 xs:pl-6":e(o)===0&&!e(N),"pl-8 !xs:pl-7":e(o)!==0&&e(N),"pl-2 xs:pl-2":e(o)===0&&e(N),"!bg-primary-selected":e(be)}]),"data-testid":`nc-tbl-side-node-${e(n).title}`,onContextmenu:K[13]||(K[13]=We=>e(w)("table",e(n))),onClick:F},[l("div",Zl,[l("div",{class:"flex w-auto","data-testid":`tree-view-table-draggable-handle-${e(n).title}`},[e(n).isViewsLoading?(t(),u(Me,{key:0,class:"flex items-center w-6 h-full !text-gray-600"})):ye((t(),_("div",{key:1,class:G(["flex items-center nc-table-icon min-w-6",{"pointer-events-none":!e(fe)}]),onClick:K[1]||(K[1]=$e(()=>{},["stop"]))},[(t(),u(Jt,{key:(Yt=e(n).meta)==null?void 0:Yt.icon,emoji:(Ss=e(n).meta)==null?void 0:Ss.icon,size:"small",readonly:!e(fe)||e($),onEmojiSelected:K[0]||(K[0]=We=>H(We,e(n)))},{default:i(({isOpen:We})=>[s(Re,{class:"flex",placement:"topLeft","hide-on-click":"",disabled:!e(fe)||We},{title:i(()=>[Z(b(C.$t("general.changeIcon")),1)]),default:i(()=>{var At;return[(At=e(n))!=null&&At.synced?(t(),u(ys(("iconMap"in C?C.iconMap:e(ia)).ncZap),{key:0,class:G(["w-4 text-sm",e(be)?"!text-brand-600/85":"!text-gray-600/75"])},null,8,["class"])):e(n).type==="table"?(t(),u(ys(("iconMap"in C?C.iconMap:e(ia)).table),{key:1,class:G(["w-4 text-sm",e(be)?"!text-brand-600/85":"!text-gray-600/75"])},null,8,["class"])):(t(),u(ct,{key:2,class:G(["flex w-5 text-sm",e(be)?"!text-brand-600":"!text-gray-600"])},null,8,["class"]))]}),_:2},1032,["disabled"])]),_:1},8,["emoji","readonly"]))],2)),[[bt,["c:table:emoji-picker"]]])],8,Xl)]),e(I)?(t(),u(dt,{key:0,model:e(me),name:"rename-table-form",class:"w-full",onFinish:K[4]||(K[4]=$e(()=>{},["prevent"]))},{default:i(()=>[s(Ut,{ref_key:"input",ref:v,value:e(me).title,"onUpdate:value":K[2]||(K[2]=We=>e(me).title=We),class:G(["!bg-transparent !pr-1.5 !flex-1 mr-4 !rounded-md !h-6 animate-sidebar-node-input-padding",{"!font-semibold !text-brand-600":e(be)}]),style:{fontWeight:"inherit"},onBlur:vt,onKeydown:K[3]||(K[3]=$e(We=>jt(We),["stop"]))},null,8,["value","class"])]),_:1},8,["model"])):(t(),u(Re,{key:1,class:"nc-tbl-title nc-sidebar-node-title text-ellipsis overflow-hidden select-none !flex-1","show-on-truncate-only":""},{title:i(()=>[Z(b(e(n).title),1)]),default:i(()=>[l("span",{class:G(e(be)?"text-brand-600 font-semibold":"text-gray-700"),"data-testid":`nc-tbl-title-${e(n).title}`,style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},onDblclick:K[5]||(K[5]=$e(We=>Ie(e(n)),["stop"]))},b(e(n).title),43,ei)]),_:1})),e(I)?y("",!0):(t(),_("div",ti,[(cs=e(n).description)!=null&&cs.length?(t(),u(Re,{key:0,placement:"bottom"},{title:i(()=>[Z(b(e(n).description),1)]),default:i(()=>[s(Qt,{type:"text",class:"!hover:bg-transparent",size:"xsmall"},{default:i(()=>[s(ut,{icon:"info",class:"!w-3.5 !h-3.5 nc-info-icon group-hover:opacity-100 text-gray-600 opacity-0"})]),_:1})]),_:1})):y("",!0),s(Mt,{visible:e(W),"onUpdate:visible":K[11]||(K[11]=We=>xe(W)?W.value=We:null),trigger:["click"],onClick:K[12]||(K[12]=$e(()=>{},["stop"]))},{overlay:i(()=>[s(Rt,{class:"!min-w-62.5","data-testid":`sidebar-table-context-menu-list-${e(n).title}`,variant:"small"},{default:i(()=>{var We,At,Ps,Ms;return[e(n)?(t(),u(d,{key:0,id:e(n).id,tooltip:C.$t("labels.clickToCopyTableID"),label:C.$t("labels.tableIdColon",{tableId:e(n).id})},null,8,["id","tooltip","label"])):y("",!0),e(V)("tableDescriptionEdit",{roles:e(g),source:e(le)})&&!e(V)("tableRename",{roles:e(g),source:e(le)})?(t(),u(ie,{key:1,"data-testid":`sidebar-table-description-${e(n).title}`,class:"nc-table-description",onClick:K[7]||(K[7]=zt=>Ve(e(n)))},{default:i(()=>[ye((t(),_("div",si,[s(ut,{icon:"ncAlignLeft",class:"opacity-80"}),Z(" "+b(C.$t("labels.editTableDescription")),1)])),[[bt,["c:table:update-description"]]])]),_:1},8,["data-testid"])):y("",!0),!e(Y)&&(e(V)("tableRename",{roles:e(g),source:e(le)})||e(V)("tableDelete",{roles:e(g),source:e(le)}))?(t(),_(Ce,{key:2},[s(je),e(V)("tableRename",{roles:e(g),source:e(le)})?(t(),u(ie,{key:0,"data-testid":`sidebar-table-rename-${e(n).title}`,class:"nc-table-rename",onClick:K[8]||(K[8]=zt=>Ie(e(n)))},{default:i(()=>[ye((t(),_("div",ai,[s(ut,{icon:"rename",class:"opacity-80"}),Z(" "+b(C.$t("general.rename"))+" "+b(C.$t("objects.table").toLowerCase()),1)])),[[bt,["c:table:rename"]]])]),_:1},8,["data-testid"])):y("",!0),e(V)("tableDuplicate",{source:e(le)})&&((We=e(le))!=null&&We.is_meta||(At=e(le))!=null&&At.is_local)?(t(),u(ie,{key:1,"data-testid":`sidebar-table-duplicate-${e(n).title}`,onClick:K[9]||(K[9]=zt=>Te(e(n)))},{default:i(()=>[ye((t(),_("div",oi,[s(ut,{icon:"duplicate",class:"opacity-80"}),Z(" "+b(C.$t("general.duplicate"))+" "+b(C.$t("objects.table").toLowerCase()),1)])),[[bt,["c:table:duplicate"]]])]),_:1},8,["data-testid"])):y("",!0),s(je),e(V)("tableDescriptionEdit",{roles:e(g),source:e(le)})?(t(),u(ie,{key:2,"data-testid":`sidebar-table-description-${e(n).title}`,class:"nc-table-description",onClick:K[10]||(K[10]=zt=>Ve(e(n)))},{default:i(()=>[ye((t(),_("div",ni,[s(ut,{icon:"ncAlignLeft",class:"opacity-80"}),Z(" "+b(C.$t("labels.editTableDescription")),1)])),[[bt,["c:table:update-description"]]])]),_:1},8,["data-testid"])):y("",!0),e(ke)&&("isEeUI"in C?C.isEeUI:e(Ke))&&e(V)("tableDuplicate",{source:e(le)})&&((Ps=e(le))!=null&&Ps.is_meta||(Ms=e(le))!=null&&Ms.is_local)?(t(),u(St,{key:3,feature:e(zs).FEATURE_TABLE_AND_FIELD_PERMISSIONS},{default:i(({click:zt})=>[s(ie,{"data-testid":`sidebar-table-permissions-${e(n).title}`,class:"nc-table-permissions",onClick:Zs=>zt(e(zs).FEATURE_TABLE_AND_FIELD_PERMISSIONS,()=>{ze(e(n))})},{default:i(()=>[ye((t(),_("div",li,[s(ut,{icon:"ncLock",class:"opacity-80"}),l("div",ii,b(C.$t("title.editTablePermissions")),1),s($t,{feature:e(zs).FEATURE_TABLE_AND_FIELD_PERMISSIONS,title:C.$t("upgrade.upgradeToUseTableAndFieldPermissions"),content:C.$t("upgrade.upgradeToUseTableAndFieldPermissionsSubtitle",{plan:e(po).PLUS}),"on-click-callback":()=>{W.value=!1},size:"xs"},null,8,["feature","title","content","on-click-callback"])])),[[bt,["c:table:permissions"]]])]),_:2},1032,["data-testid","onClick"])]),_:1},8,["feature"])):y("",!0),s(je),s(ie,{onClick:Ue},{default:i(()=>[e(Be)?(t(),u(Me,{key:0,size:"regular"})):(t(),u(ut,{key:1,class:"nc-view-copy-icon opacity-80",icon:"duplicate"})),Z(" "+b(C.$t("general.duplicateEntity",{entity:C.$t("title.defaultView").toLowerCase()})),1)]),_:1}),s(je),e(V)("tableDelete",{roles:e(g),source:e(le)})?(t(),u(ie,{key:4,"data-testid":`sidebar-table-delete-${e(n).title}`,class:"!text-red-500 !hover:bg-red-50 nc-table-delete",disabled:e(n).synced,onClick:Pe},{default:i(()=>[ye((t(),_("div",ri,[s(ut,{icon:"delete",class:"opacity-80"}),Z(" "+b(C.$t("general.delete"))+" "+b(C.$t("objects.table").toLowerCase()),1)])),[[bt,["c:table:delete"]]])]),_:1},8,["data-testid","disabled"])):y("",!0)],64)):y("",!0)]}),_:1},8,["data-testid"])]),default:i(()=>[ye((t(),u(Qt,{class:G(["nc-sidebar-node-btn nc-tbl-context-menu text-gray-700 hover:text-gray-800",{"!opacity-100 !inline-block":e(W)}]),"data-testid":"nc-sidebar-table-context-menu",type:"text",size:"xxsmall",onClick:K[6]||(K[6]=$e(()=>{},["stop"]))},{default:i(()=>[s(L,{class:"!text-current"})]),_:1},8,["class"])),[[bt,["c:table:option"]]])]),_:1},8,["visible"]),ye((t(),u(Qt,{type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn nc-sidebar-expand text-gray-700 hover:text-gray-800",{"!opacity-100 !visible":e(W)}]),onClick:$e(O,["stop"])},{default:i(()=>[s(ut,{icon:"chevronRight",class:G(["nc-sidebar-source-node-btns cursor-pointer transform transition-transform duration-200 !text-current text-[20px]",{"!rotate-90":e(ge)}])},null,8,["class"])]),_:1},8,["class"])),[[bt,["c:table:toggle-expand"]]])]))],42,Yl)),[[bt,["a:table:open"]]])]),e(n).id&&((Vs=e(p))!=null&&Vs.id)?(t(),u(Ts,{key:0,visible:e(ve),"onUpdate:visible":K[14]||(K[14]=We=>xe(ve)?ve.value=We:null),"table-id":e(n).id,"base-id":e(p).id},null,8,["visible","table-id","base-id"])):y("",!0),e(n).id&&("isEeUI"in C?C.isEeUI:e(Ke))?(t(),u(rs,{key:1,visible:e(Ee),"onUpdate:visible":K[15]||(K[15]=We=>xe(Ee)?Ee.value=We:null),"table-id":e(n).id,title:e(n).title},null,8,["visible","table-id","title"])):y("",!0),e(ge)?(t(),u(js,{key:2,"table-id":e(n).id,"base-id":e(p).id,onDeleted:He},null,8,["table-id","base-id"])):y("",!0)],10,Jl)}}}),di=Object.assign(rt(ci,[["__scopeId","data-v-046704cb"]]),{__name:"DashboardTreeViewTableNode"}),ui={class:"border-none sortable-list"},pi=["nc-source"],mi=Se({__name:"TableList",props:{base:{},sourceIndex:{default:0},showCreateTableBtn:{type:Boolean,default:!1}},emits:["createTable"],setup(R,{emit:A}){const p=R,n=A,o=Ft(p,"base"),f=Ft(p,"sourceIndex"),N=ne(()=>{var U,B;return(B=(U=o.value)==null?void 0:U.sources)==null?void 0:B[f.value]}),{isMobileMode:h}=Qe(),{isUIAllowed:V}=it(),{isNewSidebarEnabled:$}=se(Pt()),{openedProject:r,baseHomeSearchQuery:c}=se(nt()),{baseTables:x}=se(Je()),a=ne(()=>x.value.get(o.value.id)??[]),{viewsByTable:D}=se(lt()),{$api:q}=Xe(),g=ne(()=>a.value.reduce((U,B)=>(U[B.id]=B,U),{})),w=T({}),k=T(),M={},E=U=>{const B=U.getAttribute("nc-source");B&&(h.value||(M[B]&&M[B].destroy(),Da.create(U,{onEnd:async ae=>{var ve,Ee;const Q=a.value.findIndex(W=>W.source_id===B),{newIndex:X=0,oldIndex:ce=0}=ae;if(X===ce)return;const P=ae.item,z=g.value[P.dataset.id],ke=ae.to.children;if(ke.length<2)return;const de=ke[X-1],we=ke[X+1],re=de&&g.value[de.dataset.id],le=we&&g.value[we.dataset.id];ke.length-1===ae.newIndex?z.order=re.order+1:X===0?z.order=le.order/2:z.order=(re.order+le.order)/2,(Ee=a.value)==null||Ee.splice(X+Q,0,...(ve=a.value)==null?void 0:ve.splice(ce+Q,1)),w.value[B]?w.value[B]=w.value[B]+1:w.value[B]=1,await q.dbTable.reorder(z.id,{order:z.order})},animation:150,setData(ae,Q){ae.setData("text/json",JSON.stringify({id:Q.dataset.id,title:Q.dataset.title,type:Q.dataset.type,sourceId:Q.dataset.sourceId}))},revertOnSpill:!0,filter:Ls})))};ma(()=>{k.value&&V("viewCreateOrEdit")&&(k.value instanceof HTMLElement?E(k.value):k.value.forEach(U=>E(U)))});const j=ne(()=>a.value.filter(U=>{var B,ae;return U.source_id===((ae=(B=o.value)==null?void 0:B.sources)==null?void 0:ae[f.value].id)})),J=ne(()=>j.value.filter(U=>{var B;return gs(U.title,c.value)||((B=D.value.get(U.id))==null?void 0:B.some(ae=>gs(ae.title,c.value)))}));return(U,B)=>{var Q,X,ce,P,z,ke,de,we;const ae=Ge;return t(),_("div",ui,[e(o)?(t(),_(Ce,{key:0},[!e(j).length&&e($)&&U.showCreateTableBtn?(t(),_("div",{key:0,class:G([{"text-brand-500 hover:text-brand-600":((Q=e(r))==null?void 0:Q.id)===e(o).id,"text-gray-500 hover:text-brand-500":((X=e(r))==null?void 0:X.id)!==e(o).id},"nc-create-table-btn flex flex-row items-center cursor-pointer rounded-md w-full"]),role:"button",onClick:B[0]||(B[0]=re=>n("createTable"))},[l("div",{class:G({"nc-project-home-section-item":e($),"flex flex-row items-center pl-1.25 !py-1.5 text-inherit":!e($)})},[s(ae,{icon:"plus"}),l("div",null,b(U.$t("general.createEntity",{entity:U.$t("objects.table")})),1)],2)],2)):y("",!0),!e(j).length||!e(J).length?(t(),_("div",{key:1,class:G(["py-0.5 text-gray-500 font-normal",{"ml-8.5":e(f)===0&&!e($),"ml-14.5 xs:ml-15.25":e(f)!==0&&!e($),"nc-project-home-section-item":e(f)===0&&e($),"ml-9 xs:ml-9.75":e(f)!==0&&e($)}])},b(e(j).length&&!e(J).length?U.$t("placeholder.noResultsFoundForYourSearch"):U.$t("placeholder.noTables")),3)):y("",!0),(ce=e(o).sources)!=null&&ce[e(f)]&&e(o).sources[e(f)].enabled?(t(),_("div",{ref_key:"menuRefs",ref:k,key:`sortable-${(P=e(N))==null?void 0:P.id}-${(z=e(N))!=null&&z.id&&((ke=e(N))==null?void 0:ke.id)in e(w)?e(w)[(de=e(N))==null?void 0:de.id]:"0"}`,"nc-source":(we=e(N))==null?void 0:we.id},[(t(!0),_(Ce,null,ks(e(J),re=>{var le;return t(),u(di,{key:re.id,class:"nc-tree-item text-sm","data-order":re.order,"data-id":re.id,table:re,base:e(o),"source-index":e(f),"data-title":re.title,"data-source-id":(le=e(N))==null?void 0:le.id,"data-type":re.type},null,8,["data-order","data-id","table","base","source-index","data-title","data-source-id","data-type"])}),128))],8,pi)):y("",!0)],64)):y("",!0)])}}}),Ua=Object.assign(mi,{__name:"DashboardTreeViewTableList"}),vi={key:0,class:"flex flex-row items-center py-2 px-2.25 bg-gray-50 rounded-lg text-gray-700"},bi={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.75",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},fi=Se({__name:"Delete",props:{visible:{type:Boolean},baseId:{}},emits:["update:visible"],setup(R,{emit:A}){const p=R,o=wt(p,"visible",A),f=nt(),{deleteProject:N,navigateToFirstProjectOrHome:h}=f,{bases:V}=se(f),{removeFromRecentViews:$}=lt(),{refreshCommandPalette:r}=xt(),c=ne(()=>V.value.get(p.baseId)),x=T(!1),a=async()=>{if(!c.value)return;const D=JSON.parse(JSON.stringify(c.value));x.value=!0;try{await N(D.id),r(),o.value=!1,D.id===f.activeProjectId&&await h()}catch(q){Le.error(await qe(q))}finally{x.value=!1,$({baseId:D.id})}};return(D,q)=>{const g=ga,w=Ta;return t(),u(w,{visible:e(o),"onUpdate:visible":q[0]||(q[0]=k=>xe(o)?o.value=k:null),"entity-name":D.$t("objects.project"),"on-delete":a},{"entity-preview":i(()=>[e(c)?(t(),_("div",vi,[s(g,{color:("parseProp"in D?D.parseProp:e(Xt))(e(c).meta).iconColor,type:e(c).type,class:"nc-view-icon w-6 h-6 mx-1"},null,8,["color","type"]),l("div",bi,b(e(c).title),1)])):y("",!0)]),_:1},8,["visible","entity-name"])}}}),_i=Object.assign(fi,{__name:"DlgBaseDelete"}),yi={key:1,class:"flex items-center gap-2"},gi={class:"text-nc-content-gray-emphasis font-semibold"},wi={key:2,class:"flex items-center gap-2"},xi={class:"text-nc-content-gray-emphasis font-semibold"},ki={class:"mt-5 flex gap-3 flex-col"},hi={key:0,class:"mb-5"},$i={class:"text-nc-content-gray font-medium leading-5"},Ii={class:"flex-1 capitalize truncate"},Di={class:"flex gap-2 items-center"},Ci={key:0,class:"text-nc-content-gray-muted leading-4.5 text-xs"},Ti={class:"text-nc-content-gray-muted text-[13px] px-3 pt-2.5 pb-1.5 font-medium leading-5"},ji=["onClick"],Si={class:"flex-1 text-[13px] truncate font-semibold leading-5 capitalize w-full"},Vi={class:"flex items-center gap-2"},Pi={key:0,class:"text-nc-content-gray-muted leading-4.5 text-xs"},Mi={key:1,class:"text-nc-content-gray-emphasis my-5 font-medium"},Oi={class:"font-bold leading-5"},Ei={key:2,class:"text-nc-content-gray-emphasis my-5 font-medium"},Bi={class:"flex flex-row gap-x-2 justify-end"},Ni=Se({__name:"Duplicate",props:{modelValue:{type:Boolean},base:{}},emits:["update:modelValue"],setup(R,{emit:A}){const p=R,o=wt(p,"modelValue",A),{navigateToProject:f}=Qe(),{refreshCommandPalette:N}=xt(),{isDashboardEnabled:h}=se(Jo()),{api:V}=es(),{$e:$,$poller:r}=Xe(),c=nt(),{workspacesList:x,activeWorkspace:a}=kt(),{loadProjects:D,createProject:q}=c,g=T({includeData:!0,includeViews:!0,includeHooks:!0,includeComments:!0,includeScripts:!0,includeDashboards:h.value}),w=T(a),k=T(),M=T("pending"),E=T(!1),j=T(!1),J=ne(()=>{const{includeData:P,includeViews:z,includeHooks:ke,includeComments:de,includeScripts:we}=g.value;return{excludeData:!P,excludeViews:!z,excludeHooks:!ke,excludeComments:!de,excludeScripts:!we}}),U=ne(()=>[]),B=ne(()=>M.value==="loading"),ae=T(),Q=async()=>{var P;try{M.value="loading";const z=ra[Math.floor(Math.random()*1e3)%ra.length],de=bo(z).complement(),we=await V.base.duplicate(p.base.id,{options:J.value,base:{fk_workspace_id:Ke?(P=w.value)!=null&&P.id?w.value.id:p.base.fk_workspace_id:null,type:p.base.type,color:z,meta:JSON.stringify({theme:{primaryColor:z,accentColor:de.toHex8String()},iconColor:Xt(p.base.meta).iconColor})}});r.subscribe({id:we.id},async re=>{var le,ve,Ee;if(re.status!=="close")if(re.status===Bt.COMPLETED){const W=await D("workspace",(le=w==null?void 0:w.value)==null?void 0:le.id);ae.value=W.find(v=>v.id===we.base_id),M.value="success",N()}else re.status===Bt.FAILED&&(M.value="error",k.value=((Ee=(ve=re==null?void 0:re.data)==null?void 0:ve.error)==null?void 0:Ee.message)||"Some error occurred",await D("workspace"),N())}),$("a:base:duplicate")}catch(z){Le.error(await qe(z)),k.value=await qe(z),M.value="error",o.value=!1}},X=P=>{w.value=P,j.value=!1},ce=()=>{switch(M.value){case"pending":{Q();break}case"error":{ae.value=null,k.value=null,M.value="pending";break}case"success":{const P=ae.value;f({workspaceId:void 0,baseId:P.id,type:P.type}),o.value=!1;break}}};return Ye(o,P=>{P||(M.value="pending")}),ts("Enter",()=>{o.value&&Q()}),(P,z)=>{const ke=Ge,de=va,we=as,re=mo,le=vo,ve=os,Ee=pt,W=ls,v=_t("e");return P.base?(t(),u(W,{key:0,visible:e(o),"onUpdate:visible":z[9]||(z[9]=I=>xe(o)?o.value=I:null),"mask-style":{"background-color":"rgba(0, 0, 0, 0.08)"},"mask-closable":!e(B),keyboard:!e(B),class:"!w-[30rem]","wrap-class-name":"nc-modal-base-duplicate"},{default:i(()=>[l("div",null,[l("div",{class:"text-base text-nc-content-gray-emphasis leading-6 font-bold self-center",onDblclick:z[0]||(z[0]=I=>E.value=!e(E))},[["pending","loading"].includes(e(M))?(t(),_(Ce,{key:0},[Z(b(P.$t("labels.duplicateBaseBaseTitle",{baseTitle:P.base.title})),1)],64)):e(M)==="success"?(t(),_("div",yi,[s(ke,{class:"text-white w-6 h-6",icon:"checkFill"}),l("div",gi,b(P.$t("labels.duplicateBaseSuccessfull")),1)])):e(M)==="error"?(t(),_("div",wi,[s(ke,{icon:"ncInfoSolid",class:"flex-none !text-nc-content-red-dark w-6 h-6"}),l("div",xi,b(P.$t("labels.duplicateBaseFailed")),1)])):y("",!0)],32),["pending","loading"].includes(e(M))?(t(),_(Ce,{key:0},[l("div",ki,[l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[1]||(z[1]=I=>e(g).includeData=!e(g).includeData)},[s(de,{checked:e(g).includeData},null,8,["checked"]),Z(" "+b(P.$t("labels.includeRecords")),1)]),e(E)?(t(),_(Ce,{key:0},[l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[2]||(z[2]=I=>e(g).includeViews=!e(g).includeViews)},[s(de,{checked:e(g).includeViews},null,8,["checked"]),Z(" "+b(P.$t("labels.includeView")),1)]),l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[3]||(z[3]=I=>e(g).includeHooks=!e(g).includeHooks)},[s(de,{checked:e(g).includeHooks},null,8,["checked"]),Z(" "+b(P.$t("labels.includeWebhook")),1)])],64)):y("",!0),l("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[4]||(z[4]=I=>e(g).includeComments=!e(g).includeComments)},[s(de,{checked:e(g).includeComments},null,8,["checked"]),Z(" "+b(P.$t("labels.includeComments")),1)]),("isEeUI"in P?P.isEeUI:e(Ke))?(t(),_("div",{key:1,class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[5]||(z[5]=I=>e(g).includeScripts=!e(g).includeScripts)},[s(de,{checked:e(g).includeScripts},null,8,["checked"]),Z(" "+b(P.$t("labels.includeScripts")),1)])):y("",!0),e(h)&&("isEeUI"in P?P.isEeUI:e(Ke))?(t(),_("div",{key:2,class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:z[6]||(z[6]=I=>e(g).includeDashboards=!e(g).includeDashboards)},[s(de,{checked:e(g).includeDashboards},null,8,["checked"]),Z(" "+b(P.$t("labels.includeDashboards")),1)])):y("",!0)]),l("div",{class:G([{"mb-5":!("isEeUI"in P?P.isEeUI:e(Ke))},"mt-5 text-nc-content-gray-subtle2 font-medium"])},b(P.$t("labels.baseDuplicateMessage")),3),("isEeUI"in P?P.isEeUI:e(Ke))?(t(),_("div",hi,[s(we,{"divider-class":"!my-5"}),l("div",$i,[Z(b(P.$t("labels.workspace"))+" ",1),s(ve,{visible:e(j),"onUpdate:visible":z[7]||(z[7]=I=>xe(j)?j.value=I:null),class:"mt-2"},{overlay:i(()=>[s(le,{value:e(w),"item-height":28,"close-on-select":"",class:"nc-base-workspace-selection","min-items-for-search":6,"container-class-name":"w-full",list:e(U),"option-label-key":"title"},{listHeader:i(()=>[l("div",Ti,b(P.$t("labels.duplicateBaseMessage")),1),s(we)]),listItem:i(({option:I})=>{var ee,pe;return[l("div",{class:"flex gap-2 w-full items-center",onClick:me=>X(I)},[s(re,{workspace:I,size:"small"},null,8,["workspace"]),l("div",Si,b(I.title),1),l("div",Vi,[((ee=e(a))==null?void 0:ee.id)===I.id?(t(),_("div",Pi,b(P.$t("labels.currentWorkspace")),1)):y("",!0),I.id===((pe=e(w))==null?void 0:pe.id)?(t(),u(ke,{key:1,class:"text-brand-500 w-4 h-4",icon:"ncCheck"})):y("",!0)])],8,ji)]}),_:1},8,["value","list"])]),default:i(()=>{var I,ee,pe;return[l("div",{class:G(["rounded-lg border-1 transition-all cursor-pointer flex items-center border-nc-border-grey-medium h-8 py-1 gap-2 px-3",{"!border-brand-500 !shadow-selected":e(j)}]),style:{"box-shadow":"0px 0px 4px 0px rgba(0, 0, 0, 0.08)"}},[s(re,{size:"small",workspace:e(w)},null,8,["workspace"]),l("div",Ii,b((I=e(w))==null?void 0:I.title),1),l("div",Di,[((ee=e(a))==null?void 0:ee.id)===((pe=e(w))==null?void 0:pe.id)?(t(),_("div",Ci,b(P.$t("labels.currentWorkspace")),1)):y("",!0),s(ke,{class:G([{"transform rotate-180":e(j)},"text-nc-content-gray transition-all w-4 h-4"]),icon:"ncChevronDown"},null,8,["class"])])],2)]}),_:1},8,["visible"])])])):y("",!0)],64)):e(M)==="success"?(t(),_("div",Mi,[z[10]||(z[10]=Z(" Base ")),l("span",Oi,'"'+b(P.base.title)+'"',1),z[11]||(z[11]=Z(" has finished duplication. "))])):e(M)==="error"?(t(),_("div",Ei,b(P.$t("labels.errorMessage"))+" "+b(e(k)),1)):y("",!0)]),l("div",Bi,[e(B)?y("",!0):(t(),u(Ee,{key:"back",type:"secondary",size:"small",onClick:z[8]||(z[8]=I=>o.value=!1)},{default:i(()=>[Z(b(P.$t("general.cancel")),1)]),_:1})),ye((t(),u(Ee,{key:"submit",size:"small",loading:e(B),disabled:e(B),onClick:ce},{default:i(()=>[e(M)==="pending"?(t(),_(Ce,{key:0},[Z(b(P.$t("general.duplicate"))+" "+b(P.$t("objects.project")),1)],64)):e(M)==="loading"?(t(),_(Ce,{key:1},[Z(" Duplicating "+b(P.$t("objects.project")),1)],64)):e(M)==="success"?(t(),_(Ce,{key:2},[Z(b(P.$t("labels.goToBase")),1)],64)):e(M)==="error"?(t(),_(Ce,{key:3},[Z(b(P.$t("labels.tryAgain")),1)],64)):y("",!0)]),_:1},8,["loading","disabled"])),[[v,["a:base:duplicate"]]])])]),_:1},8,["visible","mask-closable","keyboard"])):y("",!0)}}}),Li=Object.assign(rt(Ni,[["__scopeId","data-v-59af81b2"]]),{__name:"DlgBaseDuplicate"}),Ra=R=>R.is_schema_readonly&&R.is_data_readonly?"#278bff":R.is_schema_readonly?"#df830f":"#de0062",Aa=R=>{var p,n;const A=`Connection type is ${((p=Qo.find(o=>o.value===R.type))==null?void 0:p.text)||((n=R.type)==null?void 0:n.toUpperCase())}.`;return R.is_schema_readonly&&R.is_data_readonly?et("div",{className:"w-max"},[A,et("br"),"Both data and schema editing are disabled.",et("br"),"This configuration is ideal for read-only use cases of the database.",et("br"),et("a",{className:"!text-current",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"Learn more")]):R.is_schema_readonly?et("div",{className:"max-w-90"},[A,et("br"),"Data editing is allowed, while schema editing is forbidden.",et("br"),"This configuration is ideal to enable trusted users to directly change the database content.",et("br"),et("a",{className:"!text-current",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"Learn more")]):et("div",{className:"max-w-90"},[A,et("br"),"Both data and schema editing are enabled.",et("br"),"We highly recommend ",et("a",{className:"!text-current",href:"https://nocodb.com/docs/product-docs/data-sources/connect-to-data-source#configuring-permissions",target:"_blank"},"disabling schema editing")," to maintain data integrity and avoid potential issues."])},Ui=Is(()=>Ds(()=>import("./D2vSp_o0.js"),__vite__mapDeps([7,8,1,2,9,10,11,12]),import.meta.url).then(R=>R.default||R)),Ri=["data-testid","data-base-id"],Ai={class:"flex flex-col gap-3"},zi={class:"text-small leading-[18px] mb-1"},Wi={key:0},Fi={class:"text-[10px] leading-[14px] text-gray-300 uppercase mb-1"},Gi=["data-id","data-testid"],Hi={class:"flex items-center select-none w-6 h-full"},Ki={key:1},qi={key:0,class:"flex-1"},Ji={class:"transition-height duration-200"},Qi={key:1,class:"transition-height duration-200"},Yi={class:"border-none sortable-list"},Zi=["data-sourceId"],Xi=["onContextmenu"],er=["onContextmenu"],tr={class:"flex-none w-6 flex items-center justify-center"},sr=["data-testid","onDblclick"],ar={key:2,class:"flex flex-row items-center gap-x-0.25"},or={class:"flex gap-2 items-center"},nr=["nc-source"],lr={class:"nc-base-option-item flex gap-2 items-center"},ir={class:"nc-base-option-item flex gap-2 items-center"},rr={class:"nc-base-option-item flex gap-2 items-center text-red-600"},cr={class:"h-[80vh]"},dr=Se({__name:"ProjectNode",props:{isProjectHeader:{type:Boolean}},setup(R,{expose:A}){const p=R,{isProjectHeader:n}=xs(p),o=et(fo,{class:"!text-gray-400",style:{fontSize:"0.85rem"},spin:!0}),N=Cs().currentRoute,{isNewSidebarEnabled:h}=se(Pt()),{isSharedBase:V}=se(Ze()),{setMenuContext:$,duplicateTable:r,contextMenuTarget:c,tableRenameId:x}=ot(ns),a=ot(Lt),D=nt(),{isMobileMode:q,user:g}=Qe(),{api:w}=es(),{createProject:k,updateProject:M,getProjectMetaInfo:E,loadProject:j}=D,{bases:J,basesUser:U,showProjectList:B}=se(D),ae=ne(()=>{var L;return(U.value.get((L=a.value)==null?void 0:L.id)||[]).map(d=>({...d,base_roles:d.roles,roles:d.roles??(d.workspace_roles?_o[d.workspace_roles]??ca.NO_ACCESS:ca.NO_ACCESS)}))}),Q=ne(()=>{var L;return(L=ae.value.find(d=>{var ie;return d.id===((ie=g.value)==null?void 0:ie.id)}))==null?void 0:L.roles}),{loadProjectTables:X,openTableCreateDialog:ce}=Je(),{activeTable:P}=se(Je()),{isUIAllowed:z}=it(),{meta:ke,control:de}=$s(),{refreshCommandPalette:we}=xt(),re=T(!1),le=T(""),ve=T({}),Ee=T(""),W=T(!1),{t:v}=ws(),I=T(),ee=ne(()=>a.value.project_role||a.value.workspace_role),{activeProjectId:pe}=se(nt()),{baseUrl:me}=Ze(),{$e:m}=Xe(),S=T(!1),H=T(!1),Y=T({}),fe=T([]),[ge]=wa(),he=T(""),O=T({}),F=T(!1),be=T(!1),{refreshViewTabTitle:oe}=lt(),Te=ne(()=>{var ie;const L=String((ie=N.value)==null?void 0:ie.name).split("baseId-index-index");if(L.length<=1)return!1;const d=L[L.length-1];return d.split("-").length===2||d.split("-").length===1}),De=L=>["airtableImport","csvImport","jsonImport","excelImport"].some(d=>z(d,{source:L})),Ie=(L=!1)=>{L&&(H.value=!1),!(!z("baseRename")||H.value)&&(re.value=!0,le.value=a.value.title,Ct(()=>{var d,ie;(d=I.value)==null||d.focus(),(ie=I.value)==null||ie.select()}))},Ve=L=>{var ie;if(!z("baseRename"))return;const d=(ie=a.value.sources)==null?void 0:ie.find(je=>je.id===L);d!=null&&d.id&&(ve.value[d.id]={editMode:!0,tempTitle:d.alias||""},Ct(()=>{const je=document.querySelector(`[data-source-rename-input-id="${L}"]`);je&&(je==null||je.focus(),je==null||je.select())}))},Pe=async L=>{var ie;const d=(ie=a.value.sources)==null?void 0:ie.find(je=>je.id===L);if(!(!(d!=null&&d.id)||!ve.value[d.id])){if(ve.value[d.id].tempTitle&&(ve.value[d.id].tempTitle=ve.value[d.id].tempTitle.trim()),!ve.value[d.id].tempTitle){delete ve.value[d.id];return}try{await w.source.update(d.base_id,d.id,{alias:ve.value[d.id].tempTitle}),await j(d.base_id,!0),delete ve.value[d.id],m("a:source:rename"),oe==null||oe()}catch(je){Le.error(await qe(je))}finally{we()}}},Be=async()=>{if(le.value&&(le.value=le.value.trim()),!le.value){re.value=!1,le.value="";return}try{await M(a.value.id,{title:le.value}),re.value=!1,le.value="",m("a:base:rename"),oe==null||oe()}catch(L){Le.error(await qe(L))}},{copy:Ue}=yo(!0),ze=async()=>{try{await Ue(Object.entries(await E(a.value.id)).map(([L,d])=>`${L}: **${d}**`).join(`
`))&&Le.info(v("msg.info.copiedToClipboard"))}catch(L){console.error(L),Le.error(L.message)}},He=async(L,d)=>{try{const ie={...Xt(d.meta),iconColor:L};D.updateProject(d.id,{meta:JSON.stringify(ie)}),m("a:base:icon:color:navdraw",{iconColor:L})}catch(ie){Le.error(await qe(ie))}finally{we()}};function _e(L,d=!0){var je,$t,St;let ie=(je=a.value.sources)==null?void 0:je[0].id;typeof L=="number"&&(ie=($t=a.value.sources)==null?void 0:$t[L].id),ce({baseId:(St=a.value)==null?void 0:St.id,sourceId:ie,showSourceSelector:d,onCloseCallback:()=>{a.value.isExpanded=!0,(!fe.value||!fe.value.includes(`collapse-${ie}`))&&fe.value.push(`collapse-${ie}`)}})}const te=T(!1);async function jt(L=!0){if(te.value)return;te.value=!0,D.isProjectPopulated(a.value.id)||X(a.value.id);try{_e(void 0,L)}finally{te.value=!1}}const mt=async(L,d,ie)=>{if(!L||n.value)return;d&&ie&&(h.value?(d=!1,ie=!1):m("c:base:expand"));const je=Nt()?ke.value:de.value;if(h.value&&!je&&pe.value===L.id){B.value=!1;return}if(!ie&&!je&&m("c:base:open"),h.value||(d=q.value||d),ie=q.value||ie,je&&!d){await Zt(`${je?"#":""}${me({id:L.id,type:"database",isSharedBase:V.value})}`,je?{open:xa}:void 0);return}ie?L.isExpanded=!L.isExpanded:L.isExpanded=!0;const $t=D.isProjectPopulated(L.id);if($t||(L.isLoading=!0),d||await Zt(me({id:L.id,type:"database",isSharedBase:V.value})),$t||await X(L.id),!$t){L.isLoading=!1;const St=J.value.get(L.id);St.isLoading=!1}B.value=!1};function tt(L){m("c:project:relation");const d=T(!0),{close:ie}=at(Na,{modelValue:d,sourceId:L.id,"onUpdate:modelValue":()=>je(),baseId:a.value.id});function je(){d.value=!1,ie(1e3)}}const ht=ne(()=>{var L,d;if(c.type==="source")return c.value;if(c.type==="table"){const ie=(d=(L=a.value)==null?void 0:L.sources)==null?void 0:d.find(je=>je.id===c.value.source_id);if(ie)return ie}return null});Ye(()=>{var L;return(L=P.value)==null?void 0:L.id},async()=>{if(!P.value)return;const L=P.value.source_id;L&&(fe.value.includes(`collapse-${L}`)||fe.value.push(`collapse-${L}`))},{immediate:!0}),ts("Escape",()=>{S.value&&(S.value=!1),H.value&&(H.value=!1);for(const L of Object.keys(Y.value))Y.value[L]=!1});const vt=T(!1),C=T(),K=L=>{C.value=L,vt.value=!0},Me=()=>{F.value=!0,m("c:table:delete")},ct=()=>{be.value=!0,m("c:project:delete")},Re=L=>{var d;return(d=a.value.sources)==null?void 0:d.find(ie=>ie.id===L)},Jt=T();Ye(()=>{var L;return Jt.value&&pe.value===((L=a.value)==null?void 0:L.id)},async L=>{var d;L&&(await Ct(),(d=Jt.value)==null||d.scrollIntoView({behavior:"smooth",block:"nearest"}))},{immediate:!0});const Ut=async L=>{await Zt(`/nc/${L}?page=base-settings`)},dt=T(!0),ut=ne(()=>V.value||!c.value?!1:c.type==="table"),Qt=()=>{S.value=!1,H.value=!1};return A({enableEditMode:Ie,addNewProjectChildEntity:jt,isAddNewProjectChildEntityLoading:te}),(L,d)=>{var Xs,ea,ta,sa,aa;const ie=Ge,je=go,$t=wo,St=ss,Rt=Kt,Mt=pt,Ts=ll,rs=os,js=Ua,bt=ja,Ot=qt,Yt=as,Ss=As,cs=is,Vs=Va,We=Sa,At=Ca,Ps=La,Ms=_i,zt=Li,Zs=Ui,za=ls,Vt=_t("e");return t(),_(Ce,null,[s(rs,{trigger:[e(n)?"click":"contextmenu"],"overlay-class-name":"nc-dropdown-tree-view-context-menu",disabled:e(n)?e(re)||e(V)||!!e(q):void 0},Gs({default:i(()=>{var Ne,ds,us,ps,ms,vs;return[l("div",{ref_key:"labelEl",ref:Jt,class:G(["nc-base-sub-menu rounded-md",{active:e(a).isExpanded,"ml-1 mr-0.5":!e(n)&&!e(h)}]),"data-testid":`nc-sidebar-base-${e(a).title}`,"data-base-id":e(a).id},[s(Rt,{"tooltip-style":{width:"300px",zIndex:"1049"},"overlay-inner-style":{width:"300px"},trigger:"hover",placement:e(n)?"rightTop":"right","hide-on-click":"",disabled:e(re)||e(S)||e(te)||!e(dt)||!e(ae).length||e(H)||!!e(q)},{title:i(()=>[l("div",Ai,[l("div",zi,b(e(a).title),1),e(Q)?(t(),_("div",Wi,[l("div",Fi,b(L.$t("title.yourBaseRole")),1),l("div",{class:G(["text-xs font-medium flex items-start gap-2 flex items-center gap-1",{"text-purple-200":e(Wt)[e(Q)]==="purple","text-blue-200":e(Wt)[e(Q)]==="blue","text-green-200":e(Wt)[e(Q)]==="green","text-orange-200":e(Wt)[e(Q)]==="orange","text-yellow-200":e(Wt)[e(Q)]==="yellow","text-red-200":e(Wt)[e(Q)]==="red","text-maroon-200":e(Wt)[e(Q)]==="maroon"}])},[s(ie,{icon:e(xo)[e(Q)],class:"w-4 h-4"},null,8,["icon"]),Z(" "+b(L.$t(`objects.roleType.${e(ko)[e(Q)]}`)),1)],2)])):y("",!0)])]),default:i(()=>{var ue,It,yt,st,gt,Et,Ae,bs,fs,oa;return[l("div",{class:G(["flex items-center gap-0.75",{"py-0.5 cursor-pointer":!e(n)}]),onContextmenu:d[24]||(d[24]=Oe=>e($)("base",e(a)))},[l("div",{ref:"baseNodeRefs",class:G([{"text-subHeading2 gap-2 hover:bg-nc-bg-gray-medium h-8 cursor-pointer px-1 max-w-full":e(n),"flex-grow w-full":e(n)&&e(re),"bg-nc-bg-gray-medium":e(n)&&e(H),"h-7 pr-1 pl-2.5 xs:pl-0 flex-grow w-full":!e(n),"bg-primary-selected active":e(pe)===e(a).id&&(e(Te)||e(h))&&!e(q)&&!e(n),"hover:bg-gray-200":!(e(pe)===e(a).id&&(e(Te)||e(h)))&&!e(n)},"nc-sidebar-node base-title-node flex-grow rounded-md group flex items-center w-full"]),"data-id":e(a).id,"data-testid":`nc-sidebar-base-title-${e(a).title}`},[l("div",{class:G(["flex items-center",{"mr-1":!e(n)}]),onClick:d[1]||(d[1]=Oe=>mt(e(a))),onMouseenter:d[2]||(d[2]=Oe=>dt.value=!1),onMouseleave:d[3]||(d[3]=Oe=>dt.value=!0)},[l("div",Hi,[e(a).isLoading?(t(),u(je,{key:0,class:"!ml-1.25 !flex !flex-row !items-center !my-0.5 w-8",indicator:e(o)},null,8,["indicator"])):(t(),_("div",Ki,[(t(),u($t,{key:`${e(a).id}_${("parseProp"in L?L.parseProp:e(Xt))(e(a).meta).iconColor}`,type:(ue=e(a))==null?void 0:ue.type,"model-value":("parseProp"in L?L.parseProp:e(Xt))(e(a).meta).iconColor,size:"small","icon-class":e(n)?"h-6 w-6":"",readonly:((It=e(a))==null?void 0:It.type)&&((yt=e(a))==null?void 0:yt.type)!=="database"||!e(z)("baseRename")||e(H),"onUpdate:modelValue":d[0]||(d[0]=Oe=>He(Oe,e(a)))},null,8,["type","model-value","icon-class","readonly"]))]))])],34),e(re)?(t(),u(St,{key:0,ref_key:"input",ref:I,value:e(le),"onUpdate:value":d[4]||(d[4]=Oe=>xe(le)?le.value=Oe:null),class:G(["capitalize !bg-transparent !flex-1 mr-4 !rounded-md !pr-1.5 !h-6 animate-sidebar-node-input-padding",e(pe)===e(a).id&&(e(Te)||e(h))&&!e(n)?"!text-brand-600 !font-semibold":"!text-gray-700"]),style:{fontWeight:"inherit"},onClick:d[5]||(d[5]=$e(()=>{},["stop"])),onKeyup:[Dt(Be,["enter"]),Dt(Be,["esc"])],onBlur:Be,onKeydown:d[6]||(d[6]=$e(()=>{},["stop"]))},null,8,["value","class"])):(t(),u(Rt,{key:1,disabled:!!e(ae).length,class:G(["nc-sidebar-node-title capitalize text-ellipsis overflow-hidden select-none flex-1",[e(pe)===e(a).id&&(e(Te)||e(h))&&!e(n)?"text-brand-600 font-semibold":"text-gray-700",{"flex-1":!e(n)}]]),style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},"show-on-truncate-only":"",onClick:d[8]||(d[8]=Oe=>mt(e(a)))},{title:i(()=>[Z(b(e(a).title),1)]),default:i(()=>[l("span",{onDblclick:d[7]||(d[7]=$e(Oe=>Ie(),["stop"]))},b(e(a).title),33)]),_:1},8,["disabled","class"])),e(re)?y("",!0):(t(),_(Ce,{key:2},[e(n)?(t(),_(Ce,{key:0},[e(q)?y("",!0):(t(),u(ie,{key:0,icon:"chevronDown",class:"flex-none text-nc-content-gray-muted"}))],64)):(t(),_(Ce,{key:1},[e(V)?y("",!0):(t(),u(rs,{key:0,visible:e(S),"onUpdate:visible":d[17]||(d[17]=Oe=>xe(S)?S.value=Oe:null),trigger:["click"]},{overlay:i(()=>[s(Ts,{"show-base-option":Oe=>De(Oe),onClickMenu:Qt,onRename:d[12]||(d[12]=Oe=>Ie()),onDuplicateProject:d[13]||(d[13]=Oe=>K(Oe)),onCopyProjectInfo:d[14]||(d[14]=Oe=>ze()),onOpenErdView:d[15]||(d[15]=Oe=>tt(Oe)),onOpenBaseSettings:d[16]||(d[16]=Oe=>Ut(Oe)),onDelete:ct},null,8,["show-base-option"])]),default:i(()=>[ye((t(),u(Mt,{class:G(["nc-sidebar-node-btn",{"!text-black !opacity-100 !inline-block":e(S)}]),"data-testid":"nc-sidebar-context-menu",type:"text",size:e(n)?"small":"xxsmall",onClick:d[9]||(d[9]=$e(()=>{},["stop"])),onMouseenter:d[10]||(d[10]=Oe=>dt.value=!1),onMouseleave:d[11]||(d[11]=Oe=>dt.value=!0)},{default:i(()=>[s(ie,{icon:e(n)?"threeDotVertical":"threeDotHorizontal",class:G(["text-xl w-4.75",{"text-nc-content-gray-subtle":e(n)}])},null,8,["icon","class"])]),_:1},8,["class","size"])),[[Vt,["c:base:options"]]])]),_:1},8,["visible"])),e(z)("tableCreate",{roles:e(ee),source:(gt=(st=e(a))==null?void 0:st.sources)==null?void 0:gt[0]})?ye((t(),u(Mt,{key:1,disabled:!((bs=(Ae=(Et=e(a))==null?void 0:Et.sources)==null?void 0:Ae[0])!=null&&bs.enabled)&&((oa=(fs=e(a))==null?void 0:fs.sources)==null?void 0:oa.length)===1,class:G(["nc-sidebar-node-btn",{"!text-black !inline-block !opacity-100":e(te),"!inline-block !opacity-100":e(S)}]),size:"xxsmall",type:"text","data-testid":"nc-sidebar-add-base-entity",loading:e(te),onClick:d[18]||(d[18]=$e(Oe=>jt(),["stop"])),onMouseenter:d[19]||(d[19]=Oe=>dt.value=!1),onMouseleave:d[20]||(d[20]=Oe=>dt.value=!0)},{default:i(()=>[s(Rt,{title:L.$t("activity.createTable"),disabled:!e(h),"hide-on-click":""},{default:i(()=>[s(ie,{icon:"plus",class:"text-xl leading-5",style:{"-webkit-text-stroke":"0.15px"}})]),_:1},8,["title","disabled"])]),_:1},8,["disabled","class","loading"])),[[Vt,["c:base:create-table"]]]):y("",!0),s(Mt,{type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn nc-sidebar-expand !xs:opacity-100 !mr-0 mt-0.5",{"!opacity-100":e(S)}]),onClick:d[21]||(d[21]=Oe=>mt(e(a),!0,!0)),onMouseenter:d[22]||(d[22]=Oe=>dt.value=!1),onMouseleave:d[23]||(d[23]=Oe=>dt.value=!0)},{default:i(()=>[s(ie,{icon:"chevronRight",class:G(["group-hover:visible cursor-pointer transform transition-transform duration-200 text-[20px]",{"!rotate-90":e(a).isExpanded&&!e(h)}])},null,8,["class"])]),_:1},8,["class"])],64))],64))],10,Gi)],34)]}),_:1},8,["placement","disabled"]),e(a).id&&!e(a).isLoading&&!e(h)?(t(),_("div",{key:"g1",class:G(["overflow-x-hidden transition-max-height",{"max-h-0":!e(a).isExpanded}])},[e(a)&&((Ne=e(a))!=null&&Ne.sources)?(t(),_("div",{key:0,class:G(["flex-1 overflow-y-auto overflow-x-hidden flex flex-col",{"mb-[20px]":e(V)}])},[(ps=(us=(ds=e(a))==null?void 0:ds.sources)==null?void 0:us[0])!=null&&ps.enabled?(t(),_("div",qi,[l("div",Ji,[s(js,{base:e(a),"source-index":0},null,8,["base"])])])):y("",!0),(vs=(ms=e(a))==null?void 0:ms.sources)!=null&&vs.slice(1).some(ue=>ue.enabled)?(t(),_("div",Qi,[l("div",Yi,[(t(!0),_(Ce,null,ks(e(a).sources,(ue,It)=>(t(),_("div",{key:`source-${ue.id}`},[It===0?(t(),_(Ce,{key:0},[],64)):ue&&ue.enabled?ye((t(),u(We,{key:1,"active-key":e(fe),"onUpdate:activeKey":d[29]||(d[29]=yt=>xe(fe)?fe.value=yt:null),class:G(["!mx-0 !px-0 nc-sidebar-source-node",[{hidden:e(ge)&&!!e(he)}]]),"expand-icon-position":"right",bordered:!1,ghost:""},{expandIcon:i(({isActive:yt,header:st})=>{var gt,Et,Ae,bs,fs;return[(Et=(gt=st==null?void 0:st[0])==null?void 0:gt.props)!=null&&Et["data-sourceId"]&&((fs=e(ve)[(bs=(Ae=st==null?void 0:st[0])==null?void 0:Ae.props)==null?void 0:bs["data-sourceId"]])!=null&&fs.editMode)?y("",!0):ye((t(),u(Mt,{key:0,type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn nc-sidebar-expand !xs:opacity-100 !mr-0 mt-0.5",{"!opacity-100 !inline-block":e(Y)[ue.id]}])},{default:i(()=>[s(ie,{icon:"chevronDown",class:G(["flex-none cursor-pointer transform transition-transform duration-500 rotate-270",{"!rotate-360":yt}])},null,8,["class"])]),_:2},1032,["class"])),[[Vt,["c:external:base:expand"]]])]}),default:i(()=>[(t(),u(Vs,{key:`collapse-${ue.id}`},{header:i(()=>{var yt,st,gt,Et;return[l("div",{"data-sourceId":ue.id,class:G(["nc-sidebar-node min-w-20 w-full h-full flex flex-row group py-0.5 !mr-0",{"pr-0.5":ue.id&&((yt=e(ve)[ue.id])==null?void 0:yt.editMode),"pr-6.5":!(ue.id&&((st=e(ve)[ue.id])!=null&&st.editMode))}])},[It===0?(t(),_("div",{key:0,class:"source-context flex items-center gap-2 text-gray-800 nc-sidebar-node-title",onContextmenu:Ae=>e($)("source",ue)},[s(bt,{class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"}),Z(" "+b(L.$t("general.default")),1)],40,Xi)):(t(),_("div",{key:1,class:"source-context flex flex-grow items-center gap-1 text-gray-800 min-w-1/20 max-w-full",onContextmenu:Ae=>e($)("source",ue)},[s(Rt,{"tooltip-style":{"min-width":"max-content"},"overlay-inner-style":{"min-width":"max-content"},"mouse-leave-delay":.3,placement:"topLeft",trigger:"hover",class:"flex items-center"},{title:i(()=>[(t(),u(ys(("getSourceTooltip"in L?L.getSourceTooltip:e(Aa))(ue))))]),default:i(()=>[l("div",tr,[s(bt,{color:("getSourceIconColor"in L?L.getSourceIconColor:e(Ra))(ue),class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"},null,8,["color"])])]),_:2},1024),ue.id&&((gt=e(ve)[ue.id])!=null&&gt.editMode)?(t(),u(St,{key:0,ref_for:!0,ref_key:"input",ref:I,value:e(ve)[ue.id].tempTitle,"onUpdate:value":Ae=>e(ve)[ue.id].tempTitle=Ae,class:"capitalize !bg-transparent flex-1 mr-4 !pr-1.5 !text-gray-700 !rounded-md !h-6 animate-sidebar-node-input-padding",style:{fontWeight:"inherit"},"data-source-rename-input-id":ue.id,onClick:d[25]||(d[25]=$e(()=>{},["stop"])),onKeydown:[d[26]||(d[26]=Dt($e(()=>{},["stop","prevent"]),["enter"])),d[27]||(d[27]=$e(()=>{},["stop"]))],onKeyup:[Dt(Ae=>Pe(ue.id),["enter"]),Dt(Ae=>Pe(ue.id),["esc"])],onBlur:Ae=>Pe(ue.id)},null,8,["value","onUpdate:value","data-source-rename-input-id","onKeyup","onBlur"])):(t(),u(Rt,{key:1,class:"nc-sidebar-node-title capitalize text-ellipsis overflow-hidden select-none text-gray-700",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},"show-on-truncate-only":""},{title:i(()=>[Z(b(ue.alias||""),1)]),default:i(()=>[l("span",{"data-testid":`nc-sidebar-base-${ue.alias}`,onDblclick:$e(Ae=>Ve(ue.id),["stop"])},b(ue.alias||""),41,sr)]),_:2},1024))],40,er)),ue.id&&((Et=e(ve)[ue.id])!=null&&Et.editMode)?y("",!0):(t(),_("div",ar,[s(rs,{visible:e(Y)[ue.id],trigger:["click"],"onUpdate:visible":Ae=>e(Y)[ue.id]=Ae},{overlay:i(()=>[s(cs,{class:"nc-scrollbar-md !min-w-50",style:{maxHeight:"70vh",overflow:"overlay"},variant:"small",onClick:Ae=>e(Y)[ue.id]=!1},{default:i(()=>[e(z)("baseRename")?(t(),u(Ot,{key:0,"data-testid":"nc-sidebar-source-rename",onClick:Ae=>Ve(ue.id)},{default:i(()=>[s(ie,{icon:"rename"}),Z(" "+b(L.$t("general.rename")),1)]),_:2},1032,["onClick"])):y("",!0),s(Yt),s(Ot,{key:"erd",onClick:Ae=>tt(ue)},{default:i(()=>[ye((t(),_("div",or,[s(ie,{icon:"ncErd"}),Z(" "+b(L.$t("title.relations")),1)])),[[Vt,["c:source:erd"]]])]),_:2},1032,["onClick"]),De(ue)?(t(),u(Ss,{key:1,base:e(a),"onUpdate:base":d[28]||(d[28]=Ae=>xe(a)?a.value=Ae:null),source:ue,"show-source-selector":!1},null,8,["base","source"])):y("",!0)]),_:2},1032,["onClick"])]),default:i(()=>[ye((t(),u(Mt,{class:G(["nc-sidebar-node-btn",{"!text-black !opacity-100 !inline-block":e(Y)[ue.id]}]),type:"text",size:"xxsmall",onClick:$e(Ae=>e(Y)[ue.id]=!e(Y)[ue.id],["stop"])},{default:i(()=>[s(ie,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:2},1032,["class","onClick"])),[[Vt,["c:source:options"]]])]),_:2},1032,["visible","onUpdate:visible"]),e(z)("tableCreate",{roles:e(ee),source:ue})?ye((t(),u(Mt,{key:0,type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn",{"!opacity-100 !inline-block":e(Y)[ue.id]}]),onClick:$e(Ae=>_e(It,!1),["stop"])},{default:i(()=>[s(ie,{icon:"plus",class:"text-xl leading-5",style:{"-webkit-text-stroke":"0.15px"}})]),_:2},1032,["class","onClick"])),[[Vt,["c:source:add-table"]]]):y("",!0)]))],10,Zi)]}),default:i(()=>[(t(),_("div",{ref_for:!0,ref:"menuRefs",key:`sortable-${ue.id}-${ue.id&&ue.id in e(O)?e(O)[ue.id]:"0"}`,"nc-source":ue.id},[s(js,{base:e(a),"source-index":It},null,8,["base","source-index"])],8,nr))]),_:2},1024))]),_:2},1032,["active-key","class"])),[[Vt,["c:source:toggle-expand"]]]):y("",!0)]))),128))])])):y("",!0)],2)):y("",!0)],2)):y("",!0)],10,Ri)]}),_:2},[e(ut)||e(n)?{name:"overlay",fn:i(()=>[e(n)?(t(),u(Ts,{key:0,"show-base-option":Ne=>De(Ne),onClickMenu:Qt,onRename:d[30]||(d[30]=Ne=>Ie(!0)),onDuplicateProject:d[31]||(d[31]=Ne=>K(Ne)),onCopyProjectInfo:d[32]||(d[32]=Ne=>ze()),onOpenErdView:d[33]||(d[33]=Ne=>tt(Ne)),onOpenBaseSettings:d[34]||(d[34]=Ne=>Ut(Ne)),onDelete:ct},null,8,["show-base-option"])):(t(),u(cs,{key:1,class:G(["!py-0 rounded text-sm",{"!min-w-62.5":e(c).type==="table","!min-w-50":e(c).type!=="table"}]),variant:"small"},{default:i(()=>{var Ne,ds,us,ps,ms,vs,ue,It;return[e(c).type==="base"&&e(a).type==="database"?(t(),_(Ce,{key:0},[],64)):e(c).type==="source"?(t(),_(Ce,{key:1},[],64)):e(c).type==="table"?(t(),_(Ce,{key:2},[e(c).value?(t(),u(At,{key:0,id:e(c).value.id,tooltip:L.$t("labels.clickToCopyTableID"),label:L.$t("labels.tableIdColon",{tableId:(Ne=e(c).value)==null?void 0:Ne.id})},null,8,["id","tooltip","label"])):y("",!0),e(z)("tableRename",{source:Re((ds=e(c).value)==null?void 0:ds.source_id)})||e(z)("tableDelete",{source:Re((us=e(c).value)==null?void 0:us.source_id)})?(t(),_(Ce,{key:1},[s(Yt),e(z)("tableRename",{source:Re((ps=e(c).value)==null?void 0:ps.source_id)})?(t(),u(Ot,{key:0,onClick:d[35]||(d[35]=yt=>{var st,gt;return x.value=`${(st=e(c).value)==null?void 0:st.id}:${(gt=e(c).value)==null?void 0:gt.source_id}`})},{default:i(()=>[ye((t(),_("div",lr,[s(ie,{icon:"rename"}),Z(" "+b(L.$t("general.rename"))+" "+b(L.$t("objects.table")),1)])),[[Vt,["c:table:rename"]]])]),_:1})):y("",!0),e(z)("tableDuplicate",{source:Re((ms=e(c).value)==null?void 0:ms.source_id)})&&((vs=e(ht))!=null&&vs.is_meta||(ue=e(ht))!=null&&ue.is_local)?(t(),u(Ot,{key:1,onClick:d[36]||(d[36]=yt=>e(r)(e(c).value))},{default:i(()=>[ye((t(),_("div",ir,[s(ie,{icon:"duplicate"}),Z(" "+b(L.$t("general.duplicate"))+" "+b(L.$t("objects.table")),1)])),[[Vt,["c:table:duplicate"]]])]),_:1})):y("",!0),s(Yt),e(z)("tableDelete",{source:Re((It=e(c).value)==null?void 0:It.source_id)})?(t(),u(Ot,{key:2,class:"!hover:bg-red-50",onClick:Me},{default:i(()=>[l("div",rr,[s(ie,{icon:"delete"}),Z(" "+b(L.$t("general.delete"))+" "+b(L.$t("objects.table")),1)])]),_:1})):y("",!0)],64)):y("",!0)],64)):y("",!0)]}),_:1},8,["class"]))]),key:"0"}:void 0]),1032,["trigger","disabled"]),(Xs=e(c).value)!=null&&Xs.id&&((ea=e(a))!=null&&ea.id)?(t(),u(Ps,{key:0,visible:e(F),"onUpdate:visible":d[37]||(d[37]=Ne=>xe(F)?F.value=Ne:null),"table-id":(ta=e(c).value)==null?void 0:ta.id,"base-id":(sa=e(a))==null?void 0:sa.id},null,8,["visible","table-id","base-id"])):y("",!0),s(Ms,{visible:e(be),"onUpdate:visible":d[38]||(d[38]=Ne=>xe(be)?be.value=Ne:null),"base-id":(aa=e(a))==null?void 0:aa.id},null,8,["visible","base-id"]),e(C)?(t(),u(zt,{key:1,modelValue:e(vt),"onUpdate:modelValue":d[39]||(d[39]=Ne=>xe(vt)?vt.value=Ne:null),base:e(C)},null,8,["modelValue","base"])):y("",!0),s(za,{visible:e(W),"onUpdate:visible":d[40]||(d[40]=Ne=>xe(W)?W.value=Ne:null),size:"large"},{default:i(()=>{var Ne;return[l("div",cr,[s(Zs,{"base-id":(Ne=e(a))==null?void 0:Ne.id,"source-id":e(Ee)},null,8,["base-id","source-id"])])]}),_:1},8,["visible"])],64)}}}),Ys=Object.assign(rt(dr,[["__scopeId","data-v-27e20a83"]]),{__name:"DashboardTreeViewProjectNode"}),ur={key:0,class:"px-2 h-11 flex items-center"},pr={class:"px-1 text-bodySmBold text-nc-content-gray-subtle bg-nc-bg-gray-medium rounded"},mr=Se({__name:"SearchInput",props:{isLoading:{type:Boolean}},setup(R){const A=R,{isLoading:p}=xs(A),{baseHomeSearchQuery:n}=se(nt()),{isSharedBase:o}=se(Ze()),{commandPalette:f}=xt(),{isMobileMode:N}=Qe(),h=()=>{var V;p.value||(V=f.value)==null||V.open()};return(V,$)=>{const r=Ge,c=ss;return!e(N)&&!e(o)?(t(),_("div",ur,[l("div",{class:"w-full",onClick:h},[s(c,{value:e(n),"onUpdate:value":$[0]||($[0]=x=>xe(n)?n.value=x:null),type:"text",class:"nc-input-border-on-value nc-input-shadow !h-8 !pl-2.5 !pr-2 !py-1 !rounded-lg",placeholder:"Quick search...","allow-clear":"",readonly:"",onKeydown:$[1]||($[1]=$e(()=>{},["stop"]))},{prefix:i(()=>[s(r,{icon:"search",class:"mr-1 h-4 w-4 text-gray-500 group-hover:text-black"})]),suffix:i(()=>[l("div",pr,b(("renderCmdOrCtrlKey"in V?V.renderCmdOrCtrlKey:e(Ao))(!0))+" K ",1)]),_:1},8,["value"])])])):y("",!0)}}}),vr=Object.assign(mr,{__name:"DashboardTreeViewProjectHomeSearchInput"}),br={class:"w-full flex items-center"},fr={class:"flex-1 flex items-center gap-2 cursor-pointer"},_r={class:"w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer group-hover:text-nc-content-brand"},yr={class:"normal-case min-w-[180px]"},gr=Se({__name:"CreateNewMenu",props:{visible:{type:Boolean}},emits:["@update:visible","newTable"],setup(R,{emit:A}){const p=R,n=A,o=wt(p,"visible",n),f=ot(Lt),N=ne(()=>{var $;return($=f.value.sources)==null?void 0:$[0]}),{isUIAllowed:h}=it(),V=$=>($.enabled||(f.value.sources||[]).length>1)&&["airtableImport","csvImport","jsonImport","excelImport"].some(r=>h(r,{source:$}));return($,r)=>{const c=Ge,x=Yo,a=As,D=qt,q=is;return t(),u(q,{variant:"large",onClick:r[3]||(r[3]=g=>o.value=!1)},{default:i(()=>[s(D,{"inner-class":"w-full",class:"nc-menu-item-combo","data-testid":"create-new-table",onClick:r[2]||(r[2]=g=>n("newTable"))},{default:i(()=>[l("div",br,[l("div",fr,[s(c,{icon:"table",class:"!w-4 !h-4"}),Z(" "+b($.$t("objects.table")),1)]),e(N)&&V(e(N))?(t(),_(Ce,{key:0},[l("div",{class:"px-1 cursor-default flex items-center h-9 -my-2",onClick:r[0]||(r[0]=$e(()=>{},["stop"]))},r[4]||(r[4]=[l("div",{class:"h-7 w-px flex-none bg-nc-border-gray-medium"},null,-1)])),s(a,{base:e(f),"onUpdate:base":r[1]||(r[1]=g=>xe(f)?f.value=g:null),source:e(N),variant:"large","submenu-class":"nc-sub-menu-item-icon-only","title-class":"!p-0 hover:bg-brand-50 group","show-noco-db-import":"","popup-offset":[8,-2]},{title:i(()=>[l("div",_r,[s(c,{icon:"ncChevronRight"})])]),expandIcon:i(()=>r[5]||(r[5]=[])),label:i(()=>[s(x,null,{default:i(()=>[l("span",yr,b($.$t("labels.importOptions")),1)]),_:1})]),_:1},8,["base","source"])],64)):y("",!0)])]),_:1})]),_:1})}}}),wr=Object.assign(gr,{__name:"DashboardTreeViewProjectCreateNewMenu"}),xr={key:0,class:"nc-treeview-active-base"},kr={key:0,class:"flex-1"},hr={key:0,class:"nc-project-home-section pt-1 !pb-2 xs:hidden flex flex-col gap-2"},$r={key:0,class:"flex items-center w-full"},Ir={class:"flex items-center gap-2"},Dr={class:"flex-1 relative overflow-y-auto nc-scrollbar-thin"},Cr={class:"nc-project-home-section"},Tr={class:"flex-1"},jr={key:0,class:"flex-1"},Sr={class:"transition-height duration-200"},Vr={key:1,class:"transition-height duration-200"},Pr={class:"border-none sortable-list"},Mr=["data-sourceId"],Or=["onContextmenu"],Er=["onContextmenu"],Br={class:"flex-none w-6 flex items-center justify-center"},Nr=["data-testid","onDblclick"],Lr={key:2,class:"flex flex-row items-center gap-x-0.25"},Ur={class:"flex gap-2 items-center"},Rr=["nc-source"],Ar=Se({__name:"Home",setup(R){const p=Cs().currentRoute,{isSharedBase:n}=se(Ze()),{baseUrl:o}=Ze(),{setMenuContext:f}=ot(ns),{api:N}=es(),h=ot(Lt),V=T(!0),$=nt(),{loadProject:r}=$,{activeProjectId:c}=se($),{activeTable:x}=se(Je()),{isUIAllowed:a}=it(),{meta:D,control:q}=$s(),{refreshCommandPalette:g}=xt(),w=T({}),k=T(),M=ne(()=>h.value.project_role||h.value.workspace_role),{$e:E}=Xe(),j=T({}),J=T([]),[U]=wa(),B=T(""),ae=T({}),Q=T(),{refreshViewTabTitle:X}=lt(),ce=ne(()=>{var I;const W=String((I=p.value)==null?void 0:I.name).split("baseId-index-index");if(W.length<=1)return!1;const v=W[W.length-1];return v.split("-").length===2||v.split("-").length===1}),P=W=>["airtableImport","csvImport","jsonImport","excelImport"].some(v=>a(v,{source:W})),z=W=>{var I;if(!a("baseRename"))return;const v=(I=h.value.sources)==null?void 0:I.find(ee=>ee.id===W);v!=null&&v.id&&(w.value[v.id]={editMode:!0,tempTitle:v.alias||""},Ct(()=>{const ee=document.querySelector(`[data-source-rename-input-id="${W}"]`);ee&&(ee==null||ee.focus(),ee==null||ee.select())}))},ke=async W=>{var I;const v=(I=h.value.sources)==null?void 0:I.find(ee=>ee.id===W);if(!(!(v!=null&&v.id)||!w.value[v.id])){if(w.value[v.id].tempTitle&&(w.value[v.id].tempTitle=w.value[v.id].tempTitle.trim()),!w.value[v.id].tempTitle){delete w.value[v.id];return}try{await N.source.update(v.base_id,v.id,{alias:w.value[v.id].tempTitle}),await r(v.base_id,!0),delete w.value[v.id],E("a:source:rename"),X==null||X()}catch(ee){Le.error(await qe(ee))}finally{g()}}};function de(W,v=!0){var m,S,H;const I=T(!0);let ee=(m=h.value.sources)==null?void 0:m[0].id;if(typeof W=="number"&&(ee=(S=h.value.sources)==null?void 0:S[W].id),!ee||!((H=h.value)!=null&&H.id))return;const{close:pe}=at(qs,{modelValue:I,sourceId:ee,baseId:h.value.id,onCreate:me,showSourceSelector:v,"onUpdate:modelValue":()=>me()});function me(Y){I.value=!1,Y&&(V.value=!0,(!J.value||!J.value.includes(`collapse-${ee}`))&&J.value.push(`collapse-${ee}`),setTimeout(()=>{const fe=document.querySelector(`[data-table-id="${Y.id}"]`);fe&&(fe==null||fe.scrollIntoView({behavior:"smooth",block:"nearest"}))},1e3),pe(1e3))}}function we(W){E("c:project:relation");const v=T(!0),{close:I}=at(Na,{modelValue:v,sourceId:W.id,"onUpdate:modelValue":()=>ee(),baseId:h.value.id});function ee(){v.value=!1,I(1e3)}}async function re(W=!0){var v,I;Q.value&&((I=(v=Q.value)==null?void 0:v.addNewProjectChildEntity)==null||I.call(v,W))}Ye(()=>{var W;return(W=x.value)==null?void 0:W.id},async()=>{if(!x.value)return;const W=x.value.source_id;W&&(J.value.includes(`collapse-${W}`)||J.value.push(`collapse-${W}`))},{immediate:!0}),ts("Escape",()=>{for(const W of Object.keys(j.value))j.value[W]=!1});const le=async()=>{const W=Nt()?D.value:q.value;await Zt(`${W?"#":""}${o({id:h.value.id,type:"database",isSharedBase:n.value,projectPage:a("projectOverviewTab")?void 0:"collaborator"})}`,W?{open:xa}:void 0)},ve=T(!1),Ee=ne(()=>{var W,v;return a("tableCreate",{roles:h.value.project_role,source:(v=(W=h.value)==null?void 0:W.sources)==null?void 0:v[0]})});return(W,v)=>{var Ve,Pe,Be,Ue,ze,He,_e;const I=Ys,ee=Qs,pe=vr,me=Ge,m=pt,S=wr,H=os,Y=Ua,fe=ja,ge=Kt,he=ss,O=qt,F=as,be=As,oe=is,Te=Va,De=Sa,Ie=_t("e");return(Ve=e(h))!=null&&Ve.id&&!e(h).isLoading?(t(),_("div",xr,[l("div",null,[s(ee,null,{default:i(()=>[e(n)?(t(),_("div",kr,v[9]||(v[9]=[l("div",{"data-testid":"nc-workspace-menu",class:"flex items-center nc-workspace-menu overflow-hidden py-1.25 pr-0.25 justify-center w-full"},[l("a",{class:"w-24 min-w-10 transition-all duration-200 p-1 transform",href:"https://github.com/nocodb/nocodb",target:"_blank",rel:"noopener noreferrer"},[l("img",{alt:"NocoDB",src:Zo})]),l("div",{class:"flex flex-grow"})],-1)]))):(t(),u(I,{key:1,ref_key:"projectNodeRef",ref:Q,"is-project-header":""},null,512))]),_:1}),s(pe,{placeholder:"Search table, view"}),e(n)?y("",!0):(t(),_("div",hr,[e(Ee)?(t(),_("div",$r,[s(H,{visible:e(ve),"onUpdate:visible":v[2]||(v[2]=te=>xe(ve)?ve.value=te:null)},{overlay:i(()=>[s(S,{visible:e(ve),"onUpdate:visible":v[0]||(v[0]=te=>xe(ve)?ve.value=te:null),onNewTable:v[1]||(v[1]=te=>re())},null,8,["visible"])]),default:i(()=>[s(m,{type:"text",size:"small","full-width":"",class:G(["nc-home-create-new-btn nc-home-create-new-dropdown-btn !text-brand-500 !hover:text-brand-600 !xs:hidden !w-full !px-3",e(ve)?"active":""]),"icon-position":"right"},{icon:i(()=>[s(me,{icon:"chevronDown",class:"flex-none"})]),default:i(()=>[l("div",Ir,[s(me,{icon:"ncPlusCircleSolid"}),l("div",null,b(W.$t("labels.createNew")),1)])]),_:1},8,["class"])]),_:1},8,["visible"])])):y("",!0),ye((t(),u(m,{type:"text",size:"xsmall",class:G(["nc-sidebar-top-button !h-8 w-full !pl-0",{"!text-brand-600 !bg-brand-50 !hover:bg-brand-50":e(c)===e(h).id&&e(ce),"!hover:bg-gray-200 !hover:text-gray-700":!(e(c)===e(h).id&&e(ce))}]),centered:!1,onClick:le},{default:i(()=>[l("div",{class:G(["flex items-center gap-2 pl-3 pr-1",{"font-semibold":e(c)===e(h).id&&e(ce)}])},[s(me,{icon:"home1",class:"!h-4 w-4"}),l("div",null,b(W.$t("general.overview")),1)],2)]),_:1},8,["class"])),[[Ie,["c:base:home"]]])]))]),l("div",Dr,[l("div",Cr,[l("div",{class:"nc-project-home-section-header !cursor-pointer",onClick:v[3]||(v[3]=$e(te=>V.value=!e(V),["stop"]))},[l("div",Tr,b(W.$t("objects.tables")),1),s(me,{icon:"chevronRight",class:G(["flex-none nc-sidebar-source-node-btns cursor-pointer transform transition-transform duration-200 text-[20px] text-nc-content-gray-muted",{"!rotate-90":e(V)}])},null,8,["class"])]),l("div",{key:"g1",class:G(["overflow-x-hidden transition-max-height",{"max-h-0":!e(V)}])},[e(h)&&((Pe=e(h))!=null&&Pe.sources)?(t(),_("div",{key:0,class:G(["flex-1 overflow-y-auto overflow-x-hidden flex flex-col",{"mb-[20px]":e(n)}])},[(ze=(Ue=(Be=e(h))==null?void 0:Be.sources)==null?void 0:Ue[0])!=null&&ze.enabled?(t(),_("div",jr,[l("div",Sr,[s(Y,{base:e(h),"source-index":0,"show-create-table-btn":e(Ee)},null,8,["base","show-create-table-btn"])])])):y("",!0),(_e=(He=e(h))==null?void 0:He.sources)!=null&&_e.slice(1).some(te=>te.enabled)?(t(),_("div",Vr,[l("div",Pr,[(t(!0),_(Ce,null,ks(e(h).sources,(te,jt)=>(t(),_("div",{key:`source-${te.id}`},[jt===0?(t(),_(Ce,{key:0},[],64)):te&&te.enabled?ye((t(),u(De,{key:1,"active-key":e(J),"onUpdate:activeKey":v[8]||(v[8]=mt=>xe(J)?J.value=mt:null),class:G(["!mx-0 !px-0 nc-sidebar-source-node",[{hidden:e(U)&&!!e(B)}]]),"expand-icon-position":"right",bordered:!1,ghost:""},{expandIcon:i(({isActive:mt,header:tt})=>{var ht,vt,C,K,Me;return[(vt=(ht=tt==null?void 0:tt[0])==null?void 0:ht.props)!=null&&vt["data-sourceId"]&&((Me=e(w)[(K=(C=tt==null?void 0:tt[0])==null?void 0:C.props)==null?void 0:K["data-sourceId"]])!=null&&Me.editMode)?y("",!0):ye((t(),u(m,{key:0,type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn nc-sidebar-expand !xs:opacity-100 !mr-0 mt-0.5",{"!opacity-100 !inline-block":e(j)[te.id]}])},{default:i(()=>[s(me,{icon:"chevronDown",class:G(["flex-none cursor-pointer transform transition-transform duration-500 rotate-270",{"!rotate-360":mt}])},null,8,["class"])]),_:2},1032,["class"])),[[Ie,["c:external:base:expand"]]])]}),default:i(()=>[(t(),u(Te,{key:`collapse-${te.id}`},{header:i(()=>{var mt,tt,ht,vt;return[l("div",{"data-sourceId":te.id,class:G(["nc-sidebar-node min-w-20 w-full h-full flex flex-row group py-0.5 !mr-0",{"pr-0.5":te.id&&((mt=e(w)[te.id])==null?void 0:mt.editMode),"pr-6.5":!(te.id&&((tt=e(w)[te.id])!=null&&tt.editMode))}])},[jt===0?(t(),_("div",{key:0,class:"source-context flex items-center gap-2 text-gray-800 nc-sidebar-node-title",onContextmenu:C=>e(f)("source",te)},[s(fe,{class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"}),Z(" "+b(W.$t("general.default")),1)],40,Or)):(t(),_("div",{key:1,class:"source-context flex flex-grow items-center gap-1 text-gray-800 min-w-1/20 max-w-full",onContextmenu:C=>e(f)("source",te)},[s(ge,{"tooltip-style":{"min-width":"max-content"},"overlay-inner-style":{"min-width":"max-content"},"mouse-leave-delay":.3,placement:"topLeft",trigger:"hover",class:"flex items-center"},{title:i(()=>[(t(),u(ys(("getSourceTooltip"in W?W.getSourceTooltip:e(Aa))(te))))]),default:i(()=>[l("div",Br,[s(fe,{color:("getSourceIconColor"in W?W.getSourceIconColor:e(Ra))(te),class:"flex-none min-w-4 !xs:min-w-4.25 !xs:w-4.25 !xs:text-sm"},null,8,["color"])])]),_:2},1024),te.id&&((ht=e(w)[te.id])!=null&&ht.editMode)?(t(),u(he,{key:0,ref_for:!0,ref_key:"input",ref:k,value:e(w)[te.id].tempTitle,"onUpdate:value":C=>e(w)[te.id].tempTitle=C,class:"capitalize !bg-transparent flex-1 mr-4 !pr-1.5 !text-gray-700 !rounded-md !h-6 animate-sidebar-node-input-padding",style:{fontWeight:"inherit"},"data-source-rename-input-id":te.id,onClick:v[4]||(v[4]=$e(()=>{},["stop"])),onKeydown:[v[5]||(v[5]=Dt($e(()=>{},["stop","prevent"]),["enter"])),v[6]||(v[6]=$e(()=>{},["stop"]))],onKeyup:[Dt(C=>ke(te.id),["enter"]),Dt(C=>ke(te.id),["esc"])],onBlur:C=>ke(te.id)},null,8,["value","onUpdate:value","data-source-rename-input-id","onKeyup","onBlur"])):(t(),u(ge,{key:1,class:"nc-sidebar-node-title capitalize text-ellipsis overflow-hidden select-none text-gray-700",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"},"show-on-truncate-only":""},{title:i(()=>[Z(b(te.alias||""),1)]),default:i(()=>[l("span",{"data-testid":`nc-sidebar-base-${te.alias}`,onDblclick:$e(C=>z(te.id),["stop"])},b(te.alias||""),41,Nr)]),_:2},1024))],40,Er)),te.id&&((vt=e(w)[te.id])!=null&&vt.editMode)?y("",!0):(t(),_("div",Lr,[s(H,{visible:e(j)[te.id],trigger:["click"],"onUpdate:visible":C=>e(j)[te.id]=C},{overlay:i(()=>[s(oe,{class:"nc-scrollbar-md !min-w-50",style:{maxHeight:"70vh",overflow:"overlay"},variant:"small",onClick:C=>e(j)[te.id]=!1},{default:i(()=>[e(a)("baseRename")?(t(),u(O,{key:0,"data-testid":"nc-sidebar-source-rename",onClick:C=>z(te.id)},{default:i(()=>[s(me,{icon:"rename"}),Z(" "+b(W.$t("general.rename")),1)]),_:2},1032,["onClick"])):y("",!0),s(F),s(O,{key:"erd",onClick:C=>we(te)},{default:i(()=>[ye((t(),_("div",Ur,[s(me,{icon:"ncErd"}),Z(" "+b(W.$t("title.relations")),1)])),[[Ie,["c:source:erd"]]])]),_:2},1032,["onClick"]),P(te)?(t(),u(be,{key:1,base:e(h),"onUpdate:base":v[7]||(v[7]=C=>xe(h)?h.value=C:null),source:te,"show-source-selector":!1},null,8,["base","source"])):y("",!0)]),_:2},1032,["onClick"])]),default:i(()=>[ye((t(),u(m,{class:G(["nc-sidebar-node-btn",{"!text-black !opacity-100 !inline-block":e(j)[te.id]}]),type:"text",size:"xxsmall",onClick:$e(C=>e(j)[te.id]=!e(j)[te.id],["stop"])},{default:i(()=>[s(me,{icon:"threeDotHorizontal",class:"text-xl w-4.75"})]),_:2},1032,["class","onClick"])),[[Ie,["c:source:options"]]])]),_:2},1032,["visible","onUpdate:visible"]),e(a)("tableCreate",{roles:e(M),source:te})?ye((t(),u(m,{key:0,type:"text",size:"xxsmall",class:G(["nc-sidebar-node-btn",{"!opacity-100 !inline-block":e(j)[te.id]}]),onClick:$e(C=>de(jt,!1),["stop"])},{default:i(()=>[s(me,{icon:"plus",class:"text-xl leading-5",style:{"-webkit-text-stroke":"0.15px"}})]),_:2},1032,["class","onClick"])),[[Ie,["c:source:add-table"]]]):y("",!0)]))],10,Mr)]}),default:i(()=>[(t(),_("div",{ref_for:!0,ref:"menuRefs",key:`sortable-${te.id}-${te.id&&te.id in e(ae)?e(ae)[te.id]:"0"}`,"nc-source":te.id},[s(Y,{base:e(h),"source-index":jt},null,8,["base","source-index"])],8,Rr))]),_:2},1024))]),_:2},1032,["active-key","class"])),[[Ie,["c:source:toggle-expand"]]]):y("",!0)]))),128))])])):y("",!0)],2)):y("",!0)],2)])]),Tt(W.$slots,"footer",{},void 0,!0)])):y("",!0)}}}),zr=Object.assign(rt(Ar,[["__scopeId","data-v-61414adc"]]),{__name:"DashboardTreeViewProjectHome"}),Wr=Se({__name:"ProjectWrapper",props:{baseRole:{default:""},base:{}},setup(R){const A=R,p=Ft(A,"baseRole"),n=Ft(A,"base");return Gt(ya,p),Gt(Lt,n),(o,f)=>Tt(o.$slots,"default")}}),Fs=Object.assign(Wr,{__name:"DashboardTreeViewProjectWrapper"}),Fr={key:"project-list",class:"nc-treeview-base-list absolute w-full h-full top-0 left-0 z-10 bg-gray-50"},Gr={class:"w-full"},Hr={class:"px-2 h-11 flex items-center"},Kr={class:"nc-project-home-section pt-1 !pb-2"},qr={class:"nc-treeview flex-1 relative overflow-auto nc-scrollbar-thin nc-project-home-section"},Jr={key:0,class:"nc-project-home-section-header"},Qr={mode:"inline",class:"nc-treeview pb-0.5 flex-grow min-h-50 overflow-x-hidden"},Yr={key:0},Zr={class:"nc-project-home-section-item text-nc-content-gray-muted font-normal"},Xr={key:1,class:"nc-project-home-section-item text-nc-content-gray-muted font-normal"},ec={key:0,class:"absolute w-full h-full top-0 left-0 z-5 flex flex-col"},tc=Se({__name:"List",setup(R){const{isUIAllowed:A}=it(),{$e:p,$api:n}=Xe(),o=Cs(),f=o.currentRoute,N=nt(),{createProject:h,updateProject:V}=N,{bases:$,basesList:r,activeProjectId:c,showProjectList:x,isProjectsLoaded:a}=se(N),{isWorkspaceLoading:D,activeWorkspaceId:q}=se(kt()),g=T(!1),w=T(""),k=T(),M=T(!1),E=ne(()=>r.value.filter(O=>gs(O.title,w.value))),j=Ze(),{loadTables:J}=j,{isSharedBase:U,base:B}=se(j),ae=Je(),{loadProjectTables:Q}=ae,{activeTable:X}=se(ae),{isMobileMode:ce}=Qe(),{setMeta:P}=Ht(),{allRecentViews:z}=se(lt()),{refreshCommandPalette:ke}=xt(),{addUndo:de,defineProjectScope:we}=Bs(),re=ne(()=>r.value.find(O=>O.id===c.value)),le=T(!1),ve=ne(()=>le.value?!a.value:!0);let Ee;Ye(()=>da(f.value.params),()=>{if(clearTimeout(Ee),da(f.value.params))if(a.value&&!r.value.length){le.value=!0,x.value=!0;return}else le.value=!1;else{le.value=!0;return}Ee=setTimeout(()=>{var O;le.value=!0,clearTimeout(Ee),!x.value&&(!c.value||!((O=re.value)!=null&&O.id))&&(x.value=!0)},5e3)},{immediate:!0});const W=Ns({}),v=(O,F)=>{W.type=O,W.value=F};function I(O){if(!O||!O.id)return;p("c:view:description");const F=T(!0),{close:be}=at(Ia,{modelValue:F,view:O,"onUpdate:modelValue":oe});function oe(){F.value=!1,be(1e3)}}function ee(O){if(!O||!O.id)return;p("c:table:description");const F=T(!0),{close:be}=at(Oa,{modelValue:F,tableMeta:O,"onUpdate:modelValue":oe});function oe(){F.value=!1,be(1e3)}}const pe=T("");async function me(O,F,be,oe,Te=!1,De){if(!(!O||!O.source_id)&&(F&&(F=F.trim()),!(F===be&&!De))){oe(F);try{await n.dbTable.update(O.id,{base_id:O.base_id,table_name:F,title:F}),await Q(O.base_id,!0),Te||de({redo:{fn:(Ve,Pe,Be,Ue)=>{me(Ve,Pe,Be,Ue,!0,!0)},args:[O,F,be,oe]},undo:{fn:(Ve,Pe,Be,Ue)=>{me(Ve,Pe,Be,Ue,!0,!0)},args:[O,be,F,oe]},scope:we({model:O})}),await J(),z.value=z.value.map(Ve=>(Ve.tableID===O.id&&(Ve.isDefault&&(Ve.viewName=F),Ve.tableName=F),Ve));const Ie=await n.dbTable.read(O.id);await P(Ie),ke(),p("a:table:rename")}catch(Ie){Le.error(await qe(Ie)),oe(be)}}}function m(O,F){if(!O&&!(F||r.value[0].id))return;p("c:table:create:navdraw");const be=T(!0),{close:oe}=at(qs,{modelValue:be,sourceId:O,baseId:F||r.value[0].id,"onUpdate:modelValue":Te});function Te(){be.value=!1,oe(1e3)}}const S=async O=>{if(!O||!O.id||!O.base_id)return;const F=T(!0);p("c:table:duplicate");const{close:be}=at(Ea,{modelValue:F,table:O,"onUpdate:modelValue":oe});function oe(){F.value=!1,be(1e3)}},H=ne(()=>{var O,F,be,oe;return((F=(O=B.value)==null?void 0:O.sources)==null?void 0:F[0])&&A("tableCreate",{source:(oe=(be=B.value)==null?void 0:be.sources)==null?void 0:oe[0]})&&f.value.name!=="index"&&f.value.name!=="index-index"&&f.value.name!=="index-index-create"&&f.value.name!=="index-index-create-external"&&f.value.name!=="index-user-index"});Es(document,"keydown",async O=>{var be;const F=Nt()?O.metaKey:O.ctrlKey;if(!ka()&&O.altKey&&!O.shiftKey&&!F)switch(O.keyCode){case 84:{if(H.value&&!ha()){O.preventDefault(),p("c:shortcut",{key:"ALT + T"});const oe=c.value,Te=oe?$.value.get(oe):void 0;if(!Te)return;oe&&m((be=Te.sources)==null?void 0:be[0].id,oe)}break}case 76:{f.value.params.baseId&&o.push({query:{...f.value.query,clear:f.value.query.clear==="1"?void 0:"1"}});break}case 68:{O.stopPropagation(),g.value=!0;break}}});const Y=O=>{var F;(F=document.querySelector(".source-context, .table-context"))!=null&&F.contains(O.target)||v("main")};Gt(ns,{setMenuContext:v,duplicateTable:S,handleTableRename:me,openViewDescriptionDialog:I,openTableDescriptionDialog:ee,contextMenuTarget:W,tableRenameId:pe}),Es(document,"contextmenu",Y,!0);const fe=()=>{var F;const O=document.querySelector(`.nc-treeview [data-table-id="${(F=X.value)==null?void 0:F.id}"]`);O&&(O==null||O.scrollIntoView({behavior:"smooth",block:"nearest"}))},ge=async O=>{var Ie,Ve;const{moved:{newIndex:F=0,oldIndex:be=0,element:oe}}=O;if(!(oe!=null&&oe.id))return;let Te;r.value.length-1===F?Te=Math.max(...r.value.map(Pe=>(Pe==null?void 0:Pe.order)??0))+1:F===0?Te=Math.min(...r.value.map(Pe=>(Pe==null?void 0:Pe.order)??0))/2:Te=(parseFloat(String(((Ie=r.value[F-1])==null?void 0:Ie.order)??0))+parseFloat(String(((Ve=r.value[F+1])==null?void 0:Ve.order)??0)))/2;const De=isNaN(Number(Te))?be:Te;await V(oe.id,{order:De}),p("a:base:reorder")};Ye(()=>{var O;return(O=X.value)==null?void 0:O.id},()=>{var O;(O=X.value)!=null&&O.id&&setTimeout(()=>{fe()},1e3)},{immediate:!0});const he=T(void 0);return Ye([x,q],([O,F],[be,oe])=>{if(!a.value){he.value=void 0;return}F!==oe?he.value=void 0:he.value=O?"slide-left":"slide-right"},{flush:"pre"}),Ye([k,x],()=>{!k.value||!x.value||Ct(()=>{var O,F;(F=(O=k.value)==null?void 0:O.input)==null||F.focus()})}),Ye(a,()=>{a.value&&r.value.length?he.value=x.value?"slide-left":"slide-right":he.value=void 0,a.value&&!r.value.length&&(le.value=!0,x.value=!0)}),(O,F)=>{var Be,Ue;const be=Un,oe=Qs,Te=An,De=Ba,Ie=Ys,Ve=zr,Pe=Us;return t(),_("div",{class:G(["nc-treeview-container relative w-full h-full overflow-hidden flex items-stretch",e(x)?"nc-treeview-container-base-list":"nc-treeview-container-active-base"])},[e(ve)?(t(),u(be,{key:0})):(t(),_(Ce,{key:1},[s(ho,{name:e(he),appear:""},{default:i(()=>{var ze,He;return[e(x)?(t(),_("div",Fr,[l("div",Gr,[s(oe),l("div",Hr,[s(Te,{ref_key:"searchInputRef",ref:k,value:e(w),"onUpdate:value":F[0]||(F[0]=_e=>xe(w)?w.value=_e:null)},null,8,["value"])]),l("div",Kr,[s(De,{"is-open":e(M),"onUpdate:isOpen":F[1]||(F[1]=_e=>xe(M)?M.value=_e:null),modal:"",type:"text",class:"nc-sidebar-create-base-btn nc-project-home-section-item !text-brand-500 !hover:text-brand-600 !hover:bg-none !xs:hidden w-full","data-testid":"nc-sidebar-create-base-btn"},null,8,["is-open"])])]),l("div",qr,[e(U)?y("",!0):(t(),_("div",Jr,b(O.$t("objects.projects")),1)),l("div",Qr,[(ze=e(r))!=null&&ze.length?(t(),_("div",Yr,[s(e(Pa),{"model-value":e(r),disabled:e(ce)||!e(A)("baseReorder")||((He=e(r))==null?void 0:He.length)<2,"item-key":"id",handle:".base-title-node","ghost-class":"ghost",filter:"isTouchEvent"in O?O.isTouchEvent:e(Ls),onChange:F[2]||(F[2]=_e=>ge(_e))},Gs({item:i(({element:_e})=>[("searchCompare"in O?O.searchCompare:e(gs))(_e.title,e(w))?(t(),_("div",{key:_e.id},[s(Fs,{"base-role":_e.project_role,base:_e},{default:i(()=>[s(Ie)]),_:2},1032,["base-role","base"])])):y("",!0)]),_:2},[!e(D)&&!e(E).length?{name:"footer",fn:i(()=>[l("div",Zr,b(O.$t("placeholder.noResultsFoundForYourSearch")),1)]),key:"0"}:void 0]),1032,["model-value","disabled","filter"])])):(t(),_("div",Xr,"No Bases"))])]),Tt(O.$slots,"footer",{},void 0,!0)])):y("",!0)]}),_:3},8,["name"]),e(x)?y("",!0):(t(),_(Ce,{key:0},[e(c)&&((Be=e(re))!=null&&Be.id)&&!e(re).isLoading?(t(),_("div",ec,[s(Fs,{"base-role":(Ue=e(re))==null?void 0:Ue.project_role,base:e(re)},{default:i(()=>[s(Ve,null,{footer:i(()=>[Tt(O.$slots,"footer",{},void 0,!0)]),_:3})]),_:3},8,["base-role","base"])])):(t(),u(be,{key:1}))],64)),s(Pe,{modelValue:e(g),"onUpdate:modelValue":F[3]||(F[3]=ze=>xe(g)?g.value=ze:null)},null,8,["modelValue"])],64))],2)}}}),sc=Object.assign(rt(tc,[["__scopeId","data-v-a17654c2"]]),{__name:"DashboardTreeViewProjectList"}),ac=["data-workspace-title"],oc={key:0,class:"flex flex-row items-center w-full"},nc={key:0},lc={class:"flex items-center text-inherit"},ic={key:1,class:"flex flex-row items-center w-full mt-0.25 ml-2.5 gap-x-3"},rc=Se({__name:"Header",setup(R){const A=kt(),{isLeftSidebarOpen:p,isNewSidebarEnabled:n}=se(Pt()),{activeWorkspace:o,isWorkspacesLoading:f}=se(A),{activeViewTitleOrId:N}=se(lt()),{activeTableId:h}=se(Je()),{isMobileMode:V}=Qe(),$=ne(()=>!(V.value&&!N.value&&!h.value));return(r,c)=>{var k;const x=Mo,a=Ge,D=pt,q=Kt,g=Rs,w=_t("e");return t(),_("div",{class:"flex items-center nc-sidebar-header w-full border-b-1 border-gray-200 group md:px-2 md:py-1.2 xs:px-1 xs:py-1","data-workspace-title":(k=e(o))==null?void 0:k.title,style:{height:"var(--topbar-height)"}},[e(f)?(t(),_("div",ic,[s(g,{active:!0,class:"!w-6 !h-6 !rounded overflow-hidden"}),s(g,{active:!0,class:"!w-40 !h-6 !rounded overflow-hidden"})])):(t(),_("div",oc,[e(n)?(t(),_("div",nc,"Bases")):(t(),u(x,{key:1})),c[1]||(c[1]=l("div",{class:"flex flex-grow min-w-1"},null,-1)),s(q,{class:G(["flex",{"!opacity-100":!e(p)}]),placement:"bottom","hide-on-click":""},{title:i(()=>[Z(b(e(p)?`${r.$t("title.hideSidebar")}`:`${r.$t("title.showSidebar")}`),1)]),default:i(()=>[e($)?ye((t(),u(D,{key:0,type:e(V)?"secondary":"text",size:e(V)?"medium":"small",class:"nc-sidebar-left-toggle-icon !text-gray-700 !hover:text-gray-800 !xs:h-10.5 !xs:max-h-10.5 !xs:max-w-10.5 !md:hover:bg-gray-200",onClick:c[0]||(c[0]=M=>p.value=!e(p))},{default:i(()=>[l("div",lc,[e(V)?(t(),u(a,{key:0,icon:"close"})):(t(),u(a,{key:1,icon:"doubleLeftArrow",class:G(["duration-150 transition-all !text-lg -mt-0.5 !text-gray-500/75",{"transform rotate-180":!e(p)}])},null,8,["class"]))])]),_:1},8,["type","size"])),[[w,["c:leftSidebar:hideToggle"]]]):y("",!0)]),_:1},8,["class"])]))],8,ac)}}}),cc=Object.assign(rc,{__name:"DashboardSidebarHeader"}),dc={key:0,class:"flex flex-col w-full gap-y-3.75 ml-3 mt-3.75"},uc={key:0,class:"flex flex-row items-center w-full gap-x-3"},pc={class:"flex flex-row items-center w-full gap-x-3"},mc={class:"flex flex-row items-center w-full gap-x-3"},vc={key:1,class:"xs:hidden flex flex-col p-1 mt-0.25 mb-0.5 truncate"},bc={class:"gap-x-2 flex flex-row w-full items-center"},fc={class:"flex"},_c=Se({__name:"TopSection",setup(R){const A=kt(),p=Ze(),{isUIAllowed:n}=it(),{appInfo:o}=Qe(),{meta:f,control:N}=$s(),{isWorkspaceLoading:h,isWorkspaceSettingsPageOpened:V,isIntegrationsPageOpened:$}=se(A),{navigateToWorkspaceSettings:r,navigateToIntegrations:c}=A,{isSharedBase:x}=se(p),a=T(!1),D=()=>{const g=Nt()?f.value:N.value;r("",g)},q=()=>{const g=Nt()?f.value:N.value;c("",g)};return(g,w)=>{const k=Rs,M=Ge,E=pt,j=Ba,J=_t("e");return e(h)?(t(),_("div",dc,[e(o).ee?(t(),_("div",uc,[s(k,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),s(k,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})])):y("",!0),l("div",pc,[s(k,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),s(k,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})]),l("div",mc,[s(k,{active:!0,class:"!w-4 !h-4 !rounded overflow-hidden"}),s(k,{active:!0,class:"!w-40 !h-4 !rounded overflow-hidden"})])])):e(x)?y("",!0):(t(),_("div",vc,[e(n)("workspaceSettings")||e(n)("workspaceCollaborators")?ye((t(),u(E,{key:0,type:"text",size:"xsmall",class:G(["nc-sidebar-top-button !xs:hidden my-0.5 !h-7",{"!text-brand-600 !bg-brand-50 !hover:bg-brand-50":e(V),"!hover:bg-gray-200 !hover:text-gray-700":!e(V)}]),"data-testid":"nc-sidebar-team-settings-btn",centered:!1,onClick:D},{default:i(()=>[l("div",{class:G(["flex items-center gap-2",{"font-semibold":e(V)}])},[s(M,{icon:"ncSettings",class:"!h-4 w-4"}),l("div",null,b(g.$t("title.teamAndSettings")),1)],2)]),_:1},8,["class"])),[[J,["c:team:settings"]]]):y("",!0),e(n)("workspaceIntegrations")?ye((t(),u(E,{key:1,type:"text",size:"xsmall",class:G(["nc-sidebar-top-button !xs:hidden my-0.5 !h-7",{"!text-brand-600 !bg-brand-50 !hover:bg-brand-50":e($),"!hover:bg-gray-200 !hover:text-gray-700":!e($)}]),"data-testid":"nc-sidebar-integrations-btn",centered:!1,onClick:q},{default:i(()=>[l("div",{class:G(["flex items-center gap-2",{"font-semibold":e($)}])},[s(M,{icon:"integration",class:"!h-4"}),l("div",null,b(g.$t("general.integrations")),1)],2)]),_:1},8,["class"])),[[J,["c:integrations"]]]):y("",!0),s(j,{"is-open":e(a),"onUpdate:isOpen":w[0]||(w[0]=U=>xe(a)?a.value=U:null),modal:"",type:"text",class:"nc-sidebar-top-button !hover:bg-gray-200 !hover:text-gray-700 !xs:hidden !h-7 my-0.5","data-testid":"nc-sidebar-create-base-btn"},{default:i(()=>[l("div",bc,[s(M,{icon:"plus"}),l("div",fc,b(g.$t("title.createBase")),1)])]),_:1},8,["is-open"])]))}}}),yc=Object.assign(rt(_c,[["__scopeId","data-v-cf1b2de9"]]),{__name:"DashboardSidebarTopSection"}),gc={class:"flex items-center justify-center mt-8"},wc={class:"flex flex-col gap-4 items-center text-gray-500"},xc={class:"flex gap-2 justify mt-1"},kc={class:"flex gap-2 items-center justify-center text-xs"},hc=Se({__name:"EmptyPlaceholder",props:{buttons:{type:Boolean}},setup(R){const A=R,p=T(!1),n=()=>{p.value=!0};return(o,f)=>{const N=Xo,h=ga,V=ba,$=Us;return t(),_("div",gc,[l("div",wc,[s(N),f[4]||(f[4]=l("div",{class:"font-weight-medium"},"No Projects",-1)),A.buttons?(t(),_(Ce,{key:0},[f[3]||(f[3]=l("div",{class:"text-xs"},"Create Base",-1)),l("div",xc,[s(V,{class:"flex-1 nc-btn",onClick:f[0]||(f[0]=r=>n())},{default:i(()=>[l("div",kc,[s(h,{class:"text-[#2824FB] text-lg"}),f[2]||(f[2]=Z(" New Database Base "))])]),_:1})]),s($,{modelValue:e(p),"onUpdate:modelValue":f[1]||(f[1]=r=>xe(p)?p.value=r:null)},null,8,["modelValue"])],64)):y("",!0)])])}}}),$c=Object.assign(hc,{__name:"WorkspaceEmptyPlaceholder"}),Ic={class:"nc-treeview-container flex flex-col justify-between select-none"},Dc={key:0,class:"text-gray-500 font-medium pl-3.5 mb-1"},Cc={mode:"inline",class:"nc-treeview pb-0.5 flex-grow min-h-50 overflow-x-hidden"},Tc={key:0},jc=Se({__name:"index",setup(R){const{isUIAllowed:A}=it(),{$e:p,$api:n}=Xe(),o=Cs(),f=o.currentRoute,N=nt(),{createProject:h,updateProject:V}=N,{bases:$,basesList:r,activeProjectId:c}=se(N),{isWorkspaceLoading:x}=se(kt()),a=T(!1),D=Ze(),{loadTables:q}=D,{isSharedBase:g,base:w}=se(D),k=Je(),{loadProjectTables:M}=k,{activeTable:E}=se(k),{isMobileMode:j}=Qe(),{setMeta:J}=Ht(),{allRecentViews:U}=se(lt()),{refreshCommandPalette:B}=xt(),{addUndo:ae,defineProjectScope:Q}=Bs(),X=Ns({}),ce=(v,I)=>{X.type=v,X.value=I};function P(v){if(!v||!v.id)return;p("c:view:description");const I=T(!0),{close:ee}=at(Ia,{modelValue:I,view:v,"onUpdate:modelValue":pe});function pe(){I.value=!1,ee(1e3)}}function z(v){if(!v||!v.id)return;p("c:table:description");const I=T(!0),{close:ee}=at(Oa,{modelValue:I,tableMeta:v,"onUpdate:modelValue":pe});function pe(){I.value=!1,ee(1e3)}}const ke=T("");async function de(v,I,ee,pe,me=!1,m){if(!(!v||!v.source_id)&&(I&&(I=I.trim()),!(I===ee&&!m))){pe(I);try{await n.dbTable.update(v.id,{base_id:v.base_id,table_name:I,title:I}),await M(v.base_id,!0),me||ae({redo:{fn:(H,Y,fe,ge)=>{de(H,Y,fe,ge,!0,!0)},args:[v,I,ee,pe]},undo:{fn:(H,Y,fe,ge)=>{de(H,Y,fe,ge,!0,!0)},args:[v,ee,I,pe]},scope:Q({model:v})}),await q(),U.value=U.value.map(H=>(H.tableID===v.id&&(H.isDefault&&(H.viewName=I),H.tableName=I),H));const S=await n.dbTable.read(v.id);await J(S),B(),p("a:table:rename")}catch(S){Le.error(await qe(S)),pe(ee)}}}function we(v,I){if(!v&&!(I||r.value[0].id))return;p("c:table:create:navdraw");const ee=T(!0),{close:pe}=at(qs,{modelValue:ee,sourceId:v,baseId:I||r.value[0].id,"onUpdate:modelValue":me});function me(){ee.value=!1,pe(1e3)}}const re=async v=>{if(!v||!v.id||!v.base_id)return;const I=T(!0);p("c:table:duplicate");const{close:ee}=at(Ea,{modelValue:I,table:v,"onUpdate:modelValue":pe});function pe(){I.value=!1,ee(1e3)}},le=ne(()=>{var v,I,ee,pe;return((I=(v=w.value)==null?void 0:v.sources)==null?void 0:I[0])&&A("tableCreate",{source:(pe=(ee=w.value)==null?void 0:ee.sources)==null?void 0:pe[0]})&&f.value.name!=="index"&&f.value.name!=="index-index"&&f.value.name!=="index-index-create"&&f.value.name!=="index-index-create-external"&&f.value.name!=="index-user-index"});Es(document,"keydown",async v=>{var ee;const I=Nt()?v.metaKey:v.ctrlKey;if(!ka()&&v.altKey&&!v.shiftKey&&!I)switch(v.keyCode){case 84:{if(le.value&&!ha()){v.preventDefault(),p("c:shortcut",{key:"ALT + T"});const pe=c.value,me=pe?$.value.get(pe):void 0;if(!me)return;pe&&we((ee=me.sources)==null?void 0:ee[0].id,pe)}break}case 76:{f.value.params.baseId&&o.push({query:{...f.value.query,clear:f.value.query.clear==="1"?void 0:"1"}});break}case 68:{v.stopPropagation(),a.value=!0;break}}});const ve=v=>{var I;(I=document.querySelector(".source-context, .table-context"))!=null&&I.contains(v.target)||ce("main")};Gt(ns,{setMenuContext:ce,duplicateTable:re,handleTableRename:de,openViewDescriptionDialog:P,openTableDescriptionDialog:z,contextMenuTarget:X,tableRenameId:ke}),Es(document,"contextmenu",ve,!0);const Ee=()=>{var I;const v=document.querySelector(`.nc-treeview [data-table-id="${(I=E.value)==null?void 0:I.id}"]`);v&&(v==null||v.scrollIntoView({behavior:"smooth",block:"nearest"}))},W=async v=>{var S,H;const{moved:{newIndex:I=0,oldIndex:ee=0,element:pe}}=v;if(!(pe!=null&&pe.id))return;let me;r.value.length-1===I?me=Math.max(...r.value.map(Y=>(Y==null?void 0:Y.order)??0))+1:I===0?me=Math.min(...r.value.map(Y=>(Y==null?void 0:Y.order)??0))/2:me=(parseFloat(String(((S=r.value[I-1])==null?void 0:S.order)??0))+parseFloat(String(((H=r.value[I+1])==null?void 0:H.order)??0)))/2;const m=isNaN(Number(me))?ee:me;await V(pe.id,{order:m}),p("a:base:reorder")};return Ye(()=>{var v;return(v=E.value)==null?void 0:v.id},()=>{var v;(v=E.value)!=null&&v.id&&setTimeout(()=>{Ee()},1e3)},{immediate:!0}),(v,I)=>{var m,S;const ee=Ys,pe=$c,me=Us;return t(),_("div",Ic,[e(g)?y("",!0):(t(),_("div",Dc,b(v.$t("objects.projects")),1)),l("div",Cc,[(m=e(r))!=null&&m.length?(t(),_("div",Tc,[s(e(Pa),{"model-value":e(r),disabled:e(j)||!e(A)("baseReorder")||((S=e(r))==null?void 0:S.length)<2,"item-key":"id",handle:".base-title-node","ghost-class":"ghost",filter:"isTouchEvent"in v?v.isTouchEvent:e(Ls),onChange:I[0]||(I[0]=H=>W(H))},{item:i(({element:H})=>[(t(),_("div",{key:H.id},[s(Fs,{"base-role":H.project_role,base:H},{default:i(()=>[s(ee)]),_:2},1032,["base-role","base"])]))]),_:1},8,["model-value","disabled","filter"])])):e(x)?y("",!0):(t(),u(pe,{key:1}))]),s(me,{modelValue:e(a),"onUpdate:modelValue":I[1]||(I[1]=H=>xe(a)?a.value=H:null)},null,8,["modelValue"])])}}}),Sc=Object.assign(rt(jc,[["__scopeId","data-v-d7adf06a"]]),{__name:"DashboardTreeView"}),Vc={class:"flex flex-col gap-4"},Pc={class:"flex items-center gap-2"},Mc={class:"flex items-center gap-2"},Oc={class:"text-sm text-gray-500"},Ec=Se({__name:"UpgradeWs",props:{modelValue:{type:Boolean},jobId:{}},emits:["update:modelValue"],setup(R,{emit:A}){const p=R,o=wt(p,"modelValue",A),{$poller:f}=Xe(),N=kt(),{activeWorkspace:h}=se(N),V=T(""),$=T(!1),r=T(!1);function c(x){r.value=!0,f.subscribe({id:x},async a=>{var D;a.status!=="close"&&(a.status===Bt.COMPLETED||a.status===Bt.FAILED?($.value=!0,r.value=!1,N.loadWorkspace(h.value.id)):V.value=((D=a.data)==null?void 0:D.message)||"Upgrading workspace...")})}return hs(()=>{p.jobId&&c(p.jobId)}),(x,a)=>{const D=Ge,q=Ks,g=pt,w=ls;return t(),u(w,{visible:e(o),"onUpdate:visible":a[1]||(a[1]=k=>xe(o)?o.value=k:null),class:"!w-[30rem]","wrap-class-name":"nc-modal-upgrade-ws"},{default:i(()=>[l("div",Vc,[l("div",Pc,[s(D,{icon:"nocodb1",class:"w-5 h-5"}),a[2]||(a[2]=l("div",{class:"text-lg font-bold self-center"},"Upgrading Workspace",-1))]),l("div",Mc,[e(r)?(t(),u(q,{key:0})):y("",!0),l("div",Oc,b(e(V)),1)]),e($)?(t(),u(g,{key:0,type:"primary",onClick:a[0]||(a[0]=k=>o.value=!1)},{default:i(()=>a[3]||(a[3]=[Z(" Done ")])),_:1,__:[3]})):y("",!0)])]),_:1},8,["visible"])}}}),Bc=Object.assign(Ec,{__name:"DlgUpgradeWs"}),Nc=Is(()=>Ds(()=>import("./BrciY6D-.js"),__vite__mapDeps([13,6,1,2]),import.meta.url).then(R=>R.default||R)),Lc={class:"nc-sidebar flex flex-col bg-gray-50 outline-r-1 outline-gray-100 select-none w-full h-full font-medium z-2",style:{outlineWidth:"1px"}},Uc={key:0,class:"nc-sidebar-bottom-section"},Rc={key:2,class:"flex flex-row w-full justify-between pt-0.5 truncate"},Ac={class:"flex flex-col"},zc={key:0,class:"nc-sidebar-bottom-section"},Wc=Se({__name:"Sidebar",setup(R){const A=kt(),{isWorkspaceLoading:p,upgradeWsDlg:n,upgradeWsJobId:o}=se(A),{isSharedBase:f}=se(Ze()),{isMobileMode:N,appInfo:h}=Qe(),{isNewSidebarEnabled:V}=se(Pt()),$=T(),r=T(!1),c=()=>{if(!N.value)return $.value&&($.value.scrollTop>0?r.value=!0:r.value=!1),!1};return hs(()=>{var x;(x=$.value)==null||x.addEventListener("scroll",c)}),$o(()=>{var x;(x=$.value)==null||x.removeEventListener("scroll",c)}),(x,a)=>{const D=sn,q=Nc,g=dn,w=mn,k=Oo,M=fn,E=sc,j=cc,J=yc,U=Sc,B=Eo,ae=Bo,Q=Bc;return t(),_("div",Lc,[e(V)?(t(),u(E,{key:0},{footer:i(()=>[e(f)?y("",!0):(t(),_("div",Uc,[("isEeUI"in x?x.isEeUI:e(Ke))?(t(),u(D,{key:0})):y("",!0),s(q),("isEeUI"in x?x.isEeUI:e(Ke))?y("",!0):(t(),u(g,{key:1})),s(w),!e(N)&&!e(h).ee?(t(),_("div",Rc,[s(k)])):y("",!0),e(h).isOnPrem?(t(),u(M,{key:3})):y("",!0)]))]),_:1})):(t(),_(Ce,{key:1},[l("div",Ac,[s(j),e(f)?y("",!0):(t(),u(J,{key:0}))]),l("div",{ref_key:"treeViewDom",ref:$,class:G(["flex flex-col nc-scrollbar-dark-md flex-grow xs:border-transparent xs:pt-2 xs:pr-2",{"border-t-1":!e(f),"border-transparent":!e(r),"pt-0.25":e(f)}])},[e(p)?y("",!0):(t(),u(U,{key:0}))],2),e(f)?y("",!0):(t(),_("div",zc,[("isEeUI"in x?x.isEeUI:e(Ke))?(t(),u(D,{key:0})):y("",!0),("isEeUI"in x?x.isEeUI:e(Ke))?y("",!0):(t(),u(g,{key:1})),s(w),e(h).feedEnabled?(t(),u(B,{key:2})):y("",!0),s(ae),e(h).isOnPrem?(t(),u(M,{key:3})):y("",!0)]))],64)),e(o)?(t(),u(Q,{key:2,modelValue:e(n),"onUpdate:modelValue":a[0]||(a[0]=X=>xe(n)?n.value=X:null),"job-id":e(o)},null,8,["modelValue","job-id"])):y("",!0)])}}}),Fc=Object.assign(rt(Wc,[["__scopeId","data-v-e2daf41a"]]),{__name:"DashboardSidebar"}),Gc={class:"prose-xl font-bold self-center"},Hc={class:"prose-md self-center text-gray-500 mt-4"},Kc={class:"text-xs p-2"},qc={class:"flex flex-row gap-x-2 mt-2.5 pt-2.5 justify-end"},Jc=Se({__name:"SharedBaseDuplicate",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(R,{emit:A}){const p=R,n=A,{api:o}=es(),{sharedBaseId:f}=Ma(),N=kt(),{populateWorkspace:h}=N,{workspacesList:V}=se(N),{ncNavigateTo:$}=Qe(),r=wt(p,"modelValue",n),c=T({includeData:!0,includeViews:!0}),x=ne(()=>{const{includeData:M,includeViews:E}=c.value;return{excludeData:!M,excludeViews:!E}}),a=T(!1),D=T(),{$e:q,$poller:g}=Xe(),w=async()=>{!D.value&&Ke;try{a.value=!0;const M=await o.base.duplicateShared(D.value??"nc",f.value,{options:x.value,base:Ke?{fk_workspace_id:D.value,type:To.DATABASE}:{}});f.value=null,g.subscribe({id:M.id},async E=>{E.status!=="close"&&(E.status===Bt.COMPLETED?(console.log("job completed",M),await $({...Ke?{workspaceId:M.fk_workspace_id}:{},baseId:M.base_id}),a.value=!1,r.value=!1):E.status===Bt.FAILED&&(Le.error("Failed to duplicate shared base"),await h(),a.value=!1,r.value=!1))}),q("a:base:duplicate-shared-base")}catch(M){Le.error(await qe(M)),a.value=!1,r.value=!1}},k=ne(()=>{var M;return(M=V.value)==null?void 0:M.filter(E=>E.roles===ua.OWNER||E.roles===ua.CREATOR).map(E=>({label:`${E.title[0].toUpperCase()}${E.title.slice(1)}`,value:E.id}))});return(M,E)=>{const j=Io,J=Do,U=Co,B=pt,ae=ls,Q=_t("e");return t(),u(ae,{visible:e(r),"onUpdate:visible":E[4]||(E[4]=X=>xe(r)?r.value=X:null),class:"!w-[30rem]","wrap-class-name":"nc-modal-project-duplicate"},{default:i(()=>[l("div",null,[l("div",Gc,b(M.$t("general.duplicate"))+" "+b(M.$t("labels.sharedBase")),1),("isEeUI"in M?M.isEeUI:e(Ke))?(t(),_(Ce,{key:0},[E[5]||(E[5]=l("div",{class:"my-4"},"Select workspace to duplicate shared base to:",-1)),s(j,{value:e(D),"onUpdate:value":E[0]||(E[0]=X=>xe(D)?D.value=X:null),class:"w-full",options:e(k),placeholder:"Select Workspace"},null,8,["value","options"])],64)):y("",!0),l("div",Hc,b(M.$t("title.advancedSettings")),1),s(J,{class:"!m-0 !p-0 !my-2"}),l("div",Kc,[s(U,{checked:e(c).includeData,"onUpdate:checked":E[1]||(E[1]=X=>e(c).includeData=X)},{default:i(()=>[Z(b(M.$t("labels.includeData")),1)]),_:1},8,["checked"]),s(U,{checked:e(c).includeViews,"onUpdate:checked":E[2]||(E[2]=X=>e(c).includeViews=X)},{default:i(()=>[Z(b(M.$t("labels.includeView")),1)]),_:1},8,["checked"])])]),l("div",qc,[s(B,{key:"back",type:"secondary",onClick:E[3]||(E[3]=X=>r.value=!1)},{default:i(()=>[Z(b(M.$t("general.cancel")),1)]),_:1}),ye((t(),u(B,{key:"submit",loading:e(a),disabled:!e(D)&&("isEeUI"in M?M.isEeUI:e(Ke)),onClick:w},{default:i(()=>[Z(b(M.$t("general.confirm")),1)]),_:1},8,["loading","disabled"])),[[Q,["a:shared-base:duplicate"]]])])]),_:1},8,["visible"])}}}),Qc=Object.assign(Jc,{__name:"DlgSharedBaseDuplicate"}),Hd=Se({__name:"index",setup(R){const{isSharedBase:A,isSharedErd:p}=se(Ze()),n=nt(),{populateWorkspace:o}=kt(),{signedIn:f}=Qe(),{isUIAllowed:N}=it(),V=Cs().currentRoute,{basesList:$}=se(n),r=async()=>{const g=V.value.name;if(g!=="index-typeOrId"&&g!=="index")return;const w=Po().get(),k=w?n.basesList.find(M=>M.id===w)??n.basesList[0]:n.basesList[0];k!=null&&k.id&&await n.navigateToProject({baseId:k.id})},c=ne(()=>{const g=V.value.name||"";return!g.startsWith("index-typeOrId-baseId-")&&!["index","index-typeOrId","index-typeOrId-feed","index-typeOrId-integrations"].includes(g)}),x=ne(()=>(V.value.name||"").startsWith("index-typeOrId-form-viewId")),{sharedBaseId:a}=Ma(),D=T(!1);async function q(){if(!c.value){if(V.value.params.typeOrId==="base"){await o();return}if(!f.value){Zt("/signIn");return}await o(),!V.value.params.baseId&&$.value.length>0&&await r()}}return Ye(()=>V.value.params.typeOrId,()=>{q()}),hs(()=>{q().then(()=>{if(a.value){if(!N("baseDuplicate")){Le.error("You are not allowed to create base");return}D.value=!0}})}),Ye([()=>x.value,()=>c.value,()=>A.value,()=>p.value],g=>{jo(!g.some(Boolean))},{immediate:!0}),(g,w)=>{const k=So,M=Vo,E=Fc,j=Qc;return t(),_("div",null,[e(x)?(t(),u(M,{key:0},{default:i(()=>[s(k)]),_:1})):e(c)?(t(),u(M,{key:1,name:"shared-view"},{default:i(()=>[s(k)]),_:1})):(t(),u(M,{key:2,name:"dashboard"},{sidebar:i(()=>[s(E)]),content:i(()=>[s(k)]),_:1})),e(N)("baseDuplicate")?(t(),u(j,{key:3,modelValue:e(D),"onUpdate:modelValue":w[0]||(w[0]=J=>xe(D)?D.value=J:null)},null,8,["modelValue"])):y("",!0)])}}});export{Hd as default};
