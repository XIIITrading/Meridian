const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BYPw9ET5.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./D_wq2ltS.js","./Item.C85DUSg3.css","./9aYOtC5C.js","./index.CotXCNy2.css","./DrCpvaRA.js","./Bo7kLdUR.js","./JUJEmhCv.js","./Modal.CB1oWLel.css","./SJHyi9T4.js","./DG2ZEhLK.js","./4PLl4EP6.js","./D2QgEzTv.js","./DcFNOSET.js","./boyBAVNN.js","./CFDwQBzt.js","./Overlay.CpKx7Pnx.css","./D1gZ4Fpg.js","./C83syoBY.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./index.Ws4Ly2yP.css","./AttachFile.D3qxYYb4.css"])))=>i.map(i=>d[i]);
import{e as ae,as as oe,fo as se,r as x,G as ne,gC as le,ot as ie,dw as re,aQ as T,bv as ce,I as r,o,w as f,a as s,t as i,L as e,b as p,K as _,O as de,d as g,M as pe,aT as O,b9 as R,c as m,ag as U,an as z,aq as me,P as S,c$ as ue,aS as fe,Q as _e,aW as ge}from"./DOFFjK0_.js";import{u as be,a as ve,_ as he}from"./DrCpvaRA.js";import{u as ye}from"./DG2ZEhLK.js";import{S as ke}from"./DEAKw9Pl.js";import"./Bo7kLdUR.js";import"./JUJEmhCv.js";import"./SJHyi9T4.js";import"./4PLl4EP6.js";import"./D2QgEzTv.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./CFDwQBzt.js";import"./D1gZ4Fpg.js";import"./C83syoBY.js";import"./CV-2bRRD.js";import"./CHgOe2F-.js";const we=fe(()=>ge(()=>import("./BYPw9ET5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),import.meta.url).then(C=>C.default||C)),xe={class:"flex justify-between pb-6 gap-4 items-center"},Ce={class:"font-semibold text-xl"},De={class:"flex items-center gap-2"},Me={class:"flex gap-2 items-center"},$e={class:"flex gap-2 items-center"},Ae={class:"p-4"},Fe={class:"text-brand-500 font-bold"},Ee={key:0,class:"flex flex-col gap-1"},Ie={class:"nc-attachment h-full w-full flex items-center justify-center"},Oe={class:"p-4"},Re={class:"font-semibold text-brand-500"},Se={class:"font-semibold"},Ve=ae({__name:"Modal",setup(C){const{isUIAllowed:V}=oe(),{isLoading:L,isPublic:j,isReadonly:c,visibleItems:b,modalVisible:l,column:P,onDrop:D,updateModelValue:Z,selectedFile:B,selectedVisibleItems:M,bulkDownloadAttachments:G}=be(),{onChange:K,open:Q}=se({reset:!0}),$=x(),A=ne(le,null),N=x(),{dragging:d}=ve(N,b,Z,c),q=function(...t){e(d)||D.apply(this,t)},{isOverDropZone:F}=ie($,q),{isSharedForm:v}=ye(),E=x(!1);re("Escape",()=>{l.value=!1,F.value=!1}),T(l,(t,a)=>{E.value||(setTimeout(()=>{E.value=!1},500),a&&!t&&(A==null||A.trigger()))});function H(t){B.value=t,E.value=!0,l.value=!1;const a=T(B,h=>{h||(setTimeout(()=>{l.value=!0},50),a==null||a())})}ce($,"paste",t=>{var a;(a=t.clipboardData)!=null&&a.files&&D(t.clipboardData.files)});const W=t=>{Q()};K(t=>{D(t,{})});const u=x(!1);return(t,a)=>{const h=pe,I=de,J=he,X=ke,Y=ue,ee=we,te=_e;return o(),r(te,{visible:e(l),"onUpdate:visible":a[4]||(a[4]=y=>S(l)?l.value=y:null),"wrap-class-name":"nc-modal-attachment-expand-cell",class:U(["nc-attachment-modal",{active:e(l)}]),width:"80%"},{default:f(()=>{var y;return[s("div",xe,[s("div",Ce,i((y=e(P))==null?void 0:y.title),1),s("div",De,[p(I,{disabled:!e(M).some(n=>!!n),type:"secondary",size:"small",onClick:e(G)},{default:f(()=>[s("div",Me,[p(h,{icon:"download"}),g(" "+i(t.$t("activity.bulkDownload")),1)])]),_:1},8,["disabled","onClick"]),e(v)||!e(c)&&e(V)("dataEdit")&&!e(j)?(o(),r(I,{key:0,class:"nc-attach-file group",size:"small","data-testid":"attachment-expand-file-picker-button",onClick:a[0]||(a[0]=n=>u.value=!0)},{default:f(()=>[s("div",$e,[(o(),r(O(("iconMap"in t?t.iconMap:e(R)).cellAttachment),{class:"w-4 h-4"})),g(" "+i(t.$t("activity.attachFile")),1)])]),_:1})):_("",!0),p(I,{type:"secondary",size:"small",onClick:a[1]||(a[1]=n=>l.value=!1)},{default:f(()=>[p(h,{icon:"close"})]),_:1})])]),s("div",{ref_key:"dropZoneRef",ref:$,tabindex:"0",class:"relative min-h-[96px]"},[e(v)||!e(c)&&!e(d)&&e(F)?(o(),m("div",{key:0,class:U(["text-white absolute inset-0 flex flex-col items-center justify-center border-dashed border-2 border-nc-border-gray-medium rounded-lg pt-2",{"border-nc-border-brand":!e(b).length}])},[(o(),r(O(("iconMap"in t?t.iconMap:e(R)).upload),{class:"w-8 h-8 text-brand-500"})),s("div",Ae,[s("h1",Fe,i(t.$t("labels.dropHere")),1)])],2)):_("",!0),e(b).length>0?(o(),m("div",{key:1,ref_key:"sortableRef",ref:N,class:"grid max-h-140 overflow-auto nc-scrollbar-md md:grid-cols-3 xl:grid-cols-5 gap-y-8 gap-x-4 relative"},[(o(!0),m(z,null,me(e(b),(n,k)=>(o(),r(J,{key:`${n==null?void 0:n.title}-${k}`,dragging:e(d),"onUpdate:dragging":a[2]||(a[2]=w=>S(d)?d.value=w:null),selected:e(M)[k],"onUpdate:selected":w=>e(M)[k]=w,attachment:n,index:k,"allow-selection":!0,"allow-rename":!e(v)||!e(c)&&e(V)("dataEdit")&&!e(j),"allow-delete":!e(c),onClicked:w=>H(n)},null,8,["dragging","selected","onUpdate:selected","attachment","index","allow-rename","allow-delete","onClicked"]))),128)),e(L)?(o(),m("div",Ee,[p(Y,{class:"nc-attachment-item group"},{default:f(()=>[s("div",Ie,[p(X,{class:""})])]),_:1})])):_("",!0)],512)):(o(),m("div",{key:2,class:"h-[30vh] min-h-[96px] border-dashed border-2 border-nc-border-medium rounded-lg justify-center cursor-pointer flex items-center flex-col",onClick:W},[e(v)||!e(c)&&!e(d)&&e(F)?_("",!0):(o(),m(z,{key:0},[(o(),r(O(("iconMap"in t?t.iconMap:e(R)).upload),{class:"w-8 h-8 text-gray-500"})),s("span",Oe,[g(i(t.$t("labels.clickTo"))+" ",1),s("span",Re,i(t.$t("labels.browseFiles")),1),g(" "+i(t.$t("general.or"))+" ",1),s("span",Se,i(t.$t("labels.dragFilesHere")),1),g(" "+i(t.$t("labels.toUpload")),1)])],64))])),e(u)?(o(),r(ee,{key:3,value:e(u),"onUpdate:value":a[3]||(a[3]=n=>S(u)?u.value=n:null)},null,8,["value"])):_("",!0)],512)]}),_:1},8,["visible","class"])}}}),Xe=Object.assign(Ve,{__name:"CellAttachmentModal"});export{Xe as default};
