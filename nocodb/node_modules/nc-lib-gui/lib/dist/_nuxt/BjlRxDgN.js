var P=Object.defineProperty;var T=(i,n,a)=>n in i?P(i,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[n]=a;var d=(i,n,a)=>T(i,typeof n!="symbol"?n+"":n,a);import{fE as f,e as F,ak as H,n as R,fF as W,fG as w,r as b,g as A,fH as G,a5 as Q,bx as U,aQ as k,c as X,o as q,_ as K}from"./DOFFjK0_.js";import{d as B}from"./boyBAVNN.js";const m=class m{constructor(n,a){d(this,"placeholder");d(this,"editor");d(this,"domNode",null);this.placeholder=n,this.editor=a,a.onDidChangeModelContent(()=>this.onDidChangeModelContent()),this.onDidChangeModelContent()}onDidChangeModelContent(){this.editor.getValue()===""?this.editor.addContentWidget(this):this.editor.removeContentWidget(this)}getId(){return m.ID}getDomNode(){return this.domNode||(this.domNode=document.createElement("div"),this.domNode.classList.add("formula-placeholder"),this.domNode.style.width="max-content",this.domNode.textContent=this.placeholder,this.editor.applyFontInfo(this.domNode)),this.domNode}getPosition(){return{position:{lineNumber:1,column:1},preference:[f.ContentWidgetPositionPreference.EXACT]}}dispose(){this.editor.removeContentWidget(this)}};d(m,"ID","editor.widget.placeholderHint");let S=m;const Y=F({__name:"Editor",props:{modelValue:{default:""},hideMinimap:{type:Boolean},lang:{default:"json"},validate:{type:Boolean,default:!0},disableDeepCompare:{type:Boolean,default:!1},placeholder:{},readOnly:{type:Boolean},autoFocus:{type:Boolean,default:!0},monacoConfig:{default:()=>({})},monacoCustomTheme:{default:()=>({})}},emits:["update:modelValue"],setup(i,{expose:n,emit:a}){const p=i,h=a,{modelValue:v,readOnly:O}=H(p),{hideMinimap:E,lang:s,validate:z,disableDeepCompare:_,autoFocus:j,monacoConfig:g,monacoCustomTheme:M,placeholder:V}=p;let D=!1;const r=R({get:()=>{const e=v.value;if(W(e)||w(e))return null;if(typeof e!="string")return JSON.stringify(e,null,2);if(s==="json"&&!D)try{if(e.trim()==="null")return'"null"';JSON.parse(e)}catch{return JSON.stringify(e)}finally{D=!0}return e},set:e=>{try{if(e==="null")h("update:modelValue",null);else if(typeof v.value=="object"){const o=typeof e=="object"?e:JSON.parse(e);h("update:modelValue",o)}else h("update:modelValue",e)}catch(o){console.error("Failed to parse JSON:",o)}}}),y=b(!0),C=b(""),N=b();let t;const x=(e=g.tabSize||2)=>{try{const o=JSON.parse(t==null?void 0:t.getValue());t.setValue(JSON.stringify(o,null,e))}catch(o){console.error("Failed to parse and format JSON:",o)}};return n({format:x,isValid:y,error:C}),A(async()=>{if(N.value&&s){const e=f.createModel(r.value,s);s==="json"&&G.json.jsonDefaults.setDiagnosticsOptions({validate:z});let o=!1;Object.keys(M).length&&(f.defineTheme("custom",M),o=!0),t=f.create(N.value,{model:e,contextmenu:!1,theme:o?"custom":"vs",foldingStrategy:"indentation",selectOnLineNumbers:!0,language:p.lang,scrollbar:{verticalScrollbarSize:1,horizontalScrollbarSize:1},lineNumbers:"off",tabSize:g.tabSize||2,automaticLayout:!0,readOnly:O.value,bracketPairColorization:{enabled:!0,independentColorPoolPerBracketType:!0},minimap:{enabled:!E},...s==="json"?{detectIndentation:!1,insertSpaces:!0}:{},...g}),t.onDidChangeModelContent(async()=>{try{if(y.value=!0,C.value="",_||s!=="json")r.value=t.getValue();else{const l=JSON.parse(t.getValue());(!l||!B(r.value,l))&&(r.value=l)}}catch(l){y.value=!1;const c=await Q(l);C.value=c,console.log(c)}}),V&&new S(V,t);const u=U();!u&&j&&t.focus(),u!=null&&u.classList.contains("json-modal")&&j&&setTimeout(()=>{var I,L;const l=((I=t.getModel())==null?void 0:I.getLineCount())??0,c=((L=t.getModel())==null?void 0:L.getLineContent(l).length)??0,J={lineNumber:l,column:c+1};t.setPosition(J),t.revealPositionInCenter(J),t.focus()},200),s==="json"&&x()}}),k(r,e=>{if(!t||!e)return;const o=t==null?void 0:t.getValue();!_&&s==="json"?(!o||!B(JSON.parse(e),JSON.parse(o)))&&t.setValue(e):o!==e&&t.setValue(e)}),k(O,e=>{t&&t.updateOptions({readOnly:e})}),(e,o)=>(q(),X("div",{ref_key:"root",ref:N},null,512))}}),te=Object.assign(K(Y,[["__scopeId","data-v-4ed57c93"]]),{__name:"MonacoEditor"});export{te as default};
