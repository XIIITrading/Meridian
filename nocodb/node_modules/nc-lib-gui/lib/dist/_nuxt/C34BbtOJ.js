const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CMyFGii6.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./qgYlKlk5.js","./Cb5B9eG-.js","./C_qz9woQ.js","./DA4KItu_.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./D8wgK-Ih.js","./HdsRe6lq.js","./index.N-A1gxk9.css","./DzBSAsxR.js","./FilterInput.7KjqjE1F.css","./DGuB8RA-.js","./4fFkR2QG.js","./Pagination.XVPzwtel.css","./D2QgEzTv.js","./SJHyi9T4.js","./DG2ZEhLK.js","./CAfhvBOi.js","./BYGCxle3.js","./DcFNOSET.js","./boyBAVNN.js","./4PLl4EP6.js","./Bgc5K1P7.js","./DEAKw9Pl.js","./CHgOe2F-.js","./CYkscC4Z.js","./ps5He39s.js","./Cl-qOJW6.js","./BcKPINb2.js","./VirtualCell.6f0pX0MN.css"])))=>i.map(i=>d[i]);
import{e as Ie,G as n,fT as Ce,kP as he,kO as ke,dJ as ge,gk as je,r as i,em as be,gD as Le,gB as Ee,mm as Re,gb as Ve,ko as Te,jf as Me,j7 as Pe,Y as J,j3 as ze,j8 as Ae,iC as Oe,gE as Ue,as as De,km as Be,n as g,kr as W,aQ as Y,g as Ne,i_ as Se,kQ as X,bz as $e,I as x,o as u,w as I,a as Z,c as j,K as _,cn as Fe,L as o,g$ as Ke,ag as ee,an as te,aq as Ge,N as b,b as L,O as He,M as Qe,ap as qe,aS as N,bw as Je,hU as We,aW as S,_ as Ye}from"./DOFFjK0_.js";import{_ as Xe}from"./31oN5MbZ.js";import{a as Ze}from"./4PLl4EP6.js";import{u as et}from"./CMyFGii6.js";import{u as tt}from"./CV-2bRRD.js";import"./Byuk3M83.js";import"./SJHyi9T4.js";import"./D2QgEzTv.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./qgYlKlk5.js";import"./Cb5B9eG-.js";import"./C_qz9woQ.js";import"./DA4KItu_.js";import"./D8wgK-Ih.js";import"./HdsRe6lq.js";import"./DzBSAsxR.js";import"./DGuB8RA-.js";import"./4fFkR2QG.js";import"./DG2ZEhLK.js";import"./CAfhvBOi.js";import"./BYGCxle3.js";import"./Bgc5K1P7.js";import"./DEAKw9Pl.js";import"./CHgOe2F-.js";import"./CYkscC4Z.js";import"./ps5He39s.js";import"./Cl-qOJW6.js";import"./BcKPINb2.js";const nt=N(()=>S(()=>import("./CMyFGii6.js").then(a=>a.L),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(a=>a.default||a)),at=N(()=>S(()=>import("./CMyFGii6.js").then(a=>a.U),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(a=>a.default||a)),ot=N(()=>S(()=>import("./CMyFGii6.js").then(a=>a.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url).then(a=>a.default||a)),lt={class:"nc-cell-field flex items-center gap-1 w-full chips-wrapper min-h-6.5 relative"},st=Ie({__name:"ManyToMany",async setup(a){let $,F;const y=n(Ce),ne=n(he),c=n(ke),ae=n(je,ge()),E=n(be,i(!1)),R=n(Le,i(!1)),p=n(Ee,null),f=n(Re,null),oe=n(Ve,i(!1)),C=n(Te,i(!1)),l=i(!1),s=i(!1),m=i(!1),h=i(!1),K=n(Me,i()),le=n(Pe,!1),V=n(Ae,J(ze)),se=n(Oe,J({})),d=n(Ue,null),{isUIAllowed:ie}=De(),{state:T,isNew:M,removeLTARRef:re}=Ze(),{relatedTableMeta:ue,loadRelatedTableMeta:me,relatedTableDisplayValueProp:P,unlink:ce}=et(y,ne,M,ae.trigger);[$,F]=Be(()=>me()),await $,F();const z=g(()=>!oe.value&&ie("dataEdit")&&!C.value||E.value),G=g(()=>{var e;return c!=null&&c.value?(c==null?void 0:c.value)??[]:M.value?((e=T==null?void 0:T.value)==null?void 0:e[y==null?void 0:y.value.title])??[]:[]}),A=g(()=>G.value.reduce((e,t)=>{if(!P.value)return e;const w=t[P.value];return[...e,{value:w,item:t}]},[])),pe=async e=>{M.value?await re(e,y.value):await ce(e)},fe=()=>{s.value=!1,l.value=!0,h.value=!1},de=()=>{l.value=!1,s.value=!0},v=()=>{C.value||(s.value=!0,l.value=!1,m.value=!0,h.value=!1)},O=()=>{z.value&&(l.value=!0,s.value=!1,m.value=!0,h.value=!0)};tt(n(W,i(!1)),e=>{switch(e.key){case"Enter":l.value=!0,e.stopPropagation();break}});const U=g(()=>{var e,t;return(t=(e=ue.value)==null?void 0:e.columns)==null?void 0:t.find(w=>w.title===P.value)});Y([s,l],()=>{m.value=s.value||l.value}),Y(m,e=>{e||(l.value=!1,s.value=!1)},{flush:"post"});const H=n(W,i(!1));function k(e){e.type==="click"&&(R.value||E.value||H.value)&&v()}const D=e=>{if(!(!(e instanceof KeyboardEvent)||!e.target||Je(e))&&We(e))return s.value?(l.value=!1,s.value=!1):v(),!0};return Ne(()=>{f==null||f.on(k),p==null||p.on(k),d==null||d.on(D),!(C.value||!le||R.value||!V)&&Se(()=>{D(se.event)||(X(".nc-canvas-table-editable-cell-wrapper .nc-many-to-many-plus-icon",V)?O():X(".nc-canvas-table-editable-cell-wrapper .nc-many-to-many-maximize-icon",V)?v():z.value?O():v())})}),$e(()=>{f==null||f.off(k),p==null||p.off(k),d==null||d.off(D)}),(e,t)=>{const w=Xe,Q=Qe,q=He,ve=qe,_e=nt,ye=at,we=ot;return u(),x(we,{"is-open":m.value,"onUpdate:isOpen":t[5]||(t[5]=r=>m.value=r)},{overlay:I(()=>[s.value?(u(),x(_e,{key:0,modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=r=>s.value=r),"cell-value":o(G),column:o(U),onAttachRecord:fe,onEscape:t[2]||(t[2]=r=>m.value=!1)},null,8,["modelValue","cell-value","column"])):_("",!0),l.value?(u(),x(ye,{key:1,modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=r=>l.value=r),column:o(U),"hide-back-btn":h.value,onAttachLinkedRecord:de,onEscape:t[4]||(t[4]=r=>m.value=!1)},null,8,["modelValue","column","hide-back-btn"])):_("",!0)]),default:I(()=>{var r;return[Z("div",lt,[Z("div",{class:ee(["chips flex items-center img-container flex-1 hm-items min-w-0 overflow-y-auto overflow-x-hidden",{"flex-wrap":o(K)!==1}]),style:Fe({maxHeight:`${("rowHeightInPx"in e?e.rowHeightInPx:o(Ke))[o(K)]}px`})},[o(A)?(u(),j(te,{key:0},[(u(!0),j(te,null,Ge(o(A),(B,xe)=>(u(),x(w,{key:xe,item:B.item,value:B.value,column:o(U),"show-unlink-button":!1,truncate:!1,onUnlink:it=>pe(B.item)},null,8,["item","value","column","onUnlink"]))),128)),((r=o(A))==null?void 0:r.length)===10?(u(),j("span",{key:0,class:"caption pointer ml-1 grey--text",onClick:b(v,["stop"])}," more... ")):_("",!0)],64)):_("",!0)],6),!o(C)||o(E)?(u(),j("div",{key:0,class:ee(["flex justify-end gap-[2px] min-h-4 items-center absolute right-0 top-0 bottom-0 many-to-many-actions",{active:o(H)}]),onClick:t[0]||(t[0]=b(()=>{},["stop"]))},[o(z)?(u(),x(q,{key:0,size:"xxsmall",type:"secondary",class:"nc-action-icon nc-many-to-many-plus-icon !h-5 !w-5",onClick:b(O,["stop"])},{default:I(()=>[L(Q,{icon:"plus",class:"text-sm nc-plus h-3 w-3"})]),_:1})):_("",!0),L(ve,{title:e.$t("tooltip.expandShiftSpace"),disabled:o(R),class:"flex"},{default:I(()=>[L(q,{size:"xxsmall",type:"secondary",class:"nc-action-icon nc-many-to-many-maximize-icon !h-5 !w-5",onClick:b(v,["stop"])},{default:I(()=>[L(Q,{icon:"maximize",class:"!h-3 !w.3"})]),_:1})]),_:1},8,["title","disabled"])],2)):_("",!0)])]}),_:1},8,["is-open"])}}}),Ut=Object.assign(Ye(st,[["__scopeId","data-v-3a036ef3"]]),{__name:"VirtualCellManyToMany"});export{Ut as default};
