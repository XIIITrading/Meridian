const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./2EkCyFsn.js","./SpSJ8E4d.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./C4GUhfWc.js","./BhfICdUA.js","./NRjd0XWG.js","./AddLookups.KR_6CRBc.css","./CUPIstUD.js","./DG2ZEhLK.js","./SJHyi9T4.js","./B3Wp9c04.js","./UpdateDisplayValue.DqWrwrOO.css"])))=>i.map(i=>d[i]);
import{e as Te,T as Ue,f as Ee,G as x,fT as yt,j9 as zt,n as K,r as D,aZ as Pe,S as je,J as qt,V as bt,am as Kt,I as c,o as s,L as e,P as ne,w as m,c as P,K as O,a as G,f_ as Yt,f$ as Wt,g0 as Jt,t as y,aD as ke,fU as Ve,fS as R,a4 as ie,a5 as oe,a6 as Qt,a8 as gt,U as Xt,fQ as Ne,ab as Zt,a3 as Ht,ag as Be,b as w,d as S,ae as ei,O as ti,ai as ct,as as wt,W as ht,cd as Ct,lb as ii,av as pt,gk as li,aY as ai,aM as si,gD as ni,a9 as oi,aC as mt,j6 as $e,aj as $,lc as di,al as ui,f8 as ri,ld as ci,ac as pi,aA as mi,aT as J,b9 as q,an as he,ad as te,M as vi,ah as Ce,ap as fi,gq as vt,bb as Re,aS as Ge,bc as _i,aJ as yi,kt as ft,le as bi,$ as gi,fR as wi,b0 as _t,aW as xe,aX as hi,_ as Ci}from"./DOFFjK0_.js";import{_ as ki}from"./BRTCxTHu.js";import{_ as Ti}from"./D_wq2ltS.js";import{_ as Ei}from"./DDEVLD8O.js";import{_ as Si}from"./-rIuSlCu.js";import Ii from"./DiUleKVo.js";import{u as Se}from"./DG2ZEhLK.js";import{_ as Li}from"./JUJEmhCv.js";import{_ as Oi}from"./SpSJ8E4d.js";import{_ as Mi}from"./9aYOtC5C.js";import{u as Ai}from"./B3Wp9c04.js";import{a as Di}from"./Dh5zKH8k.js";import{u as Fi}from"./BYGCxle3.js";const $i={key:0,class:"flex flex-row items-center py-2 px-3 bg-gray-50 rounded-lg text-gray-700 mb-4"},Ri={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-1.5",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},Vi=Te({__name:"DeleteColumnModal",props:{visible:{type:Boolean},onDeleteColumn:{type:Function}},emits:["update:visible"],setup(h,{emit:Z}){const r=h,V=Ue(r,"visible",Z),{$api:k,$e:i}=Ee(),A=x(yt),z=x(zt),b=K(()=>(A==null?void 0:A.value)||(z==null?void 0:z.value)),{eventBus:Y}=Se(),v=x(Pe,D()),{getMeta:W}=je(),{includeM2M:n}=qt(),{loadTables:C}=bt(),ae=Kt(),I=D(!1),j=async()=>{var N,_,o,p;if(b.value){I.value=!0;try{await k.dbTableColumn.delete(b.value.id),await W((N=v==null?void 0:v.value)==null?void 0:N.id,!0),ke(b.value)&&((_=b.value)!=null&&_.colOptions)&&(await W(b.value.colOptions.fk_related_model_id,!0),n.value&&b.value.colOptions.type===Ve.MANY_TO_MANY&&C()),ae.updateViewCoverImageColumnId({metaId:(o=v.value)==null?void 0:o.id,columnIds:new Set([b.value.id])}),Y.emit(R.FIELD_UPDATE),i("a:column:delete"),V.value=!1,(p=r.onDeleteColumn)==null||p.call(r)}catch(f){ie.error(await oe(f))}finally{I.value=!1}}};return(N,_)=>{const o=Wt,p=Jt,f=Ii;return s(),c(f,{visible:e(V),"onUpdate:visible":_[0]||(_[0]=F=>ne(V)?V.value=F:null),"entity-name":N.$t("objects.column"),"on-delete":j},{"entity-preview":m(()=>[e(b)?(s(),P("div",$i,[e(Yt)(e(b))?(s(),c(o,{key:0,class:"nc-view-icon"})):(s(),c(p,{key:1,class:"nc-view-icon"})),G("div",Ri,y(e(b).title),1)])):O("",!0)]),_:1},8,["visible","entity-name"])}}}),Bi=Object.assign(Vi,{__name:"SmartsheetHeaderDeleteColumnModal"}),Ui={class:"text-base text-nc-content-gray-emphasis leading-6 font-bold self-center"},Pi={class:"mt-5 flex gap-3 flex-col"},ji={class:"flex flex-row gap-x-2 mt-5 justify-end"},Ni=Te({__name:"Duplicate",props:{modelValue:{type:Boolean},column:{},extra:{}},emits:["update:modelValue"],setup(h,{expose:Z,emit:r}){const U=h,V=r,{api:k}=Qt(),i=Ue(U,"modelValue",V),{$e:A,$poller:z}=Ee(),{activeTable:b}=gt(Xt()),Y=x(Ne),{eventBus:v}=Se(),{getMeta:W}=je(),n=x(Pe,D()),C=D({includeData:!0}),ae=K(()=>{const{includeData:_}=C.value;return{excludeData:!_}}),I=D(!1),j=async()=>{await W(n.value.id,!0),v.emit(R.FIELD_RELOAD),Y==null||Y.trigger()},N=async()=>{try{I.value=!0;const _=await k.dbTable.duplicateColumn(U.column.base_id,U.column.id,{options:ae.value,extra:U.extra});z.subscribe({id:_.id},async o=>{o.status!=="close"&&(o.status===ct.COMPLETED?(j(),I.value=!1,i.value=!1):o.status===ct.FAILED&&(ie.error("There was an error duplicating the column."),j(),I.value=!1,i.value=!1))}),A("a:column:duplicate")}catch(_){ie.error(await oe(_)),I.value=!1,i.value=!1}};return Zt("Enter",()=>{i.value&&N()}),Z({duplicate:N}),(_,o)=>{const p=ei,f=ti,F=Li;return s(),c(F,{visible:e(i),"onUpdate:visible":o[2]||(o[2]=M=>ne(i)?i.value=M:null),class:Be([{active:e(i)},"!w-[30rem]"]),"mask-closable":!e(I),keyboard:!e(I),centered:"","mask-style":{"background-color":"rgba(0, 0, 0, 0.08)"},"wrap-class-name":"nc-modal-column-duplicate",footer:null,onKeydown:o[3]||(o[3]=Ht(M=>i.value=!1,["esc"]))},{default:m(()=>[G("div",null,[G("div",Ui,y(_.$t("general.duplicate"))+" "+y(_.$t("objects.column"))+' "'+y(_.column.title)+'" ',1),G("div",Pi,[G("div",{class:"flex gap-3 cursor-pointer leading-5 text-nc-content-gray font-medium items-center",onClick:o[0]||(o[0]=M=>e(C).includeData=!e(C).includeData)},[w(p,{checked:e(C).includeData},null,8,["checked"]),S(" "+y(_.$t("labels.includeData")),1)])])]),G("div",ji,[e(I)?O("",!0):(s(),c(f,{key:"back",type:"secondary",size:"small",onClick:o[1]||(o[1]=M=>i.value=!1)},{default:m(()=>[S(y(_.$t("general.cancel")),1)]),_:1})),w(f,{key:"submit",type:"primary",size:"small",loading:e(I),onClick:N},{default:m(()=>o[4]||(o[4]=[S(" Duplicate Field ")])),_:1,__:[4]},8,["loading"])])]),_:1},8,["visible","class","mask-closable","keyboard"])}}}),Gi=Object.assign(Ni,{__name:"DlgColumnDuplicate"}),xi=Te({__name:"Permissions",props:{visible:{type:Boolean},fieldId:{},fieldTitle:{},fieldUidt:{}},emits:["update:visible"],setup(h){return(Z,r)=>{const U=Oi;return s(),c(U)}}}),zi=Object.assign(xi,{__name:"DlgFieldPermissions"});function qi(h,Z){const{sorts:r,eventBus:U}=Se(),{$api:V,$e:k}=Ee(),{isUIAllowed:i}=wt(),{isSharedBase:A}=gt(bt()),{addUndo:z,clone:b,defineViewScope:Y}=ht(),v=x(Ne),W=x(Ct,D(!1)),n=D([]);ii(r,o=>{n.value=b(o)});const C=async()=>{if(W.value){r.value=[];return}try{if(!i("sortSync")||!(h!=null&&h.value))return;r.value=(await V.dbTableSort.list(h.value.id)).list}catch(o){console.error(o),ie.error(await oe(o))}},ae=(o,p)=>Object.entries(p).filter(([f,F])=>o[f]!==F&&f in o).reduce((f,[F,M])=>({...f,[F]:M}),{}),I=async(o,p,f=!1)=>{var F;if(!f){const M=n.value[p];if(M){const H=b(ae(o,M));Object.keys(H).length>0&&z({undo:{fn:(Q,X)=>{const B=r.value[p];B&&(B[Q]=X,I(B,p,!0))},args:[Object.keys(H)[0],Object.values(H)[0]]},redo:{fn:(Q,X)=>{const B=r.value[p];B&&(B[Q]=X,I(B,p,!0))},args:[Object.keys(H)[0],o[Object.keys(H)[0]]]},scope:Y({view:h.value})})}}if(W.value||A.value){r.value[p]=o,r.value=[...r.value],v==null||v.trigger();return}try{i("sortSync")&&(o.id?(await V.dbTableSort.update(o.id,o),k("sort-updated")):r.value[p]=await V.dbTableSort.create((F=h.value)==null?void 0:F.id,o)),Z==null||Z(),k("a:sort:dir",{direction:o.direction})}catch(M){console.error(M),ie.error(await oe(M))}n.value=b(r.value)},j=async({direction:o,column:p,reloadDataHook:f})=>{var F;try{k("a:sort:add",{from:"column-menu"});const M=r.value.findIndex(X=>X.fk_column_id===p.id),H=M>-1?r.value[M]:void 0;H&&(await V.dbTableSort.delete(H.id),k("a:sort:delete"));const Q=await V.dbTableSort.create((F=h.value)==null?void 0:F.id,{fk_column_id:p.id,direction:o,push_to_top:!0});r.value=[...r.value.filter((X,B)=>B!==M),Q],z({redo:{fn:async function(){var ce;const B=await V.dbTableSort.create((ce=h.value)==null?void 0:ce.id,{fk_column_id:p.id,direction:o,push_to_top:!0});this.undo.args=[B.id],U.emit(R.SORT_RELOAD),f==null||f.trigger()},args:[]},undo:{fn:async function(B){await V.dbTableSort.delete(B),U.emit(R.SORT_RELOAD),f==null||f.trigger()},args:[Q.id]},scope:Y({view:h.value})}),U.emit(R.SORT_RELOAD),f==null||f.trigger()}catch(M){console.error(M),ie.error(await oe(M))}};async function N(o,p,f=!1){try{i("sortSync")&&o.id&&!W.value&&!A.value&&await V.dbTableSort.delete(o.id),r.value.splice(p,1),r.value=[...r.value],f||z({redo:{fn:async()=>{await N(o,p,!0)},args:[]},undo:{fn:()=>{r.value.splice(p,0,o),I(o,p,!0)},args:[b(o),p]},scope:Y({view:h.value})}),n.value=b(r.value),v==null||v.trigger(),k("a:sort:delete")}catch(F){console.error(F),ie.error(await oe(F))}}const _=(o=!1,p)=>{var f;r.value=[...r.value,{fk_column_id:p==null?void 0:p.id,direction:"asc"}],k("a:sort:add",{length:(f=r==null?void 0:r.value)==null?void 0:f.length}),o||z({undo:{fn:async()=>{await N(r.value[r.value.length-1],r.value.length-1,!0)},args:[]},redo:{fn:()=>{_(!0)},args:[]},scope:Y({view:h.value})}),n.value=b(r.value)};return{sorts:r,loadSorts:C,addSort:_,deleteSort:N,saveOrUpdate:I,insertSort:j}}const Ki=Ge(()=>xe(()=>import("./2EkCyFsn.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(h=>h.default||h)),Yi=Ge(()=>xe(()=>import("./C4GUhfWc.js"),__vite__mapDeps([4,2,3,5,6,7]),import.meta.url).then(h=>h.default||h)),Wi=Ge(()=>xe(()=>import("./CUPIstUD.js"),__vite__mapDeps([8,2,3,9,10,11,12]),import.meta.url).then(h=>h.default||h)),Ji={class:"nc-column-edit nc-header-menu-item"},Qi={class:"nc-column-duplicate nc-header-menu-item"},Xi={class:"nc-column-duplicate nc-header-menu-item"},Zi={class:"nc-column-edit nc-header-menu-item"},Hi={class:"nc-column-edit-description nc-header-menu-item"},el={class:"nc-column-field-permissions nc-header-menu-item w-full"},tl={class:"flex-1"},il={class:"nc-column-lookup-create nc-header-menu-item"},ll={class:"nc-column-insert-before nc-header-menu-item"},al={class:"nc-column-set-primary nc-header-menu-item item"},sl={class:"nc-column-insert-after nc-header-menu-item"},nl={class:"nc-column-insert-before nc-header-menu-item"},ol={class:"nc-column-filter nc-header-menu-item"},dl={class:"nc-column-groupby nc-header-menu-item"},ul={class:"nc-column-insert-after nc-header-menu-item"},rl={class:"nc-column-insert-before nc-header-menu-item"},cl={class:"non-menu-items"},pl=Te({__name:"ColumnMenu",props:{virtual:{type:Boolean},isOpen:{type:Boolean},isHiddenCol:{type:Boolean},column:{}},emits:["edit","addColumn","update:isOpen"],setup(h,{emit:Z}){const r=h,U=Z,V=pt(r,"virtual"),k=Ue(r,"isOpen",U),i=pt(r,"column");hi(yt,i);const{eventBus:A,allFilters:z,isSqlView:b,sorts:Y}=Se(),v=x(Ne),W=x(li,null),n=x(Pe,D()),C=x(ai,D()),ae=x(Ct,D(!1)),I=x(si,D(!1)),j=x(ni,D(!1)),{insertSort:N}=qi(C,()=>v==null?void 0:v.trigger()),{$api:_,$e:o}=Ee(),{t:p}=oi(),{getMeta:f}=je(),{addUndo:F,defineModelScope:M,defineViewScope:H}=ht(),Q=D(!1),{gridViewCols:X}=Ai(),{fieldsToGroupBy:B,groupByLimit:ce}=Di(),{isUIAllowed:se,isMetaReadOnly:pe,isDataReadOnly:kt}=wt(),{isTableAndFieldPermissionsEnabled:Tt}=Fi(),de=D(""),Et=async()=>{var t,l,d,a,u;de.value="setDisplay";try{const g=(l=(t=n==null?void 0:n.value)==null?void 0:t.columns)==null?void 0:l.find(T=>T.pv);k.value=!1,await _.dbTableColumn.primaryColumnSet((d=i==null?void 0:i.value)==null?void 0:d.id),await f((a=n==null?void 0:n.value)==null?void 0:a.id,!0),A.emit(R.FIELD_RELOAD),o("a:column:set-primary"),F({redo:{fn:async T=>{var E;await _.dbTableColumn.primaryColumnSet(T),await f((E=n==null?void 0:n.value)==null?void 0:E.id,!0),A.emit(R.FIELD_RELOAD)},args:[(u=i==null?void 0:i.value)==null?void 0:u.id]},undo:{fn:async T=>{var E;await _.dbTableColumn.primaryColumnSet(T),await f((E=n==null?void 0:n.value)==null?void 0:E.id,!0),A.emit(R.FIELD_RELOAD)},args:[g==null?void 0:g.id]},scope:M({model:n.value})}),v==null||v.trigger(),W==null||W.trigger()}catch{ie.error(p("msg.error.primaryColumnUpdateFailed"))}finally{de.value=""}},ze=async t=>{await N({column:i.value,direction:t,reloadDataHook:v})},me=D(!1),qe=D(),ve=D(),St=async()=>{var d;let t={};const l=wi(`${i.value.title} copy`,n.value.columns);t={...i.value,...i.value.colOptions??{},title:l,column_name:l.replace(/\s/g,"_"),id:void 0,colOptions:void 0,order:void 0,system:!1};try{const a=(await _.dbViewColumn.list((d=C.value)==null?void 0:d.id)).list,u=a.findIndex(T=>T.fk_column_id===i.value.id);let g;u===a.length-1?g=a[u].order+1:g=(a[u].order+a[u+1].order)/2,await _.dbTableColumn.create(n.value.id,{...t,pv:!1,view_id:C.value.id,column_order:{order:g,view_id:C.value.id}}),await f(n.value.id,!0),A.emit(R.FIELD_RELOAD),v==null||v.trigger()}catch(a){ie.error(await oe(a))}k.value=!1},Ke=async()=>{var t;if(i!=null&&i.value)if(i.value.uidt&&[$.Lookup,$.Rollup,$.CreatedTime,$.LastModifiedTime,$.CreatedBy,$.LastModifiedBy].includes(i.value.uidt))St();else{const l=(await _.dbViewColumn.list((t=C.value)==null?void 0:t.id)).list,d=l.findIndex(u=>u.fk_column_id===i.value.id);let a;d===l.length-1?a=l[d].order+1:a=(l[d].order+l[d+1].order)/2,qe.value={pv:!1,view_id:C.value.id,column_order:{order:a,view_id:C.value.id}},i.value.uidt===$.Formula||i.value.uidt===$.Button?gi(()=>{var u;(u=ve==null?void 0:ve.value)==null||u.duplicate()}):me.value=!0,k.value=!1}},Ye=async(t=!1)=>{var u,g,T,E;const l=(await _.dbViewColumn.list((u=C.value)==null?void 0:u.id)).list,d=l.findIndex(le=>le.fk_column_id===i.value.id);let a;t?d===0?a=l[d].order/2:a=(l[d].order+((g=l[d-1])==null?void 0:g.order))/2:d===l.length-1?a=l[d].order+1:a=(l[d].order+((T=l[d+1])==null?void 0:T.order))/2,U("addColumn",{column_order:{order:a,view_id:(E=C.value)==null?void 0:E.id}})},It=()=>{var t,l,d,a,u,g;return((t=n.value)==null?void 0:t.id)!==((l=C.value)==null?void 0:l.fk_model_id)?(u=(a=(d=n.value)==null?void 0:d.views)==null?void 0:a.find(T=>T.is_default))==null?void 0:u.id:(g=C.value)==null?void 0:g.id},Ie=(t,l=!1)=>{var d,a,u,g,T;!n.value||!t||((d=n.value)==null?void 0:d.id)!==((a=C.value)==null?void 0:a.fk_model_id)||!((u=C.value)!=null&&u.is_default)||(n.value.columns=(n.value.columns||[]).map(E=>(E.id!==t||(E.meta={..._t(E.meta||{}),defaultViewColVisibility:l}),E)),(T=(g=n.value)==null?void 0:g.columnsById)!=null&&T[t]&&(n.value.columnsById[t].meta={..._t(n.value.columnsById[t].meta),defaultViewColVisibility:l}))},Lt=async()=>{var l;de.value="hideOrShow";const t=It();try{const a=(await _.dbViewColumn.list(t)).list.find(u=>u.fk_column_id===i.value.id);await _.dbViewColumn.update(C.value.id,a.id,{show:!a.show}),j.value?await f((l=n==null?void 0:n.value)==null?void 0:l.id,!0):Ie(i==null?void 0:i.value.id,!a.show),A.emit(R.FIELD_RELOAD),a.show||v==null||v.trigger(),F({redo:{fn:async function(g,T,E){var le;await _.dbViewColumn.update(t,g,{show:!E}),j.value?await f((le=n==null?void 0:n.value)==null?void 0:le.id,!0):Ie(T,!E),A.emit(R.FIELD_RELOAD),E||v==null||v.trigger()},args:[a.id,a.fk_column_id,a.show]},undo:{fn:async function(g,T,E){var le;await _.dbViewColumn.update(t,g,{show:E}),j.value?await f((le=n==null?void 0:n.value)==null?void 0:le.id,!0):Ie(T,E),await Promise.all(promises),A.emit(R.FIELD_RELOAD),v==null||v.trigger(),E&&(v==null||v.trigger())},args:[a.id,a.fk_column_id,a.show]},scope:H({view:C.value})})}catch(d){console.log("error",d),ie.error(p("msg.error.columnVisibilityUpdateFailed"))}de.value="",k.value=!1},Ot=()=>{k.value=!1,Q.value=!0},We=(t,l=!1)=>{k.value=!1,U("edit",t,l,i.value)},Mt=()=>{k.value=!1,Ye(!0)},At=()=>{k.value=!1,Ye()},Je=K(()=>{var t,l;return(i==null?void 0:i.value)&&!mt(i.value)&&(!((t=n.value)!=null&&t.synced)||!((l=i.value)!=null&&l.readonly))}),fe=K(()=>{var t,l,d,a;return(i==null?void 0:i.value)&&!i.value.system&&(!pe.value&&!kt.value||$e.includes((t=i.value)==null?void 0:t.uidt))&&!((l=i.value.meta)!=null&&l.custom)&&i.value.uidt!==$.ForeignKey&&(!((d=n.value)!=null&&d.synced)||!((a=i.value)!=null&&a.readonly))&&!di(i.value)}),Le=K(()=>{var t;return!!(((t=n.value)==null?void 0:t.columns)||[]).find(l=>{var d;return l.id===((d=i==null?void 0:i.value)==null?void 0:d.id)&&![$.QrCode,$.Barcode,$.Button].includes(l.uidt)})}),ue=K(()=>{var t;return!!(((t=n.value)==null?void 0:t.columns)||[]).find(l=>{var d;return l.id===((d=i==null?void 0:i.value)==null?void 0:d.id)&&![$.Button].includes(l.uidt)})}),{getPlanLimit:Dt}=ui(),Oe=K(()=>z.value.filter(t=>!(t.is_group||t.status==="delete")).length>=Dt(ri.LIMIT_FILTER_PER_VIEW)),_e=K(()=>{var t,l;return!!((l=X.value[(t=i==null?void 0:i.value)==null?void 0:t.id])!=null&&l.group_by)}),Me=K(()=>!!(B.value||[]).find(t=>{var l;return t.id===((l=i==null?void 0:i.value)==null?void 0:l.id)})),Ae=K(()=>{const t=Object.values(X.value).filter(l=>l.group_by);return!(B.value.length&&B.value.length>t.length&&t.length<ce)}),Qe=t=>{i!=null&&i.value&&A.emit(t,i.value),k.value=!1},De=K(()=>{var t;return!(pe.value&&!$e.includes((t=i.value)==null?void 0:t.uidt)||b.value)}),Xe=K(()=>{var t,l,d,a;return!(pe.value&&!$e.includes((t=i.value)==null?void 0:t.uidt)&&!ci.includes((l=i.value)==null?void 0:l.uidt)||b.value||(d=n.value)!=null&&d.synced&&((a=i.value)!=null&&a.readonly))}),ye=K(()=>{var t,l;return(l=(t=n.value)==null?void 0:t.columns)==null?void 0:l.filter(d=>{var a,u,g;return ke(d)&&[(a=d.colOptions)==null?void 0:a.fk_child_column_id,(u=d.colOptions)==null?void 0:u.fk_parent_column_id].includes((g=i==null?void 0:i.value)==null?void 0:g.id)})}),be=D(!1),Ft=()=>{k.value=!1,be.value=!0},ge=D(!1),$t=()=>{k.value=!1,ge.value=!0},we=D(!1),Rt=()=>{k.value=!1,we.value=!0},Vt=()=>{var d,a;A.emit(R.FIELD_RELOAD);const t=(d=z.value)==null?void 0:d.some(u=>u.fk_column_id===i.value.id),l=(a=Y.value)==null?void 0:a.some(u=>u.fk_column_id===i.value.id);l&&A.emit(R.SORT_RELOAD),(t||l)&&A.emit(R.DATA_RELOAD)};return(t,l)=>{const d=ki,a=mi,u=Ti,g=Ei,T=vi,E=Ki,le=Si,re=fi,Ze=yi,Bt=Bi,Ut=Gi,Pt=Yi,jt=Wi,Nt=zi,Gt=Mi,ee=pi("e");return s(),c(Gt,{variant:"small",class:Be(["flex flex-col gap-1 border-gray-200 nc-column-options !min-w-55",{"min-w-[256px]":e(j)}])},{default:m(()=>{var He,et,tt,it,lt,at,st,nt,ot,dt,ut;return[e(i)?(s(),c(d,{key:0,id:e(i).id,"data-testid":"nc-field-item-action-copy-id",tooltip:t.$t("msg.clickToCopyFieldId"),label:t.$t("labels.idColon",{id:e(i).id})},null,8,["id","tooltip","label"])):O("",!0),w(a),e(se)("fieldAlter")?(s(),c(g,{key:1,message:"Field properties cannot be edited.",enabled:!e(Xe),"is-sql-view":e(b)},{default:m(()=>{var L,Fe,rt;return[w(u,{disabled:((L=e(i))==null?void 0:L.pk)||e(mt)(e(i))||!e(Xe)||((Fe=e(ye))==null?void 0:Fe.length),title:(rt=e(ye))!=null&&rt.length?"Field is associated with a link column":void 0,onClick:l[0]||(l[0]=xt=>We(xt,!1))},{default:m(()=>[G("div",Ji,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).ncEdit),{class:"opacity-80"})),S(" "+y(t.$t("general.edit"))+" "+y(t.$t("objects.field").toLowerCase()),1)])]),_:1},8,["disabled","title"])]}),_:1},8,["enabled","is-sql-view"])):O("",!0),e(j)?O("",!0):(s(),P(he,{key:2},[(He=e(i))!=null&&He.pk?O("",!0):(s(),c(g,{key:0,message:"Field cannot be duplicated.",enabled:!e(fe)&&e(pe),"is-sql-view":e(b)},{default:m(()=>[w(u,{disabled:!e(fe)||e(b),onClick:Ke},{default:m(()=>[te((s(),P("div",Qi,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).duplicate),{class:"opacity-80"})),S(" "+y(e(p)("general.duplicate"))+" "+y(t.$t("objects.field").toLowerCase()),1)])),[[ee,["a:field:duplicate"]]])]),_:1},8,["disabled"])]),_:1},8,["enabled","is-sql-view"])),e(se)("duplicateColumn")&&e(j)&&!((et=e(i))!=null&&et.pk)?(s(),c(g,{key:1,message:"Field cannot be duplicated.",enabled:!e(fe)},{default:m(()=>[w(u,{disabled:!e(fe)||e(b),onClick:Ke},{default:m(()=>[te((s(),P("div",Xi,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).duplicate),{class:"opacity-80"})),S(" "+y(e(p)("general.duplicate"))+" "+y(t.$t("objects.field").toLowerCase()),1)])),[[ee,["a:field:duplicate"]]])]),_:1},8,["disabled"])]),_:1},8,["enabled"])):O("",!0)],64)),e(se)("fieldAlter")&&((tt=e(i))!=null&&tt.pv)?(s(),c(u,{key:3,title:"Select a new field as display value",onClick:$t},{default:m(()=>[G("div",Zi,[w(T,{icon:"star",class:"opacity-80 !w-4.25 !h-4.25"}),S(" "+y(t.$t("labels.changeDisplayValueField")),1)])]),_:1})):O("",!0),e(se)("fieldAlter")&&!e(b)&&e(i).uidt!==e($).ForeignKey?(s(),c(u,{key:4,title:"Add field description",onClick:l[1]||(l[1]=L=>We(L,!0))},{default:m(()=>[G("div",Hi,[w(T,{icon:"ncAlignLeft",class:"opacity-80 !w-4.25 !h-4.25"}),S(" "+y(t.$t("labels.editFieldDescription")),1)])]),_:1})):O("",!0),e(Tt)&&("isEeUI"in t?t.isEeUI:e(Ce))&&e(se)("fieldAlter")&&!e(b)&&e(i).uidt!==e($).ForeignKey?(s(),c(re,{key:5,disabled:("showEditRestrictedColumnTooltip"in t?t.showEditRestrictedColumnTooltip:e(vt))(e(i)),placement:"right",arrow:!1},{title:m(()=>[S(y(t.$t("tooltip.dataInThisFieldCantBeManuallyEdited")),1)]),default:m(()=>[w(le,{feature:e(Re).FEATURE_TABLE_AND_FIELD_PERMISSIONS},{default:m(({click:L})=>[w(u,{disabled:!("showEditRestrictedColumnTooltip"in t?t.showEditRestrictedColumnTooltip:e(vt))(e(i)),onClick:Fe=>L(e(Re).FEATURE_TABLE_AND_FIELD_PERMISSIONS,()=>{Rt()})},{default:m(()=>[G("div",el,[w(T,{icon:"ncLock",class:"opacity-80 !w-4.25 !h-4.25"}),G("div",tl,y(t.$t("title.editFieldPermissions")),1),w(E,{feature:e(Re).FEATURE_TABLE_AND_FIELD_PERMISSIONS,title:t.$t("upgrade.upgradeToUseTableAndFieldPermissions"),content:t.$t("upgrade.upgradeToUseTableAndFieldPermissionsSubtitle",{plan:e(_i).PLUS}),"on-click-callback":()=>{k.value=!1},size:"xs"},null,8,["feature","title","content","on-click-callback"])])]),_:2},1032,["disabled","onClick"])]),_:1},8,["feature"])]),_:1},8,["disabled"])):O("",!0),[e($).LinkToAnotherRecord,e($).Links].includes(e(i).uidt)?(s(),c(u,{key:6,disabled:e(b),onClick:Ft},{default:m(()=>[te((s(),P("div",il,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).cellLookup),{class:"opacity-80 !w-4.5 !h-4.5"})),S(" "+y(e(p)("general.addLookupField")),1)])),[[ee,["a:field:lookup:create"]]])]),_:1},8,["disabled"])):O("",!0),e(se)("fieldAlter")&&!((it=e(i))!=null&&it.pv)?(s(),c(a,{key:7})):O("",!0),(lt=e(i))!=null&&lt.pv?O("",!0):(s(),c(u,{key:8,disabled:e(I),onClick:Lt},{default:m(()=>[te((s(),P("div",ll,[e(de)==="hideOrShow"?(s(),c(Ze,{key:0,size:"regular"})):(s(),c(J(t.isHiddenCol?("iconMap"in t?t.iconMap:e(q)).eye:("iconMap"in t?t.iconMap:e(q)).eyeSlash),{key:1,class:"!w-4 !h-4 opacity-80"})),S(" "+y(t.isHiddenCol?t.$t("general.showField"):t.$t("general.hideField")),1)])),[[ee,["a:field:hide"]]])]),_:1},8,["disabled"])),e(i)&&!((at=e(i))!=null&&at.pv)&&!t.isHiddenCol&&(!e(V)||e(i).uidt===e($).Formula)?(s(),c(re,{key:9,disabled:e(ft)(e(i)),placement:"right"},{title:m(()=>[S(y(`${e(bi)(e(i))} field cannot be used as display value field`),1)]),default:m(()=>[w(u,{disabled:e(I)||!e(ft)(e(i)),onClick:Et},{default:m(()=>[G("div",al,[e(de)==="setDisplay"?(s(),c(Ze,{key:0,size:"regular"})):(s(),c(T,{key:1,icon:"star",class:"opacity-80 !w-4.25 !h-4.25"})),S(" "+y(t.$t("activity.setDisplay")),1)])]),_:1},8,["disabled"])]),_:1},8,["disabled"])):O("",!0),e(j)?O("",!0):(s(),P(he,{key:10},[!e(ke)(e(i))||e(i).colOptions.type!==e(Ve).BELONGS_TO?(s(),c(a,{key:0})):O("",!0),!e(ke)(e(i))||e(i).colOptions.type!==e(Ve).BELONGS_TO?(s(),P(he,{key:1},[w(re,{disabled:e(ue)},{title:m(()=>[S(y(e(ue)?"":"This field type doesn't support sorting"),1)]),default:m(()=>[w(u,{disabled:e(I)||!e(ue),onClick:l[2]||(l[2]=L=>ze("asc"))},{default:m(()=>[te((s(),P("div",sl,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).sortDesc),{class:"opacity-80 transform !rotate-180 !w-4.25 !h-4.25"})),S(" "+y(t.$t("general.sortAsc")),1)])),[[ee,["a:field:sort",{dir:"asc"}]]])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),w(re,{disabled:e(ue)},{title:m(()=>[S(y(e(ue)?"":"This field type doesn't support sorting"),1)]),default:m(()=>[w(u,{disabled:e(I)||!e(ue),onClick:l[3]||(l[3]=L=>ze("desc"))},{default:m(()=>[te((s(),P("div",nl,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).sortDesc),{class:"opacity-80 !w-4.25 !h-4.25"})),S(" "+y(t.$t("general.sortDesc").trim()),1)])),[[ee,["a:field:sort",{dir:"desc"}]]])]),_:1},8,["disabled"])]),_:1},8,["disabled"])],64)):O("",!0),w(a),w(re,{disabled:e(Le)&&!e(Oe)},{title:m(()=>[S(y(e(Le)?e(Oe)?"Filter by limit exceeded":"":"This field type doesn't support filtering"),1)]),default:m(()=>[w(u,{disabled:e(I)||!e(Le)||e(Oe),onClick:l[4]||(l[4]=L=>Qe(e(R).FILTER_ADD))},{default:m(()=>[te((s(),P("div",ol,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).filter),{class:"opacity-80"})),S(" "+y(t.$t("activity.filterByThisField")),1)])),[[ee,["a:field:add:filter"]]])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),w(re,{disabled:e(Me)&&!e(Ae)||e(_e)||!(("isEeUI"in t?t.isEeUI:e(Ce))&&!e(ae))},{title:m(()=>[S(y(e(Me)?e(Ae)?"Group by limit exceeded":"":"This field type doesn't support grouping"),1)]),default:m(()=>[w(u,{disabled:e(I)||("isEeUI"in t?t.isEeUI:e(Ce))&&!e(ae)&&(!e(Me)||e(Ae))&&!e(_e),onClick:l[5]||(l[5]=L=>Qe(e(_e)?e(R).GROUP_BY_REMOVE:e(R).GROUP_BY_ADD))},{default:m(()=>[te((s(),P("div",dl,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).group),{class:"opacity-80"})),S(" "+y(e(_e)?"Don't group by this field":t.$t("activity.groupByThisField")),1)])),[[ee,["a:field:add:groupby"]]])]),_:1},8,["disabled"])]),_:1},8,["disabled"]),e(b)?O("",!0):(s(),P(he,{key:2},[w(a),w(u,{onClick:At},{default:m(()=>[te((s(),P("div",ul,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).colInsertAfter),{class:"opacity-80 w-4 h-4"})),S(" "+y(e(p)("general.insertAfter")),1)])),[[ee,["a:field:insert:after"]]])]),_:1}),(st=e(i))!=null&&st.pv?O("",!0):(s(),c(u,{key:0,onClick:Mt},{default:m(()=>[te((s(),P("div",rl,[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).colInsertBefore),{class:"opacity-80 w-4 h-4"})),S(" "+y(e(p)("general.insertBefore")),1)])),[[ee,["a:field:insert:before"]]])]),_:1}))],64))],64)),(nt=e(i))!=null&&nt.pv?O("",!0):(s(),c(a,{key:11})),!((ot=e(i))!=null&&ot.pv)&&e(se)("fieldDelete")?(s(),c(g,{key:12,message:"Field cannot be deleted.",enabled:!e(De),"is-sql-view":e(b)},{default:m(()=>{var L;return[w(u,{disabled:!e(Je)||!e(De)||((L=e(ye))==null?void 0:L.length),class:"!hover:bg-red-50",title:e(ye)?"Field is associated with a link column":void 0,onClick:Ot},{default:m(()=>[G("div",{class:Be(["nc-column-delete nc-header-menu-item",{"text-red-600":e(Je)&&e(De)}])},[(s(),c(J(("iconMap"in t?t.iconMap:e(q)).delete),{class:"opacity-80"})),S(" "+y(t.$t("general.delete"))+" "+y(t.$t("objects.field").toLowerCase()),1)],2)]),_:1},8,["disabled","title"])]}),_:1},8,["enabled","is-sql-view"])):O("",!0),G("div",cl,[w(Bt,{key:"dc",visible:e(Q),"onUpdate:visible":l[6]||(l[6]=L=>ne(Q)?Q.value=L:null),"on-delete-column":Vt},null,8,["visible"]),e(i)?(s(),c(Ut,{key:"ddc",ref_key:"duplicateDialogRef",ref:ve,modelValue:e(me),"onUpdate:modelValue":l[7]||(l[7]=L=>ne(me)?me.value=L:null),column:e(i),extra:e(qe)},null,8,["modelValue","column","extra"])):O("",!0),w(Pt,{key:"dcx",value:e(be),"onUpdate:value":l[8]||(l[8]=L=>ne(be)?be.value=L:null)},null,8,["value"]),w(jt,{key:"dcxx",value:e(ge),"onUpdate:value":l[9]||(l[9]=L=>ne(ge)?ge.value=L:null),"use-meta-fields":((dt=e(n))==null?void 0:dt.id)!==((ut=e(C))==null?void 0:ut.fk_model_id)},null,8,["value","use-meta-fields"]),e(i)&&e(n)&&("isEeUI"in t?t.isEeUI:e(Ce))?(s(),c(Nt,{key:"dfp",visible:e(we),"onUpdate:visible":l[10]||(l[10]=L=>ne(we)?we.value=L:null),"field-id":e(i).id,"field-title":e(i).title,"field-uidt":e(i).uidt},null,8,["visible","field-id","field-title","field-uidt"])):O("",!0)])]}),_:1},8,["class"])}}}),Sl=Object.assign(Ci(pl,[["__scopeId","data-v-21e9ee03"]]),{__name:"SmartsheetHeaderColumnMenu"});export{Bi as _,Gi as a,Sl as b,qi as u};
