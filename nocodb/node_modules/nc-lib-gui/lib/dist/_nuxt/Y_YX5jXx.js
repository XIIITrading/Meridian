const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DhizJgOH.js","./DOFFjK0_.js","./entry.DDfSYhWa.css","./Params.DMw5rYYq.css","./CiiU4J3J.js","./Headers.DsAFPHpL.css","./BjlRxDgN.js","./boyBAVNN.js","./Editor.C6FZ3q1a.css","./CWRHUTRI.js","./BcG6Ieku.js","./D_wq2ltS.js","./Item.C85DUSg3.css","./9aYOtC5C.js","./index.CotXCNy2.css","./D4XRfH0I.js","./B3Wp9c04.js","./SJHyi9T4.js","./FieldListAutoCompleteDropdown.DdXE7zlY.css","./qgYlKlk5.js","./Cb5B9eG-.js","./C_qz9woQ.js","./DA4KItu_.js","./CV-2bRRD.js","./TimeSelector.DAR2lbHN.css","./D8wgK-Ih.js","./HdsRe6lq.js","./index.N-A1gxk9.css","./DzBSAsxR.js","./FilterInput.7KjqjE1F.css","./0vrXc9P0.js","./MNXVOE4I.js","./LockView.BWC8JyQk.css","./D-8_fbld.js","./DG2ZEhLK.js","./ColumnFilter.C3qfKB4j.css"])))=>i.map(i=>d[i]);
import{e as Fe,ak as vt,a9 as Ye,f as bt,a6 as ht,J as _t,T as gt,a8 as he,V as kt,G as wt,r as b,aZ as xt,X as Ke,Y as $t,ah as He,n as X,d0 as I,bl as Tt,aQ as le,dw as Ct,g as Qe,bW as Lt,ac as Je,c as f,o as r,an as N,I as g,K as v,L as e,Q as St,P as q,w as s,a as c,b as l,a0 as Mt,ch as fe,fx as me,N as _e,ad as Z,a3 as Ut,cc as Ot,M as Xe,d3 as Ze,ap as et,O as tt,d as $,t as m,a1 as ye,ez as Dt,aq as ve,eO as Vt,aT as ge,b9 as ke,ar as ot,dj as It,dk as Wt,aS as we,ae as at,a2 as zt,ag as be,af as Et,b0 as jt,a4 as nt,a5 as Nt,$ as lt,kl as At,aW as xe,_ as it,U as Bt,am as Rt,b7 as Pt,j as Ht,bi as qt,y as Kt,bs as Gt,cn as Ft,cm as Yt,aG as Qt,aA as Jt,bn as Xt,f8 as Ge}from"./DOFFjK0_.js";import{_ as Zt}from"./D_wq2ltS.js";import{_ as eo}from"./9aYOtC5C.js";import{_ as to}from"./BRY4OykS.js";import oo from"./DiUleKVo.js";import{u as st,a as ao,b as rt}from"./CiBV2ZED.js";import{_ as no}from"./C6nWwNvX.js";import{u as lo}from"./CTGo9zv-.js";import"./4fFkR2QG.js";import"./JUJEmhCv.js";import"./BrfakvRE.js";import"./DDEVLD8O.js";import"./ZNRZafJ9.js";import"./BhfICdUA.js";import"./NRjd0XWG.js";import"./RfUK_fd6.js";import"./DG2ZEhLK.js";import"./SJHyi9T4.js";import"./BYGCxle3.js";import"./D2QgEzTv.js";import"./BNo10Mdm.js";import"./hehmy6V1.js";import"./BvG7Iv4q.js";import"./CyXz1Zkk.js";import"./CPChVVVr.js";import"./D4c215jk.js";import"./B3Wp9c04.js";import"./CFXGfO_A.js";import"./VKUQM8lk.js";import"./YaKnxhzO.js";import"./BqWeTF94.js";import"./-rIuSlCu.js";import"./sgaWLnOz.js";import"./CQugZrqw.js";import"./BpgQOThx.js";import"./CYkscC4Z.js";import"./CHgOe2F-.js";import"./ps5He39s.js";import"./DEAKw9Pl.js";import"./Cl-qOJW6.js";import"./DmoodaOn.js";import"./Bo7kLdUR.js";import"./4PLl4EP6.js";import"./DcFNOSET.js";import"./boyBAVNN.js";import"./B3tDgntu.js";import"./Db9kSA7A.js";const io=we(()=>xe(()=>import("./DhizJgOH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(x=>x.default||x)),so=we(()=>xe(()=>import("./CiiU4J3J.js"),__vite__mapDeps([4,1,2,5]),import.meta.url).then(x=>x.default||x)),ro=we(()=>xe(()=>import("./BjlRxDgN.js"),__vite__mapDeps([6,1,2,7,8]),import.meta.url).then(x=>x.default||x)),co=we(()=>xe(()=>import("./CWRHUTRI.js"),__vite__mapDeps([9,1,2]),import.meta.url).then(x=>x.default||x)),uo=we(()=>xe(()=>import("./BcG6Ieku.js").then(x=>x.C),__vite__mapDeps([10,1,2,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]),import.meta.url).then(x=>x.default||x)),po={class:"flex w-full items-center px-4 py-2 justify-between"},fo={class:"flex items-center gap-3 flex-1"},mo={class:"text-gray-900 font-semibold text-xl"},yo={key:0,class:"flex flex-row p-1 bg-gray-200 rounded-lg gap-x-0.5 nc-view-sidebar-tab"},vo={class:"tab-title nc-tab"},bo={class:"tab-title nc-tab"},ho={class:"flex justify-end items-center gap-3 flex-1"},_o={key:0,class:"flex bg-white rounded-b-2xl h-[calc(100%_-_66px)]"},go={style:{"max-width":"700px","min-width":"640px"},class:"mx-auto gap-8 flex flex-col"},ko=["placeholder"],wo={class:"flex flex-col gap-4"},xo={class:"flex w-full gap-3 custom-select"},$o={class:"flex items-center w-full gap-2 justify-between"},To={class:"flex items-center w-full gap-2"},Co={class:"flex-1"},Lo={key:0,class:"flex flex-col gap-8"},So={class:"flex flex-col custom-select w-full gap-4"},Mo={class:"flex w-full gap-3"},Uo={class:"flex items-center gap-2 justify-between w-full"},Oo={class:"flex flex-col gap-2"},Do={key:0,class:"text-xs text-warning pl-2"},Vo={style:{"box-shadow":"0px 0px 4px 0px rgba(0, 0, 0, 0.08), 0px 0px 4px 0px rgba(0, 0, 0, 0.08)"},class:"my-3 mx-1 rounded-lg"},Io={key:1,class:"flex flex-col w-full gap-3"},Wo={key:2,class:"flex flex-col w-full gap-3"},zo={key:3,class:"flex flex-col w-full gap-3"},Eo={key:4,class:"flex flex-col w-full gap-3"},jo={key:0},No={class:"w-full cursor-not-allowed flex items-center"},Ao={class:"!text-gray-700 font-semibold"},Bo={key:1},Ro={class:"!text-gray-700 font-semibold"},Po={class:"flex flex-col gap-4"},Ho={class:"flex items-center justify-between -ml-1.5"},qo={class:"flex items-center gap-3"},Ko={class:"h-full bg-gray-50 border-l-1 w-80 p-5 rounded-br-2xl border-gray-200"},Go={class:"w-full flex flex-col gap-3"},Fo={class:"text-sm text-gray-700 font-semibold !my-0"},Yo={class:"h-7 w-7 flex items-center justify-center"},Qo={key:1,class:"h-[calc(100%_-_66px)]"},Jo=Fe({__name:"WebhookV2",props:{value:{type:Boolean},eventList:{},hook:{},stickyScroll:{type:Boolean}},emits:["close","update:value"],setup(x,{emit:$e}){const K=x,Me=$e,{eventList:ie}=vt(K),{t:u}=Ye(),{$api:Te}=bt(),{api:W}=ht(),{appInfo:se}=_t(),z=gt(K,"value"),{hooks:Ue}=he(st()),{base:Ce}=he(kt()),re=wt(xt,b()),Le=u("labels.webhook"),ee=b(!1),Oe=Ke.useForm,t=$t({id:"",title:Le,event:void 0,operation:void 0,eventOperation:void 0,notification:{type:"URL",include_user:!1,payload:{method:"POST",body:"{{ json event }}",headers:[{enabled:!1,name:"",value:""}],parameters:[{enabled:!1,name:"",value:""}],path:""}},condition:!1,active:!0,version:"v2"}),_=b(t.version==="v1"||He),te=b("params"),L=b(),S=b([]),ce=b([]),de=b([]),R=b([]),P=b(),A=b(),oe=b({Email:[{key:"to",label:u("labels.toAddress"),placeholder:u("labels.toAddress"),type:"SingleLineText",required:!0},{key:"subject",label:u("labels.subject"),placeholder:u("labels.subject"),type:"SingleLineText",required:!0},{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0}],Slack:[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0}],"Microsoft Teams":[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0}],Discord:[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0}],Mattermost:[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0}],Twilio:[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0},{key:"to",label:u("labels.commaSeparatedMobileNumber"),placeholder:u("labels.commaSeparatedMobileNumber"),type:"LongText",required:!0}],"Whatsapp Twilio":[{key:"body",label:u("labels.body"),placeholder:u("labels.body"),type:"LongText",required:!0},{key:"to",label:u("labels.commaSeparatedMobileNumber"),placeholder:u("labels.commaSeparatedMobileNumber"),type:"LongText",required:!0}]}),De=X(()=>[{type:"URL",text:u("datatype.URL")},{type:"Email",text:u("datatype.Email")},{type:"Slack",text:u("general.slack")},{type:"Microsoft Teams",text:u("general.microsoftTeams")},{type:"Discord",text:u("general.discord")},{type:"Mattermost",text:u("general.matterMost")},{type:"Twilio",text:u("general.twilio")},{type:"Whatsapp Twilio",text:u("general.whatsappTwilio")}]),Ve=[{title:"GET"},{title:"POST"},{title:"DELETE"},{title:"PUT"},{title:"HEAD"},{title:"PATCH"}],F=b(!1),Ie=X(()=>({title:[I()],eventOperation:[I()],"notification.type":[I()],...t.notification.type==="URL"&&{"notification.payload.method":[I()],"notification.payload.path":[I(),{validator:(a,o)=>new Promise((p,h)=>{var V,M;F.value=!1;const y=(V=se.value)==null?void 0:V.ncSiteUrl;if(!o||!y){p();return}let C=!1;try{const E=new URL(t.notification.payload.path),B=new URL(y);C=E.hostname===B.hostname}catch{C=o.includes(y)}C&&((M=se.value)!=null&&M.isCloud?h(new Error(u("msg.internalUrlsNotAllowed"))):F.value=!0),p()})}]},...t.notification.type==="Email"&&{"notification.payload.to":[I()],"notification.payload.subject":[I()],"notification.payload.body":[I()]},...["Slack","Microsoft Teams","Discord","Mattermost"].includes(t.notification.type)&&{"notification.payload.channels":[I()],"notification.payload.body":[I()]},...(t.notification.type==="Twilio"||t.notification.type==="Whatsapp Twilio")&&{"notification.payload.body":[I()],"notification.payload.to":[I()]}})),{validateInfos:U}=Oe(t,Ie),H=a=>{if(a){if(Array.isArray(a))return a;if(typeof a=="object"&&Object.keys(a))return[a]}return[]};function ae(a=!1){var o,p,h,y,C,V,M,E;if(a&&(t.notification.payload={},["Slack","Microsoft Teams","Discord","Mattermost"].includes(t.notification.type)&&(t.notification.payload.channels=[],t.notification.payload.body="")),t.notification.type==="Slack"&&(S.value=H((p=(o=L==null?void 0:L.value)==null?void 0:o.Slack)==null?void 0:p.parsedInput)),t.notification.type==="Microsoft Teams"&&(ce.value=H((y=(h=L==null?void 0:L.value)==null?void 0:h["Microsoft Teams"])==null?void 0:y.parsedInput)),t.notification.type==="Discord"&&(de.value=H((V=(C=L==null?void 0:L.value)==null?void 0:C.Discord)==null?void 0:V.parsedInput)),t.notification.type==="Mattermost"&&(R.value=H((E=(M=L==null?void 0:L.value)==null?void 0:M.Mattermost)==null?void 0:E.parsedInput)),t.notification.type==="URL"){const B=t.notification.payload.body;t.notification.payload.body=B?B==="{{ json data }}"?"{{ json event }}":B:"{{ json event }}",t.notification.payload.parameters=t.notification.payload.parameters||[{}],t.notification.payload.headers=t.notification.payload.headers||[{}],t.notification.payload.method=t.notification.payload.method||"POST",t.notification.payload.auth=t.notification.payload.auth??""}}function We(a){const o=a.notification;Object.assign(t,{...a,notification:{...o,include_user:(o==null?void 0:o.include_user)??!1,payload:o.payload}})}function ze(){const{notification:{payload:a={},type:o={}}={}}=t;Object.assign(t,{...t,notification:{...t.notification,type:o,payload:a}}),t.notification.payload=a;const p=b(null);switch(t.notification.type){case"Slack":p.value=S.value;break;case"Microsoft Teams":p.value=ce.value;break;case"Discord":p.value=de.value;break;case"Mattermost":p.value=R.value;break}p&&(t.notification.payload.webhook_url=t.notification.payload.webhook_url&&t.notification.payload.webhook_url.map(h=>{var y;return(y=p.value)==null?void 0:y.find(C=>h.webhook_url===C.webhook_url)})),t.notification.type==="URL"&&(t.notification.payload=t.notification.payload||{},t.notification.payload.parameters=t.notification.payload.parameters||[{}],t.notification.payload.headers=t.notification.payload.headers||[{}],t.notification.payload.method=t.notification.payload.method||"POST")}async function Ee(){try{const a=(await W.plugin.webhookList({query:{base_id:Ce.value.id}})).list;L.value=a.reduce((o,p)=>{const h={title:"",tags:[],parsedInput:{},...p};return h.tags=p.tags?p.tags.split(","):[],h.parsedInput=jt(p.input),o[h.title]=h,o},{})}catch(a){nt.error(await Nt(a))}}const Se=X(()=>t.eventOperation&&!(t.eventOperation.includes("bulk")||t.eventOperation.includes("manual"))),ue=()=>{Me("close",t)},G=b(),Y=b(),O=b("configuration"),[Q,je]=Tt(),Ne=()=>{je(),lt(()=>{Q.value&&(Y.value.scrollTop=Y.value.scrollHeight)})},Ae=[{title:"Getting started",href:"https://nocodb.com/docs/product-docs/automation/webhook/create-webhook"},{title:"Create webhook",href:"https://nocodb.com/docs/product-docs/automation/webhook"},{title:"Custom payload",href:"https://nocodb.com/docs/product-docs/automation/webhook/create-webhook#webhook-with-custom-payload-"},{title:"Trigger on condition",href:"https://nocodb.com/docs/product-docs/automation/webhook/create-webhook#webhook-with-conditions"}];le(()=>t==null?void 0:t.operation,async()=>{await i()});async function i(){var a,o;G.value=await Te.dbTableWebhook.samplePayloadGet((a=re==null?void 0:re.value)==null?void 0:a.id,(t==null?void 0:t.operation)||"insert",t.version,{query:{includeUser:(!!((o=t.notification)!=null&&o.include_user)).toString()}})}const d=a=>At([...a.map(o=>(o==null?void 0:o.title)||"")],Le),D=a=>{switch(a){case"URL":return"link2";case"Email":return"mail";case"Slack":return"slack";case"Microsoft Teams":return"microsoftTeams";case"Discord":return"discord";case"Mattermost":return"mattermost";case"Twilio":return"twilio";case"Whatsapp Twilio":return"whatsapp"}};Ct("Escape",()=>{z.value=!1}),le(()=>t.eventOperation,()=>{if(!t.eventOperation)return;const[a,o]=t.eventOperation.split(" ");t.event=a,t.operation=o,a==="manual"&&(t.active=!0)}),le(()=>K.hook,()=>{K.hook?(We(K.hook),ze()):t.title=d(Ue.value)},{immediate:!0}),Qe(async()=>{await Ee(),t.event&&t.operation?t.eventOperation=`${t.event} ${t.operation}`:t.eventOperation=ie.value[0].value.join(" "),ae(),Lt(()=>A.value).toBeTruthy().then(()=>{var a,o;(a=A.value)==null||a.focus(),(o=A.value)==null||o.select()})});const J=async()=>{t.notification.include_user=!t.notification.include_user,await i()};return(a,o)=>{const p=Xe,h=tt,y=Mt,C=et,V=Ze,M=Vt,E=Dt,B=ot,Be=io,pe=Wt,Re=so,ne=ro,k=It,w=co,j=at,ct=uo,dt=zt,ut=Ke,pt=no,ft=ao,mt=St,yt=rt,qe=Je("e");return r(),f(N,null,[e(ee)?v("",!0):(r(),g(mt,{key:0,visible:e(z),"onUpdate:visible":o[23]||(o[23]=n=>q(z)?z.value=n:null),"show-separator":!0,size:"large","wrap-class-name":"nc-modal-webhook-create-edit"},{header:s(()=>[c("div",po,[c("div",fo,[l(p,{class:"text-gray-900 h-5 w-5",icon:"ncWebhook"}),c("span",mo,[e(O)==="configuration"?(r(),f(N,{key:0},[$(m(a.hook?a.$t("activity.webhookDetails"):a.$t("activity.newWebhook")),1)],64)):(r(),f(N,{key:1},[$(m(a.$t("activity.webhookLogs")),1)],64))])]),a.hook&&("isEeUI"in a?a.isEeUI:e(He))?(r(),f("div",yo,[Z((r(),f("div",{class:be(["tab",{active:e(O)==="configuration"}]),onClick:o[0]||(o[0]=n=>O.value="configuration")},[c("div",vo,m(a.$t("general.details")),1)],2)),[[qe,["c:webhook:edit"]]]),Z((r(),f("div",{class:be(["tab",{active:e(O)==="log"}]),onClick:o[1]||(o[1]=n=>O.value="log")},[c("div",bo,m(a.$t("general.logs")),1)],2)),[[qe,["c:webhook:log"]]])])):v("",!0),c("div",ho,[l(h,{type:"text",size:"small","data-testid":"nc-close-webhook-modal",onClick:_e(ue,["stop"])},{default:s(()=>[l(p,{icon:"close"})]),_:1})])])]),default:s(()=>[e(O)==="configuration"?(r(),f("div",_o,[c("div",{ref_key:"containerElem",ref:Y,class:"h-full flex-1 flex flex-col overflow-y-auto scroll-smooth nc-scrollbar-thin px-12 py-6 mx-auto"},[c("div",go,[l(y,fe(me(e(U).title)),{default:s(()=>[c("div",{class:"flex flex-grow px-2 py-1 title-input items-center border-b-1 rounded-t-md border-gray-200 bg-gray-100",onClick:o[5]||(o[5]=_e(n=>{var T;return(T=e(A))==null?void 0:T.focus()},["prevent"]))},[Z(c("input",{ref_key:"titleDomRef",ref:A,"onUpdate:modelValue":o[2]||(o[2]=n=>e(t).title=n),class:"flex flex-grow text-lg px-2 font-medium capitalize outline-none bg-inherit nc-text-field-hook-title",placeholder:a.$t("placeholder.webhookTitle"),contenteditable:!0,disabled:"",onKeydown:o[3]||(o[3]=Ut(n=>{var T;return(T=e(A))==null?void 0:T.blur()},["enter"]))},null,40,ko),[[Ot,e(t).title]]),l(p,{icon:"rename",class:"cursor-text",onClick:o[4]||(o[4]=n=>{var T;return(T=e(A))==null?void 0:T.focus()})})])]),_:1},16),l(V,{type:"warning",message:a.$t("msg.webhookV2DeprecationAlertTitle"),description:a.$t("msg.webhookV2DeprecationAlertDesc")},{action:s(()=>[l(C,{title:a.$t("general.reviewAndUpgrade")},{default:s(()=>[l(h,{type:"link",size:"xsmall",class:"!font-bold",onClick:o[6]||(o[6]=n=>ee.value=!0)},{default:s(()=>[$(m(a.$t("general.upgrade")),1)]),_:1})]),_:1},8,["title"])]),_:1},8,["message","description"]),l(ut,{class:"flex flex-col gap-8",model:e(t),name:"create-or-edit-webhook"},{default:s(()=>[c("div",wo,[c("div",xo,[l(y,ye({class:"w-1/3"},e(U).eventOperation),{default:s(()=>[l(E,{value:e(t).eventOperation,"onUpdate:value":o[7]||(o[7]=n=>e(t).eventOperation=n),size:"medium",disabled:!0,placeholder:a.$t("general.event"),class:"nc-text-field-hook-event !h-9 capitalize","dropdown-class-name":"nc-dropdown-webhook-event"},{suffixIcon:s(()=>[l(p,{icon:"arrowDown",class:"text-gray-700"})]),default:s(()=>[(r(!0),f(N,null,ve(e(ie),(n,T)=>(r(),g(M,{key:T,class:"capitalize",value:n.value.join(" "),disabled:e(t).version==="v1"&&["bulkInsert","bulkUpdate","bulkDelete"].includes(n.value[1])},{default:s(()=>[c("div",$o,[l(C,{class:"truncate","show-on-truncate-only":""},{title:s(()=>[$(m(n.text.join(" ")),1)]),default:s(()=>[$(" "+m(n.text.join(" ")),1)]),_:2},1024),e(t).eventOperation===n.value.join(" ")?(r(),g(ge(("iconMap"in a?a.iconMap:e(ke)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4 flex-none"})):v("",!0)])]),_:2},1032,["value","disabled"]))),128))]),_:1},8,["value","placeholder"])]),_:1},16),l(y,ye({class:"w-2/3"},e(U)["notification.type"]),{default:s(()=>[l(E,{value:e(t).notification.type,"onUpdate:value":o[8]||(o[8]=n=>e(t).notification.type=n),size:"medium",disabled:!0,class:"nc-select-hook-notification-type !h-9",placeholder:a.$t("general.notification"),"dropdown-class-name":"nc-dropdown-webhook-notification",onChange:o[9]||(o[9]=n=>ae(!0))},{suffixIcon:s(()=>[l(p,{icon:"arrowDown",class:"text-gray-700"})]),default:s(()=>[(r(!0),f(N,null,ve(e(De),(n,T)=>(r(),g(M,{key:T,value:n.type},{default:s(()=>[c("div",To,[l(p,{icon:D(n.type),class:"mr-2 stroke-transparent"},null,8,["icon"]),c("div",Co,m(n.text),1),e(t).notification.type===n.type?(r(),g(ge(("iconMap"in a?a.iconMap:e(ke)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4 flex-none"})):v("",!0)])]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},16)]),e(t).notification.type==="URL"?(r(),f("div",Lo,[c("div",So,[c("div",Mo,[l(y,{class:"w-1/3"},{default:s(()=>[l(E,{value:e(t).notification.payload.method,"onUpdate:value":o[10]||(o[10]=n=>e(t).notification.payload.method=n),disabled:!0,size:"medium",class:"nc-select-hook-url-method","dropdown-class-name":"nc-dropdown-hook-notification-url-method"},{suffixIcon:s(()=>[l(p,{icon:"arrowDown",class:"text-gray-700"})]),default:s(()=>[(r(),f(N,null,ve(Ve,(n,T)=>l(M,{key:T,value:n.title},{default:s(()=>[c("div",Uo,[c("div",null,m(n.title),1),e(t).notification.payload.method===n.title?(r(),g(ge(("iconMap"in a?a.iconMap:e(ke)).check),{key:0,id:"nc-selected-item-icon",class:"text-primary w-4 h-4 flex-none"})):v("",!0)])]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),l(y,ye({class:"w-2/3"},e(U)["notification.payload.path"]),{default:s(()=>[c("div",Oo,[l(B,{value:e(t).notification.payload.path,"onUpdate:value":o[11]||(o[11]=n=>e(t).notification.payload.path=n),size:"medium",placeholder:"http://example.com",class:"nc-text-field-hook-url-path nc-input-shadow h-9 !rounded-lg"},null,8,["value"]),e(F)?(r(),f("div",Do,m(a.$t("msg.cyclicCallsWarning")),1)):v("",!0)])]),_:1},16)])]),c("div",null,[l(k,{activeKey:e(te),"onUpdate:activeKey":o[15]||(o[15]=n=>q(te)?te.value=n:null)},{default:s(()=>[l(pe,{key:"params",tab:a.$t("title.parameter"),"force-render":""},{default:s(()=>[l(Be,{modelValue:e(t).notification.payload.parameters,"onUpdate:modelValue":o[12]||(o[12]=n=>e(t).notification.payload.parameters=n),disabled:""},null,8,["modelValue"])]),_:1},8,["tab"]),l(pe,{key:"headers",tab:a.$t("title.headers"),class:"nc-tab-headers"},{default:s(()=>[l(Re,{modelValue:e(t).notification.payload.headers,"onUpdate:modelValue":o[13]||(o[13]=n=>e(t).notification.payload.headers=n),disabled:""},null,8,["modelValue"])]),_:1},8,["tab"]),e(_)?(r(),g(pe,{key:"body",tab:"Body"},{default:s(()=>[c("div",Vo,[l(ne,{modelValue:e(t).notification.payload.body,"onUpdate:modelValue":o[14]||(o[14]=n=>e(t).notification.payload.body=n),lang:"handlebars","read-only":"","disable-deep-compare":"",validate:!1,class:"min-h-60 max-h-80 !rounded-lg","monaco-config":{minimap:{enabled:!1},padding:{top:8,bottom:8},fontSize:14.5,overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,lineDecorationsWidth:8,lineNumbersMinChars:0,roundedSelection:!1,selectOnLineNumbers:!1,scrollBeyondLastLine:!1,contextmenu:!1,glyphMargin:!1,folding:!1,bracketPairColorization:{enabled:!1},wordWrap:"on",scrollbar:{horizontal:"hidden",verticalScrollbarSize:6},wrappingStrategy:"advanced",renderLineHighlight:"none",tabSize:4,stickyScroll:{enabled:K.stickyScroll}}},null,8,["modelValue","monaco-config"])])]),_:1})):v("",!0)]),_:1},8,["activeKey"])])])):v("",!0),e(t).notification.type==="Slack"?(r(),f("div",Io,[l(y,fe(me(e(U)["notification.payload.channels"])),{default:s(()=>[l(w,{modelValue:e(t).notification.payload.channels,"onUpdate:modelValue":o[16]||(o[16]=n=>e(t).notification.payload.channels=n),"selected-channel-list":e(t).notification.payload.channels,"available-channel-list":e(S),placeholder:a.$t("placeholder.selectSlackChannels")},null,8,["modelValue","selected-channel-list","available-channel-list","placeholder"])]),_:1},16)])):v("",!0),e(t).notification.type==="Microsoft Teams"?(r(),f("div",Wo,[l(y,fe(me(e(U)["notification.payload.channels"])),{default:s(()=>[l(w,{modelValue:e(t).notification.payload.channels,"onUpdate:modelValue":o[17]||(o[17]=n=>e(t).notification.payload.channels=n),"selected-channel-list":e(t).notification.payload.channels,"available-channel-list":e(ce),placeholder:a.$t("placeholder.selectTeamsChannels")},null,8,["modelValue","selected-channel-list","available-channel-list","placeholder"])]),_:1},16)])):v("",!0),e(t).notification.type==="Discord"?(r(),f("div",zo,[l(y,fe(me(e(U)["notification.payload.channels"])),{default:s(()=>[l(w,{modelValue:e(t).notification.payload.channels,"onUpdate:modelValue":o[18]||(o[18]=n=>e(t).notification.payload.channels=n),"selected-channel-list":e(t).notification.payload.channels,"available-channel-list":e(de),placeholder:a.$t("placeholder.selectDiscordChannels")},null,8,["modelValue","selected-channel-list","available-channel-list","placeholder"])]),_:1},16)])):v("",!0),e(t).notification.type==="Mattermost"?(r(),f("div",Eo,[l(y,fe(me(e(U)["notification.payload.channels"])),{default:s(()=>[l(w,{modelValue:e(t).notification.payload.channels,"onUpdate:modelValue":o[19]||(o[19]=n=>e(t).notification.payload.channels=n),"selected-channel-list":e(t).notification.payload.channels,"available-channel-list":e(R),placeholder:a.$t("placeholder.selectMattermostChannels")},null,8,["modelValue","selected-channel-list","available-channel-list","placeholder"])]),_:1},16)])):v("",!0)]),e(Se)?(r(),f("div",jo,[c("div",No,[l(j,{checked:!!e(t).condition,disabled:!0,class:"nc-check-box-hook-condition"},{default:s(()=>[c("span",Ao,m(a.$t("general.trigger"))+" "+m(a.$t("activity.onCondition")),1)]),_:1},8,["checked"])]),e(t).condition?(r(),g(ct,{key:0,ref_key:"filterRef",ref:P,class:"w-full","auto-save":!1,"show-loading":!1,"hook-id":e(t).id,"web-hook":!0,"read-only":"","action-btn-type":"secondary","onUpdate:filtersLength":o[20]||(o[20]=n=>e(t).condition=n>0)},null,8,["hook-id"])):v("",!0)])):v("",!0),("isEeUI"in a?a.isEeUI:e(He))?(r(),f("div",Bo,[c("div",null,[c("div",{class:"w-full cursor-pointer flex items-center",onClick:_e(J,["prevent"])},[l(j,{checked:!!e(t).notification.include_user,class:"nc-check-box-include-user"},{default:s(()=>[c("span",Ro,m(a.$t("labels.includeUser")),1),o[27]||(o[27]=$(" jkl "))]),_:1,__:[27]},8,["checked"]),l(C,{class:"flex"},{title:s(()=>[$(m(a.$t("tooltip.includeUserHint")),1)]),default:s(()=>[l(p,{icon:"info",class:"text-gray-400 ml-1"})]),_:1})])])])):v("",!0),e(oe)[e(t).notification.type]&&e(t).notification.payload?(r(),g(y,{key:2},{default:s(()=>[c("div",Po,[(r(!0),f(N,null,ve(e(oe)[e(t).notification.type],(n,T)=>(r(),f("div",{key:T},[n.type==="LongText"?(r(),g(y,ye({key:0,ref_for:!0},e(U)[`notification.payload.${n.key}`]),{default:s(()=>[l(dt,{value:e(t).notification.payload[n.key],"onUpdate:value":Pe=>e(t).notification.payload[n.key]=Pe,disabled:!0,class:"!rounded-lg !min-h-[120px] nc-scrollbar-thin nc-input-shadow",placeholder:n.label},null,8,["value","onUpdate:value","placeholder"])]),_:2},1040)):(r(),g(y,ye({key:1,ref_for:!0},e(U)[`notification.payload.${n.key}`]),{default:s(()=>[l(B,{value:e(t).notification.payload[n.key],"onUpdate:value":Pe=>e(t).notification.payload[n.key]=Pe,disabled:!0,class:"!rounded-lg nc-input-shadow !h-9",placeholder:n.label},null,8,["value","onUpdate:value","placeholder"])]),_:2},1040))]))),128))])]),_:1})):v("",!0),c("div",null,[c("div",Ho,[l(h,{type:"text",class:"mb-3",size:"small",onClick:o[21]||(o[21]=n=>Ne())},{default:s(()=>[c("div",qo,[o[28]||(o[28]=$(" Sample Payload ")),l(p,{class:be(["transition-transform",{"transform rotate-180":e(Q)}]),icon:"arrowDown"},null,8,["class"])])]),_:1})]),Z(c("div",null,[l(ne,{modelValue:e(G),"onUpdate:modelValue":o[22]||(o[22]=n=>q(G)?G.value=n:null),"read-only":"","monaco-config":{minimap:{enabled:!1},fontSize:14.5,overviewRulerBorder:!1,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,lineDecorationsWidth:12,lineNumbersMinChars:0,scrollBeyondLastLine:!1,renderLineHighlight:"none",lineNumbers:"off",glyphMargin:!1,folding:!1,bracketPairColorization:{enabled:!1},wordWrap:"on",scrollbar:{horizontal:"hidden",verticalScrollbarSize:6},wrappingStrategy:"advanced",tabSize:4,readOnly:!0},"monaco-custom-theme":{base:"vs",inherit:!0,rules:[{token:"key",foreground:"#B33771",fontStyle:"bold"},{token:"string",foreground:"#2B99CC",fontStyle:"semibold"},{token:"number",foreground:"#1FAB51",fontStyle:"semibold"},{token:"boolean",foreground:"#1FAB51",fontStyle:"semibold"},{token:"delimiter",foreground:"#15171A",fontStyle:"semibold"}],colors:{}},class:be(["transition-all border-1 rounded-lg",{"w-0 min-w-0":!e(Q),"min-h-60 max-h-80":e(Q)}]),style:{"box-shadow":"0px 0px 4px 0px rgba(0, 0, 0, 0.08), 0px 0px 4px 0px rgba(0, 0, 0, 0.08)"}},null,8,["modelValue","class"])],512),[[Et,e(Q)]])])]),_:1},8,["model"])])],512),c("div",Ko,[c("div",Go,[c("h2",Fo,m(a.$t("labels.supportDocs")),1),c("div",null,[(r(),f(N,null,ve(Ae,(n,T)=>c("div",{key:T,class:"flex items-center gap-1"},[c("div",Yo,[l(p,{icon:"bookOpen",class:"flex-none w-4 h-4 text-gray-500"})]),l(pt,{href:n.href,target:"_blank",rel:"noopener noreferrer",class:"!text-gray-500 text-sm !no-underline !hover:underline"},{default:s(()=>[$(m(n.title),1)]),_:2},1032,["href"])])),64))])])])])):e(O)==="log"?(r(),f("div",Qo,[l(ft,{hook:a.hook},null,8,["hook"])])):v("",!0)]),_:1},8,["visible"])),e(ee)?(r(),g(yt,{key:1,value:e(z),"onUpdate:value":o[24]||(o[24]=n=>q(z)?z.value=n:null),hook:a.hook,"show-upgrade-modal":"","event-list":e(ie),"sample-data-v2":e(G),onClose:o[25]||(o[25]=n=>ue()),onCancel:o[26]||(o[26]=n=>ee.value=!1)},null,8,["value","hook","event-list","sample-data-v2"])):v("",!0)],64)}}}),Xo=Object.assign(it(Jo,[["__scopeId","data-v-9a6ec745"]]),{__name:"WebhookV2"}),Zo={class:"nc-webhook-wrapper w-full p-4"},ea={class:"max-w-250 h-full w-full mx-auto"},ta={key:0},oa={class:"w-full mb-4 mt-6 flex justify-between gap-3"},aa={class:"flex-1 flex gap-2"},na={class:"flex items-center gap-2"},la={class:"flex gap-2 items-center"},ia={key:0,class:"flex-col flex items-center gap-6 justify-center w-full h-full py-12 px-4 border-1 rounded-xl border-gray-200"},sa={class:"text-gray-700 font-bold text-center text-2xl"},ra={class:"text-gray-700 text-center max-w-[24rem]"},ca={class:"flex items-center gap-2"},da={key:0,class:"flex flex-row items-center py-2 px-3 bg-gray-50 rounded-lg text-gray-700 mb-4"},ua={class:"capitalize text-ellipsis overflow-hidden select-none w-full pl-2.5",style:{wordBreak:"keep-all",whiteSpace:"nowrap",display:"inline"}},pa={key:1,class:"text-small leading-[18px] mb-2 text-gray-500"},fa={key:1,class:"h-full w-full flex flex-col justify-center items-center",style:{height:"calc(100vh - (var(--topbar-height) * 2))"}},ma=Fe({__name:"Webhooks",setup(x){const{activeTable:$e}=he(Bt()),{sorts:K,sortDirection:Me,loadSorts:ie,handleGetSortedData:u,saveOrUpdate:Te}=lo("Webhook"),W=b(),se=st(),{hooks:z,isHooksLoading:Ue,hasV2Webhooks:Ce}=he(se),{loadHooksList:re,deleteHook:Le,copyHook:ee,saveHooks:Oe}=se,{activeView:t}=he(Rt()),{t:_}=Ye(),{updateStatLimit:te,showWebhookPlanLimitExceededModal:L}=Pt(),S=b(!1),ce=b(null),de=Ht(qt,{style:{fontSize:"2.5rem"},spin:!0}),R=b(""),P=b(!1),A=b(!1),oe=X(()=>z.value.find(i=>i.id===R.value)),De=async()=>{if(A.value=!0,!!R.value)try{await Le(R.value),te(Ge.LIMIT_WEBHOOK_PER_WORKSPACE,-1)}finally{A.value=!1,P.value=!1,R.value=""}},Ve=b(void 0),F=b(!1),Ie=async i=>{if(!(F.value||L())){F.value=!0;try{await ee(i),te(Ge.LIMIT_WEBHOOK_PER_WORKSPACE,1)}finally{F.value=!1}}},U=i=>{R.value=i,P.value=!0},H=b(""),ae=b({}),We=X(()=>z.value.filter(i=>{var d;return(d=i.title)==null?void 0:d.toLowerCase().includes(H.value.toLowerCase())})),ze=X(()=>u(We.value,K.value));le(P,()=>{P.value&&lt(()=>{var i,d;(d=(i=ce.value)==null?void 0:i.$el)==null||d.focus()})}),le(S,i=>{i||(W.value=void 0)}),le(()=>{var i;return(i=$e.value)==null?void 0:i.id},async()=>{var i;(i=$e.value)!=null&&i.id&&(Ve.value=void 0,await re())},{immediate:!0});const Ee=async i=>{if(i.event==="manual"&&i.operation==="trigger"){nt.error(_("msg.error.manualTriggerHook"));return}const d=Object.assign({},i);i.active=!i.active,await Oe({hook:i,ogHook:d})},Se=async()=>{L()||(S.value=!0)},ue=i=>{W.value=i,S.value=!0},G=()=>{S.value=!1,W.value=void 0};Qe(async()=>{ie()});const Y=X({get:()=>Me.value,set:i=>{if(Object.keys(i).length===0){Te({});return}const[d,D]=Object.entries(i)[0];Te({field:d,direction:D})}}),O=b([{text:[_("general.record"),_("general.insert").toLowerCase()],value:["after","insert"]},{text:[_("general.record"),_("general.update").toLowerCase()],value:["after","update"]},{text:[_("general.record"),_("general.delete").toLowerCase()],value:["after","delete"]},{text:[_("general.manual"),_("general.trigger").toLowerCase()],value:["manual","trigger"]}]),Q=b([...O.value,{text:[_("general.record"),_("general.bulkInsert").toLowerCase()],value:["after","bulkInsert"]},{text:[_("general.record"),_("general.bulkUpdate").toLowerCase()],value:["after","bulkUpdate"]},{text:[_("general.record"),_("general.bulkDelete").toLowerCase()],value:["after","bulkDelete"]}]),je=[{key:"active",title:_("general.active"),width:90,minWidth:90},{key:"name",title:_("general.name"),minWidth:252,showOrderBy:!0,dataIndex:"title"},{key:"type",title:_("general.type"),basis:"25%",minWidth:200,showOrderBy:!0,dataIndex:"webhook-operation-type"},{key:"created_at",title:_("labels.addedOn"),width:180,minWidth:180,showOrderBy:!0,dataIndex:"created_at"},{key:"action",title:"",width:80,minWidth:80}],Ne=i=>({onClick:()=>ue(i)}),Ae=i=>{var D;if(i.version==="v3"){const a=(Array.isArray(i.operation)?i.operation:[]).map(p=>{var C,V;const h=O.value.find(M=>M.value[0]===i.event),y=((C=h==null?void 0:h.operations)==null?void 0:C[p])||(h==null?void 0:h[p]);return((V=y==null?void 0:y.text)==null?void 0:V[1])||p}).filter(Boolean),o=i.event==="after"?`${_("general.after")} `:i.event==="manual"?`${_("general.manual")} `:"";return a.length===1?`${o}${a[0]}`:_("labels.sendAllEvents")}const d=(D=Q.value.find(J=>J.value.includes(i.event)&&J.value.includes(i.operation)))==null?void 0:D.text;return d&&d.includes("Manual Trigger")?"Manual Trigger":(d==null?void 0:d.join(" "))||`Before ${i.operation}`};return(i,d)=>{const D=tt,J=Ze,a=Xe,o=ot,p=at,h=et,y=Zt,C=Jt,V=eo,M=Qt,E=to,B=oo,Be=rt,pe=Xo,Re=Xt,ne=Je("e");return r(),f("div",Zo,[c("div",ea,[e(t)&&!e(Ue)?(r(),f("div",ta,[e(Ce)?(r(),g(J,{key:0,type:"warning",message:i.$t("msg.webhookV2DeprecationAlertTitle"),description:i.$t("msg.webhookV2DeprecationAlertDesc"),class:"bg-nc-bg-orange-light"},{action:s(()=>[l(D,{type:"link",size:"xsmall",class:"!hover:underline !font-bold",target:"_blank",href:"https://nocodb.com/docs/product-docs/automation/webhook/webhook-v2-vs-v3#upgrade-to-webhook-v3"},{default:s(()=>[$(m(i.$t("activity.goToDocs")),1)]),_:1})]),_:1},8,["message","description"])):v("",!0),c("div",oa,[c("div",aa,[l(o,{value:e(H),"onUpdate:value":d[0]||(d[0]=k=>q(H)?H.value=k:null),class:"w-full nc-input-sm nc-input-border-on-value !max-w-84",size:"small",placeholder:i.$t("title.searchWebhook"),"allow-clear":""},{prefix:s(()=>[l(a,{icon:"search",class:"mr-2 h-4 w-4 text-gray-500"})]),_:1},8,["value","placeholder"]),l(D,{class:"px-2",type:"text",size:"small",onClick:d[1]||(d[1]=k=>("navigateTo"in i?i.navigateTo:e(Kt))("https://nocodb.com/docs/product-docs/automation/webhook",{open:"navigateToBlankTargetOpenOption"in i?i.navigateToBlankTargetOpenOption:e(Gt)}))},{default:s(()=>[c("div",na,[$(m(i.$t("title.docs"))+" ",1),l(a,{icon:"externalLink"})])]),_:1})]),Z((r(),g(D,{type:"secondary",size:"small",class:"!text-brand-500 !hover:text-brand-600","data-testid":"nc-new-webhook",onClick:Se},{default:s(()=>[c("div",la,[l(a,{icon:"plus"}),$(" "+m(i.$t("activity.newWebhook")),1)])]),_:1})),[[ne,["c:actions:webhook"]]])]),c("div",{style:Ft({height:`calc(100vh - var(--topbar-height) - var(--toolbar-height) - 104px - ${e(Ce)?"82px":"0px"})`})},[e(z).length?(r(),g(E,{key:1,"order-by":e(Y),"onUpdate:orderBy":d[4]||(d[4]=k=>q(Y)?Y.value=k:null),columns:je,data:e(ze),"custom-row":Ne,class:"h-full","body-row-class-name":"nc-view-sidebar-webhook-item group"},{bodyCell:s(({column:k,record:w})=>[l(h,{disabled:w.event!=="manual"},{title:s(()=>[$(m(i.$t("msg.error.manualTriggerHook")),1)]),default:s(()=>[k.key==="active"?Z((r(),f("div",{key:0,onClick:d[2]||(d[2]=_e(()=>{},["stop"]))},[l(p,{size:"small",disabled:w.event==="manual",checked:!!w.active,onChange:j=>Ee(w)},null,8,["disabled","checked","onChange"])])),[[ne,["c:actions:webhook"]]]):v("",!0)]),_:2},1032,["disabled"]),k.key==="name"?(r(),f(N,{key:0},[l(h,{class:"truncate max-w-full flex-1 text-gray-800 font-semibold text-sm","show-on-truncate-only":""},{title:s(()=>[$(m(w.title),1)]),default:s(()=>[$(m(w.title)+" ",1)]),_:2},1024),w.version==="v2"?(r(),g(h,{key:0,class:"-mr-2 flex"},{title:s(()=>d[8]||(d[8]=[$(" Port this webhook from v2 to v3 ")])),default:s(()=>[l(a,{icon:"ncAlertTriangle",class:"flex-none text-nc-content-orange-dark"})]),_:1})):v("",!0)],64)):v("",!0),k.key==="type"?(r(),f(N,{key:1},[$(m(Ae(w)),1)],64)):v("",!0),k.key==="created_at"?(r(),f(N,{key:2},[$(m(e(Yt)(w.created_at).format("DD MMM YYYY")),1)],64)):v("",!0),k.key==="action"?(r(),g(M,{key:3,visible:e(ae)[w.id],"onUpdate:visible":j=>e(ae)[w.id]=j,"overlay-class-name":"nc-webhook-item-action-dropdown"},{default:s(({visible:j})=>[l(D,{type:"secondary",size:"small",class:be(["!w-8 !h-8 invisible group-hover:visible",{"!visible":j}]),"data-testid":"nc-webhook-item-action",onClick:d[3]||(d[3]=_e(()=>{},["stop"]))},{default:s(()=>[(r(),g(ge(("iconMap"in i?i.iconMap:e(ke)).threeDotVertical),{class:"text-gray-700"}))]),_:2},1032,["class"])]),overlay:s(()=>[l(V,{class:"w-48",variant:"small",onClick:j=>e(ae)[w.id]=!1},{default:s(()=>[l(y,{key:"edit","data-testid":"nc-webhook-item-action-edit",onClick:j=>ue(w)},{default:s(()=>[l(a,{icon:"edit"}),c("span",null,m(i.$t("general.edit")),1)]),_:2},1032,["onClick"]),l(y,{key:"duplicate","data-testid":"nc-webhook-item-action-duplicate",disabled:w.version!=="v3",onClick:j=>Ie(w)},{default:s(()=>[l(a,{icon:"duplicate"}),c("span",null,m(i.$t("general.duplicate")),1)]),_:2},1032,["disabled","onClick"]),l(C),l(y,{key:"delete",class:"!text-red-500 !hover:bg-red-50","data-testid":"nc-webhook-item-action-delete",onClick:j=>U(w.id)},{default:s(()=>[l(a,{icon:"delete"}),$(" "+m(i.$t("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1032,["onClick"])]),_:2},1032,["visible","onUpdate:visible"])):v("",!0)]),_:1},8,["order-by","data"])):(r(),f("div",ia,[c("div",sa,m(i.$t("msg.createWebhookMsg1")),1),c("div",ra,m(i.$t("msg.createWebhookMsg2")),1),Z((r(),g(D,{class:"flex max-w-40",type:"primary",size:"small",onClick:Se},{default:s(()=>[c("div",ca,[l(a,{icon:"plus",class:"flex-none"}),c("span",null,m(i.$t("activity.newWebhook")),1)])]),_:1})),[[ne,["c:actions:webhook"]]])]))],4),l(B,{visible:e(P),"onUpdate:visible":d[5]||(d[5]=k=>q(P)?P.value=k:null),"entity-name":i.$t("objects.webhook"),"on-delete":De},{"entity-preview":s(()=>{var k;return[e(oe)?(r(),f("div",da,[(r(),g(ge(("iconMap"in i?i.iconMap:e(ke)).hook),{class:"text-gray-600"})),c("div",ua,m(e(oe).title),1)])):v("",!0),((k=e(oe))==null?void 0:k.event)==="manual"?(r(),f("span",pa,m(i.$t("msg.warning.webhookDelete")),1)):v("",!0)]}),_:1},8,["visible","entity-name"]),e(S)&&(!e(W)||e(W).version==="v3")?(r(),g(Be,{key:1,value:e(S),"onUpdate:value":d[6]||(d[6]=k=>q(S)?S.value=k:null),hook:e(W),"event-list":e(O),onClose:G},null,8,["value","hook","event-list"])):v("",!0),e(S)&&e(W)&&e(W).version!=="v3"?(r(),g(pe,{key:2,value:e(S),"onUpdate:value":d[7]||(d[7]=k=>q(S)?S.value=k:null),hook:e(W),"event-list":e(O),onClose:G},null,8,["value","hook","event-list"])):v("",!0)])):(r(),f("div",fa,[l(Re,{size:"large",indicator:e(de)},null,8,["indicator"])]))])])}}}),cn=Object.assign(it(ma,[["__scopeId","data-v-6e5be05d"]]),{__name:"SmartsheetDetailsWebhooks"});export{cn as default};
